<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Chapter 14. Cassandra (Experimental)</title><!-- HibernateDoc.Meta --><meta name="description" content="Hibernate OGM, JPA for NoSQL datastores - Reference Documentation" /><meta name="keywords" content="hibernate, ogm, hibernate ogm, nosql, jpa, infinispan, mongodb, neo4j, cassandra, couchdb, ehcache, redis" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="canonical" href="https://docs.jboss.org/hibernate/stable/ogm/reference/en-US/html_single/" /><!-- /HibernateDoc.Meta --><link rel="stylesheet" type="text/css" href="css/hibernate.css"/><meta name="generator" content="DocBook XSL-NS Stylesheets V1.76.1"/><link rel="home" href="index.html" title="Hibernate OGM Reference Guide"/><link rel="up" href="index.html" title="Hibernate OGM Reference Guide"/><link rel="prev" href="ch13.html" title="Chapter 13. CouchDB (Experimental)"/><link rel="next" href="ch15.html" title="Chapter 15. Redis (Experimental)"/><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/></head><body><p id="title"><a href="http://www.hibernate.org" class="site_href"><strong>Hibernate.org</strong></a><a href="http://hibernate.org/Documentation/DocumentationOverview" class="doc_href"><strong>Community Documentation</strong></a></p><ul class="docnav"><li class="previous"><a accesskey="p" href="ch13.html"><strong>Prev</strong></a></li><li class="next"><a accesskey="n" href="ch15.html"><strong>Next</strong></a></li></ul><div class="chapter" title="Chapter 14. Cassandra (Experimental)"><div class="titlepage"><div><div><h2 class="title"><a id="ogm-cassandra"/>Chapter 14. Cassandra (Experimental)</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="ch14.html#configuring_cassandra">14.1. Configuring Cassandra</a></span></dt><dd><dl><dt><span class="section"><a href="ch14.html#adding_cassandra_dependencies">14.1.1. Adding Cassandra dependencies</a></span></dt><dt><span class="section"><a href="ch14.html#cassandra_specific_configuration_properties">14.1.2. Cassandra specific configuration properties</a></span></dt></dl></dd><dt><span class="section"><a href="ch14.html#ogm-cassandra-storage-principles">14.2. Storage principles</a></span></dt><dd><dl><dt><span class="section"><a href="ch14.html#cassandra-types">14.2.1. Properties and built-in types</a></span></dt></dl></dd><dt><span class="section"><a href="ch14.html#transactions_and_concurrency">14.3. Transactions and Concurrency</a></span></dt><dt><span class="section"><a href="ch14.html#native_queries">14.4. Native queries</a></span></dt></dl></div><p><a class="link" href="http://cassandra.apache.org/">Cassandra</a> is a distributed column family database.</p><p>This implementation uses <a class="link" href="http://docs.datastax.com/en/cql/3.1/cql/cql_intro_c.html">CQL3</a>
 over the native wire protocol with <a class="link" href="https://github.com/datastax/java-driver">java-driver</a>.
The currently supported version is Cassandra 2.1.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h2>Note</h2><p>Support for Cassandra is considered an EXPERIMENTAL feature of this release.</p><p>Should you find any bugs or have feature requests for this dialect,
then please open a ticket in the <a class="link" href="https://hibernate.atlassian.net/browse/OGM">OGM issue tracker</a>.</p></div><div class="section" title="14.1. Configuring Cassandra"><div class="titlepage"><div><div><h2 class="title"><a id="configuring_cassandra"/>14.1. Configuring Cassandra</h2></div></div></div><p>Configuring Hibernate OGM to use Cassandra is easy:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">Add the Cassandra module and driver to the classpath</li><li class="listitem">provide the Cassandra connection information to Hibernate OGM</li></ul></div><div class="section" title="14.1.1. Adding Cassandra dependencies"><div class="titlepage"><div><div><h3 class="title"><a id="adding_cassandra_dependencies"/>14.1.1. Adding Cassandra dependencies</h3></div></div></div><p>To add the dependencies via Maven, add the following module:</p><pre><code class="language-xml">&lt;dependency&gt;
    &lt;groupId&gt;org.hibernate.ogm&lt;/groupId&gt;
    &lt;artifactId&gt;hibernate-ogm-cassandra&lt;/artifactId&gt;
    &lt;version&gt;5.0.4.Final&lt;/version&gt;
&lt;/dependency&gt;</code></pre><p>This will pull the Cassandra Java driver transparently.</p><p>If you’re not using a dependency management tool,
copy all the dependencies from the distribution in the directories:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><code class="literal">/lib/required</code></li><li class="listitem"><code class="literal">/lib/cassandra</code></li><li class="listitem">Optionally - depending on your container - you might need some of the jars from <code class="literal">/lib/provided</code></li></ul></div></div><div class="section" title="14.1.2. Cassandra specific configuration properties"><div class="titlepage"><div><div><h3 class="title"><a id="cassandra_specific_configuration_properties"/>14.1.2. Cassandra specific configuration properties</h3></div></div></div><p>To get started you will need to configure the following properties:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><code class="literal">hibernate.ogm.datastore.provider</code></li><li class="listitem"><code class="literal">hibernate.ogm.datastore.host</code></li><li class="listitem"><code class="literal">hibernate.ogm.datastore.database</code></li></ul></div><div class="variablelist" title="Cassandra datastore configuration properties"><p class="title"><strong>Cassandra datastore configuration properties</strong></p><dl><dt><span class="term">hibernate.ogm.datastore.provider</span></dt><dd>To use Cassandra as a datastore provider, this property must be set to <code class="literal">cassandra_experimental</code></dd><dt><span class="term">hibernate.ogm.datastore.host</span></dt><dd><p class="simpara">The hostname and port of the Cassandra instance.
The optional port is concatenated to the host and separated by a colon.
Let’s see a few valid examples:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><code class="literal">cassandra.example.com</code></li><li class="listitem"><code class="literal">cassandra.example.com:9043</code></li><li class="listitem"><code class="literal">2001:db8::ff00:42:8329</code> (IPv6)</li><li class="listitem"><p class="simpara"><code class="literal">[2001:db8::ff00:42:8329]:9043</code> (IPv6 with port requires the IPv6 to be surrounded by square brackets)</p><p class="simpara">Listing multiple initial hosts for fault tolerance is not currently supported.
The default value is <code class="literal">127.0.0.1:9042</code>. If left undefined, the default port is <code class="literal">9042</code>.</p></li></ul></div></dd><dt><span class="term">hibernate.ogm.datastore.port</span></dt><dd>Deprecated: use <code class="literal">hibernate.ogm.datastore.host</code>.
The port used by the Cassandra instance.
Ignored when multiple hosts are defined.
The default value is <code class="literal">9042</code>.</dd><dt><span class="term">hibernate.ogm.datastore.database</span></dt><dd>The database to connect to. This property has no default value.</dd><dt><span class="term">hibernate.ogm.datastore.username</span></dt><dd>The username used when connecting to the Cassandra server.
This property has no default value.</dd><dt><span class="term">hibernate.ogm.datastore.password</span></dt><dd>The password used to connect to the Cassandra server.
This property has no default value.</dd></dl></div></div></div><div class="section" title="14.2. Storage principles"><div class="titlepage"><div><div><h2 class="title"><a id="ogm-cassandra-storage-principles"/>14.2. Storage principles</h2></div></div></div><p>Each Entity type maps to one Cassandra table. Each Entity instance maps to one CQL3 row of the table, each property of the Entity being one CQL3 column.</p><p>CQL3 table and column names are always quoted to preserve case consistency with the Java layer, with the table name matching the Entity class and the column names matching the Entity’s properties.
The @Table and @Column annotations can be used to override identifier names in the usual manner.</p><p>Embedded objects are stored as additional columns in the owning Entitie’s table. The columns are named as <code class="literal">EmbeddedTypeName.FieldOfEmbeddedType</code>
The type and field names can be overridden by annotations, but concatenation token delimiter cannot.</p><div class="section" title="14.2.1. Properties and built-in types"><div class="titlepage"><div><div><h3 class="title"><a id="cassandra-types"/>14.2.1. Properties and built-in types</h3></div></div></div><p><a class="link" href="http://docs.datastax.com/en/cql/3.1/cql/cql_reference/cql_data_types_c.html">CQL3 types</a></p><p>CQL3 supports a smaller selection of numeric data types than Hibernate, so the missing types are automatically converted. <code class="literal">byte</code> and <code class="literal">short</code> values are promoted to <code class="literal">integer</code>.
<code class="literal">java.math.BigDecimal</code> is converted to <code class="literal">decimal</code>.</p><p>CQL3 has no character type, so character is promoted to varchar i.e. String. Strings are UTF-8, not ascii.</p><p>CQL3 does not distinguish between byte[] and BLOB types for binary storage. These are handled equivalently.</p><p>CQL3 does not have a Calendar type, so these are converted to Dates, which are stores as time offset from the unix epoch.</p><div class="section" title="14.2.1.1. Identifier generation strategies"><div class="titlepage"><div><div><h4 class="title"><a id="identifier_generation_strategies_5"/>14.2.1.1. Identifier generation strategies</h4></div></div></div><p>You can assign id values yourself or let Hibernate OGM generate the value using the
<code class="literal">@GeneratedValue</code> annotation.</p><p>The preferred identifier approach in Cassandra is to use UUIDs.</p><p>Cassandra does not natively support sequences (auto increment identifiers) at present. This approach is supported though use of an additional table to store sequence state, but incurs additional access overheads that make it undesirable for tables with frequent inserts.</p></div></div></div><div class="section" title="14.3. Transactions and Concurrency"><div class="titlepage"><div><div><h2 class="title"><a id="transactions_and_concurrency"/>14.3. Transactions and Concurrency</h2></div></div></div><p>Cassandra does not support transactions. Changes to a single Entity are atomic. Changes to more than one entity are neither atomic nor isolated.</p><p>Cassandra does not distinguish between update and insert operations and will not prevent creation of an Entity with duplicate Id, instead treating it as modification of the existing Entity.</p></div><div class="section" title="14.4. Native queries"><div class="titlepage"><div><div><h2 class="title"><a id="native_queries"/>14.4. Native queries</h2></div></div></div><p>Native queries are supported: you can execute native CQL queries using the <code class="literal">EntityManager</code> infrastructure.</p><p>Currently, only ordinal parameters are supported, named parameters do not work.</p><div class="example"><a id="d0e12643"/><p class="title"><strong>Example 14.1. Using native CQL queries</strong></p><div class="example-contents"><pre><code class="language-java">Query query = em.createNativeQuery( "SELECT * FROM \"WILDE_POEM\" WHERE name = ?" );
query.setParameter( 1, "Portia" ); // CQL parameters positions start at 1
List&lt;OscarWildePoem&gt; results = query.getResultList();</code></pre></div></div><br class="example-break"/><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><h2>Warning</h2><p>Unlike in JPQL, in CQL, parameters positions start at 1, not 0.</p></div></div></div><script xmlns="" xmlns:d="http://docbook.org/ns/docbook" type="text/javascript" src="highlight.js/highlight.pack.js"> </script><script xmlns="" xmlns:d="http://docbook.org/ns/docbook" type="text/javascript">hljs.initHighlightingOnLoad();</script><script type="text/javascript">
dataLayer = [{'channel' : 'Hibernate', 'additional_tracking_code' : 'UA-45270411-3'}];
(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-NJWS5L');</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-NJWS5L" height="0" width="0" style="display:none;visibility:hidden"> </iframe></noscript><hr xmlns="" xmlns:d="http://docbook.org/ns/docbook"/><a xmlns="" xmlns:d="http://docbook.org/ns/docbook" href="legalnotice.html"/><ul class="docnav"><li class="previous"><a accesskey="p" href="ch13.html"><strong>Prev</strong>Chapter 13. CouchDB (Experimental)</a></li><li class="up"><a accesskey="u" href="#"><strong>Up</strong></a></li><li class="home"><a accesskey="h" href="index.html"><strong>Home</strong></a></li><li class="next"><a accesskey="n" href="ch15.html"><strong>Next</strong>Chapter 15. Redis (Experimental)</a></li></ul><!-- HibernateDoc.OutdatedContent --><script src="//code.jquery.com/jquery-3.1.0.min.js" integrity="sha256-cCueBR6CsyA4/9szpPfrX3s49M9vUU5BgtiJj06wt/s=" crossorigin="anonymous"></script><script src="/hibernate/_outdated-content/outdated-content.js" type="text/javascript"></script><script type="text/javascript">var jQuery_3_1 = $.noConflict(true); jQuery_3_1(document).ready(function() { HibernateDoc.OutdatedContent.install("ogm"); });</script><!-- /HibernateDoc.OutdatedContent --></body></html>