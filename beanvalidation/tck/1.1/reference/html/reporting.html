<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><title xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory">Chapter 4. Reports</title><link rel="stylesheet" href="css/hibernate.css" type="text/css"/><meta xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" name="generator" content="DocBook XSL Stylesheets V1.74.0"/><link rel="home" href="index.html" title="TCK Reference Guide for JSR 349: Bean Validation"/><link rel="up" href="index.html" title="TCK Reference Guide for JSR 349: Bean Validation"/><link rel="prev" href="installation.html" title="Chapter 3. Installation"/><link rel="next" href="configuration.html" title="Chapter 5. Running the TCK test suite"/></head><body><p id="title"><a href="http://www.hibernate.org" class="site_href"><strong>Hibernate.org</strong></a><a href="http://hibernate.org/Documentation/DocumentationOverview" class="doc_href"><strong>Community Documentation</strong></a></p><ul class="docnav"><li class="previous"><a accesskey="p" href="installation.html"><strong>Prev</strong></a></li><li class="next"><a accesskey="n" href="configuration.html"><strong>Next</strong></a></li></ul><div class="chapter" lang="en-US"><div class="titlepage"><div><div><h2 class="title"><a id="reporting"/>Chapter 4. Reports</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="reporting.html#d0e402">4.1. Bean Validation TCK Coverage Report</a></span></dt><dd><dl><dt><span class="section"><a href="reporting.html#d0e409">4.1.1. Bean Validation TCK Assertions</a></span></dt><dt><span class="section"><a href="reporting.html#d0e438">4.1.2. The Coverage Report</a></span></dt></dl></dd><dt><span class="section"><a href="reporting.html#d0e511">4.2. The TestNG Report</a></span></dt><dd><dl><dt><span class="section"><a href="reporting.html#d0e516">4.2.1. Maven 2, Surefire and TestNG</a></span></dt></dl></dd></dl></div><p>This chapter covers the two types of reports that can be generated
  from the TCK, an assertion coverage report and the test execution
  results.</p><div class="section" lang="en-US"><div class="titlepage"><div><div><h2 class="title"><a id="d0e402"/>4.1. Bean Validation TCK Coverage Report</h2></div></div></div><p>A specification can be distilled into a collection of assertions
    that define the behavior of the software. This section introduces the Bean
    Validation TCK coverage report, which documents the relationship between
    the assertions that have been identified in the JSR 349 specification
    document and the tests in the TCK test suite.</p><p>The structure of this report is controlled by the assertion
    document, so we'll start there.</p><div class="section" lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a id="d0e409"/>4.1.1. Bean Validation TCK Assertions</h3></div></div></div><p>The Bean Validation TCK developers have analyzed the JSR 349
      specification document and identified the assertions that are present in
      each chapter. Here's an example of one such assertion found in section
      2.1: “<span class="quote">Every constraint annotation must define a message element of
      type String</span>”</p><p>The assertions are listed in the XML file
      <code class="filename">tck-audit.xml</code> in the Bean Validation TCK
      distribution. Each assertion is identified by the section of the
      specification document in which it resides and assigned a unique
      paragraph identifier to narrow down the location of the assertion
      further. To continue with the example, the assertion shown above is
      listed in the <code class="filename">tck-audit.xml</code> file using this XML
      fragment:</p><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="XML"><!-- XML : generated by JHighlight v1.0 (http://jhighlight.dev.java.net) -->
<span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">section</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">id</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;2.1.1&quot;</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">title</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;Constraint&nbsp;definition&nbsp;properties&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;...</span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">assertion</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">id</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;c&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">text</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">Every&nbsp;constraint&nbsp;annotation&nbsp;must&nbsp;define&nbsp;a&nbsp;message&nbsp;element&nbsp;of&nbsp;type&nbsp;String</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">text</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">assertion</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;...</span><br />
<span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">section</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
</pre><p>The strategy of the Bean Validation TCK is to write a test which
      validates this assertion when run against an implementation. A test case
      (a method annotated with <code class="literal">@Test</code>) is correlated with an
      assertion using the
      <code class="literal">@org.jboss.test.audit.annotations.SpecAssertion</code>
      annotation as follows:</p><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_plain">@</span><!-- <br/> --><span class="java_type">Test</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">SpecAssertion</span><span class="java_separator">(</span><span class="java_plain">section&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;2.1.1&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;id&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;c&quot;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">void</span><span class="java_plain">&nbsp;testConstraintDefinitionWithoutMessageParameter</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">try</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">Validator</span><span class="java_plain">&nbsp;validator&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_type">TestUtil</span><span class="java_separator">.</span><span class="java_plain">getValidatorUnderTest</span><span class="java_separator">();</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;validator</span><span class="java_separator">.</span><span class="java_plain">validate</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_keyword">new</span><span class="java_plain">&nbsp;</span><span class="java_type">DummyEntityNoMessage</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fail</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;The&nbsp;used&nbsp;constraint&nbsp;does&nbsp;not&nbsp;define&nbsp;a&nbsp;message&nbsp;parameter.&nbsp;The&nbsp;validation&nbsp;should&nbsp;have&nbsp;failed.&quot;</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">catch</span><span class="java_plain">&nbsp;</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_type">ConstraintDefinitionException</span><span class="java_plain">&nbsp;e&nbsp;</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_operator">//</span><span class="java_plain">&nbsp;success</span>
<!--  --><br/><span class="java_separator">}</span>
</pre><p>To help evaluate the distribution of coverage for these
      assertions, the TCK provides a detailed coverage report. This report is
      also useful to help implementors match tests with the language in the
      specification that supports the behavior being tested.</p></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a id="d0e438"/>4.1.2. The Coverage Report</h3></div></div></div><p>The coverage report is an HTML report generated as part of the TCK
      project build. Specifically, it is generated by an annotation processor
      that attaches to the compilation of the classes in the TCK test
      suite.</p><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="tip"><h2>Tip</h2><p>You can find the source code for this processor in the GitHub
          repository <a class="ulink" href="https://github.com/jboss/jboss-test-audit">https://github.com/jboss/jboss-test-audit</a></p></div><p> The report is written to the file
      <code class="filename">target/coverage-report/coverage-beanvalidation.html</code>.
      The report itself has five sections:</p><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="orderedlist"><ol><li><p><span class="bold"><strong>Chapter Summary</strong></span> - List the
          chapters (that contain assertions) in the specification document
          along with total assertions, tests and coverage percentage.</p></li><li><p><span class="bold"><strong>Section Summary</strong></span> - Lists the
          sections (that contain assertions) in the specification document
          along with total assertions, tests and coverage percentage.</p></li><li><p><span class="bold"><strong>Coverage Detail</strong></span> - Each
          assertion and the test that covers it, if any.</p></li><li><p><span class="bold"><strong>Unmatched Tests</strong></span> - A list of
          tests for which there is no matching assertion (useful during TCK
          development).</p></li><li><p><span class="bold"><strong>Unversioned Tests</strong></span> - A list of
          tests for which there is no <code class="literal">@SpecVersion</code>
          annotation on the test class (useful during TCK development).</p></li></ol></div><p>The coverage report is color coded to indicate the status of an
      assertion, or group of assertions. The status codes are as
      follows:</p><div class="itemizedlist"><ul><li><p><span class="bold"><strong>Covered</strong></span> - a test exists for
          this assertion</p></li><li><p><span class="bold"><strong>Not covered</strong></span> - no test exists
          for this assertion</p></li><li><p><span class="bold"><strong> Unimplemented</strong></span> - a test
          exists, but is unimplemented</p></li><li><p><span class="bold"><strong>Untestable</strong></span> - the assertion
          has been deemed untestable, a note, explaining why, is normally
          provided</p></li></ul></div><p>For reasons provided in the <code class="literal">tck-audit.xml</code>
      document and presented in the coverage report, some assertions are not
      testable.</p><p>The coverage report does not give any indication as to whether the
      tests are passing. That's where the TestNG reports come in.</p></div></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h2 class="title"><a id="d0e511"/>4.2. The TestNG Report</h2></div></div></div><p>As you by now know, the Bean Validation TCK test suite is really
    just a TestNG test suite. That means an execution of the Bean Validation
    TCK test suite produces all the same reports that TestNG produces. This
    section will go over those reports and show you were to go to find each of
    them.</p><div class="section" lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a id="d0e516"/>4.2.1. Maven 2, Surefire and TestNG</h3></div></div></div><p>When the Bean Validation TCK test suite is executed during the
      Maven 2 test phase of the TCK runner project, TestNG is invoked
      indirectly through the Maven Surefire plugin. Surefire is a test
      execution abstraction layer capable of executing a mix of tests written
      for JUnit, TestNG, and other supported test frameworks.</p><p>Why is this relevant? It means two things. First, it means that
      you are going to get a summary of the test run on the commandline.
      Here's the output generated when the tests are run using standalone
      mode.</p><pre class="programlisting">-------------------------------------------------------
 T E S T S
-------------------------------------------------------
Running TestSuite
Tests run: 697, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 26.413 sec

Results :

Tests run: 697, Failures: 0, Errors: 0, Skipped: 0
</pre><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="note"><h2>Note</h2><p>The number of tests executed, the execution time, and the output
        will differ when you run the tests using in-container mode as the Bean
        Validation TCK requires.</p></div><p>If the Maven reporting plugin that compliments Surefire is
      configured properly, Maven will also generate a generic HTML test result
      report. That report is written to the file test-report.html in the
      <code class="filename">target/surefire-reports</code> directory of the TCK runner
      project. It shows how many tests were run, how many failed and the
      success rate of the test run.</p></div></div></div><HR xmlns=""/><a xmlns="" href=""><p xmlns="http://www.w3.org/1999/xhtml" class="copyright">Copyright © 2009 - 2014 Red Hat, Inc.</p></a><ul class="docnav"><li class="previous"><a accesskey="p" href="installation.html"><strong>Prev</strong>Chapter 3. Installation</a></li><li class="up"><a accesskey="u" href="#"><strong>Top of page</strong></a></li><li class="home"><a accesskey="h" href="index.html"><strong>Front page</strong></a></li><li class="next"><a accesskey="n" href="configuration.html"><strong>Next</strong>Chapter 5. Running the TCK test suite</a></li></ul></body></html>