<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.16">
<title>Hibernate Search 6.0.10.Final: Migration Guide from 5.11</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/*! Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment the following line when using as a custom stylesheet */
/* @import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"; */
html{font-family:sans-serif;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
b,strong{font-weight:bold}
abbr{font-size:.9em}
abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}
dfn{font-style:italic}
hr{height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type=checkbox],input[type=radio]{padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,::before,::after{box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:1px solid #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 0 0 .1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin:0 auto;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:flex;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:hsla(0,0%,100%,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details{margin-left:1.25rem}
details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;-webkit-tap-highlight-color:transparent}
details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}
details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}
details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border:1px solid #e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos{border-right:1px solid;opacity:.35;padding-right:.5em}
pre.pygments .lineno{border-right:1px solid;opacity:.35;display:inline-block;margin-right:.75em}
pre.pygments .lineno::before{content:"";margin-right:-.125em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans-serif;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all tr,table.stripes-odd tr:nth-of-type(odd),table.stripes-even tr:nth-of-type(even),table.stripes-hover tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist>li>p:first-child{margin-left:-1em}
ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist>li>p:first-child>input[type=checkbox]:first-child{margin-right:.25em}
ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt,summary{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt,summary{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]{border-bottom:1px dotted}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media amzn-kf8,print{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<link rel="stylesheet" href="css/font-awesome/css/font-awesome.min.css">
<style>
/* Stylesheet for CodeRay to match GitHub theme | MIT License | http://foundation.zurb.com */
pre.CodeRay{background:#f7f7f8}
.CodeRay .line-numbers{border-right:1px solid currentColor;opacity:.35;padding:0 .5em 0 0}
.CodeRay span.line-numbers{display:inline-block;margin-right:.75em}
.CodeRay .line-numbers strong{color:#000}
table.CodeRay{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.CodeRay td{vertical-align:top;line-height:inherit}
table.CodeRay td.line-numbers{text-align:right}
table.CodeRay td.code{padding:0 0 0 .75em}
.CodeRay .debug{color:#fff !important;background:#000080 !important}
.CodeRay .annotation{color:#007}
.CodeRay .attribute-name{color:#000080}
.CodeRay .attribute-value{color:#700}
.CodeRay .binary{color:#509}
.CodeRay .comment{color:#998;font-style:italic}
.CodeRay .char{color:#04d}
.CodeRay .char .content{color:#04d}
.CodeRay .char .delimiter{color:#039}
.CodeRay .class{color:#458;font-weight:bold}
.CodeRay .complex{color:#a08}
.CodeRay .constant,.CodeRay .predefined-constant{color:#008080}
.CodeRay .color{color:#099}
.CodeRay .class-variable{color:#369}
.CodeRay .decorator{color:#b0b}
.CodeRay .definition{color:#099}
.CodeRay .delimiter{color:#000}
.CodeRay .doc{color:#970}
.CodeRay .doctype{color:#34b}
.CodeRay .doc-string{color:#d42}
.CodeRay .escape{color:#666}
.CodeRay .entity{color:#800}
.CodeRay .error{color:#808}
.CodeRay .exception{color:inherit}
.CodeRay .filename{color:#099}
.CodeRay .function{color:#900;font-weight:bold}
.CodeRay .global-variable{color:#008080}
.CodeRay .hex{color:#058}
.CodeRay .integer,.CodeRay .float{color:#099}
.CodeRay .include{color:#555}
.CodeRay .inline{color:#000}
.CodeRay .inline .inline{background:#ccc}
.CodeRay .inline .inline .inline{background:#bbb}
.CodeRay .inline .inline-delimiter{color:#d14}
.CodeRay .inline-delimiter{color:#d14}
.CodeRay .important{color:#555;font-weight:bold}
.CodeRay .interpreted{color:#b2b}
.CodeRay .instance-variable{color:#008080}
.CodeRay .label{color:#970}
.CodeRay .local-variable{color:#963}
.CodeRay .octal{color:#40e}
.CodeRay .predefined{color:#369}
.CodeRay .preprocessor{color:#579}
.CodeRay .pseudo-class{color:#555}
.CodeRay .directive{font-weight:bold}
.CodeRay .type{font-weight:bold}
.CodeRay .predefined-type{color:inherit}
.CodeRay .reserved,.CodeRay .keyword {color:#000;font-weight:bold}
.CodeRay .key{color:#808}
.CodeRay .key .delimiter{color:#606}
.CodeRay .key .char{color:#80f}
.CodeRay .value{color:#088}
.CodeRay .regexp .delimiter{color:#808}
.CodeRay .regexp .content{color:#808}
.CodeRay .regexp .modifier{color:#808}
.CodeRay .regexp .char{color:#d14}
.CodeRay .regexp .function{color:#404;font-weight:bold}
.CodeRay .string{color:#d20}
.CodeRay .string .string .string{background:#ffd0d0}
.CodeRay .string .content{color:#d14}
.CodeRay .string .char{color:#d14}
.CodeRay .string .delimiter{color:#d14}
.CodeRay .shell{color:#d14}
.CodeRay .shell .delimiter{color:#d14}
.CodeRay .symbol{color:#990073}
.CodeRay .symbol .content{color:#a60}
.CodeRay .symbol .delimiter{color:#630}
.CodeRay .tag{color:#008080}
.CodeRay .tag-special{color:#d70}
.CodeRay .variable{color:#036}
.CodeRay .insert{background:#afa}
.CodeRay .delete{background:#faa}
.CodeRay .change{color:#aaf;background:#007}
.CodeRay .head{color:#f8f;background:#505}
.CodeRay .insert .insert{color:#080}
.CodeRay .delete .delete{color:#800}
.CodeRay .change .change{color:#66f}
.CodeRay .head .head{color:#f4f}
</style>
<!-- HibernateDoc.Meta -->
<meta name="description" content="Hibernate Search, full text search for your entities - Reference Documentation" />
<meta name="keywords" content="hibernate, search, hibernate search, full text, lucene, elasticsearch" />
<link rel="canonical" href="https://docs.jboss.org/hibernate/stable/search/reference/en-US/html_single/" />
<!-- /HibernateDoc.Meta -->

<link rel="stylesheet" href="css/hibernate.css" type="text/css" />

<!-- Dynamic TOC -->
<!-- Source: https://github.com/asciidoctor/asciidoctor/issues/699#issuecomment-321066006 -->
<style>
  /* Tocbot dynamic TOC, works with tocbot 3.0.2 */
  #tocbot a.toc-link.node-name--H1{ font-style: italic }
  @media screen{
    #tocbot > ul.toc-list{ margin-bottom: 0.5em; margin-left: 0.125em }
    #tocbot ul.sectlevel0, #tocbot a.toc-link.node-name--H1 + ul{
      padding-left: 0 }
    #tocbot a.toc-link{ height:100% }
    .is-collapsible{ max-height:3000px; overflow:hidden; }
    .is-collapsed{ max-height:0 }
    .is-active-link{ font-weight:700 }
  }
  @media print{
    #tocbot a.toc-link.node-name--H4{ display:none }
    #tocbot a.toc-link.node-name--H5{ display:none }
    #tocbot a.toc-link.node-name--H6{ display:none }
  }
</style>
<!-- /Dynamic TOC -->

<!-- Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-282CVRCQHZ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-282CVRCQHZ');
</script>
<!-- /Google Analytics -->
</head>
<body class="book toc2 toc-left">
<div id="header">
<h1>Hibernate Search 6.0.10.Final: Migration Guide from 5.11</h1>
<div class="details">
<span id="revdate">2022-08-23</span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#introduction"> Introduction</a></li>
<li><a href="#recommended-procedure">Recommended procedure</a></li>
<li><a href="#requirements">Requirements</a></li>
<li><a href="#maven-coordinates">Maven coordinates changes</a></li>
<li><a href="#data-format">Data format and schema changes</a></li>
<li><a href="#migration-helper">Migration helper</a>
<ul class="sectlevel2">
<li><a href="#migration-helper-purpose"> Purpose</a></li>
<li><a href="#migration-helper-howto"> How to use the migration helper</a></li>
<li><a href="#migration-helper-limitations">Limitations of the migration helper</a></li>
</ul>
</li>
<li><a href="#configuration">Configuration changes</a>
<ul class="sectlevel2">
<li><a href="#configuration-basics">Basics</a></li>
<li><a href="#configuration-contants"> Constants for property keys</a></li>
<li><a href="#configuration-property-reference"> Configuration property reference</a></li>
<li><a href="#jmx">JMX</a></li>
<li><a href="#search-5-backends">Backends</a></li>
</ul>
</li>
<li><a href="#api">API changes</a>
<ul class="sectlevel2">
<li><a href="#mapping-annotation">Annotation mapping</a>
<ul class="sectlevel3">
<li><a href="#analyzer"><code>@Analyzer</code></a></li>
<li><a href="#analyzerdef"><code>@AnalyzerDef</code>, <code>@AnalyzerDefs</code></a></li>
<li><a href="#analyzerdiscriminator"><code>@AnalyzerDiscriminator</code></a></li>
<li><a href="#boost"><code>@Boost</code></a></li>
<li><a href="#cachefromindex"><code>@CacheFromIndex</code></a></li>
<li><a href="#calendarbridge"><code>@CalendarBridge</code></a></li>
<li><a href="#charfilterdef"><code>@CharFilterDef</code></a></li>
<li><a href="#classbridge"><code>@ClassBridge</code>, <code>@ClassBridges</code></a></li>
<li><a href="#containedin"><code>@ContainedIn</code></a></li>
<li><a href="#datebridge"><code>@DateBridge</code></a></li>
<li><a href="#documentid"><code>@DocumentId</code></a></li>
<li><a href="#dynamicboost"><code>@DynamicBoost</code></a></li>
<li><a href="#facet"><code>@Facet</code>, <code>@Facets</code></a>
<ul class="sectlevel4">
<li><a href="#facet-basics">Basics</a></li>
<li><a href="#facet-encoding"> <code>@Facet.encoding</code></a></li>
</ul>
</li>
<li><a href="#field"><code>@Field</code>, <code>@Fields</code></a>
<ul class="sectlevel4">
<li><a href="#field-basics">Basics</a></li>
<li><a href="#field-analyze"><code>@Field.analyze</code></a></li>
<li><a href="#field-analyzer"><code>@Field.analyzer</code></a></li>
<li><a href="#field-boost"><code>@Field.boost</code></a></li>
<li><a href="#field-bridge"><code>@Field.bridge</code></a></li>
<li><a href="#field-index"><code>@Field.index</code></a></li>
<li><a href="#field-indexnullas"><code>@Field.indexNullAs</code></a></li>
<li><a href="#field-name"><code>@Field.name</code></a></li>
<li><a href="#field-normalizer"><code>@Field.normalizer</code></a></li>
<li><a href="#field-norms"><code>@Field.norms</code></a></li>
<li><a href="#field-store"><code>@Field.store</code></a></li>
<li><a href="#field-termVector"><code>@Field.termVector</code></a></li>
</ul>
</li>
<li><a href="#fieldbridge"><code>@FieldBridge</code></a></li>
<li><a href="#fulltextfilterdef"><code>@FullTextFilterDef</code>, <code>@FullTextFilterDefs</code></a></li>
<li><a href="#indexed"><code>@Indexed</code></a>
<ul class="sectlevel4">
<li><a href="#indexed-basics">Basics</a></li>
<li><a href="#indexed-index"> <code>@Indexed.index</code></a></li>
<li><a href="#indexed-interceptor"> <code>@Indexed.interceptor</code></a></li>
</ul>
</li>
<li><a href="#indexedembeded"><code>@IndexedEmbedded</code></a>
<ul class="sectlevel4">
<li><a href="#indexedembeded-basics">Basics</a></li>
<li><a href="#indexedembeded-depth"> <code>@IndexedEmbedded.depth</code></a></li>
<li><a href="#indexedembeded-includePaths"> <code>@IndexedEmbedded.includePaths</code></a></li>
<li><a href="#indexedembeded-prefix"> <code>@IndexedEmbedded.prefix</code></a></li>
<li><a href="#indexedembeded-targetElement"> <code>@IndexedEmbedded.targetElement</code></a></li>
<li><a href="#indexedembeded-indexNullAs"> <code>@IndexedEmbedded.indexNullAs</code></a></li>
<li><a href="#indexedembeded-includeEmbeddedObjectId"> <code>@IndexedEmbedded.includeEmbeddedObjectId</code></a></li>
<li><a href="#indexedembeded-containerextraction"> Using <code>@IndexedEmbedded</code> to request container extraction</a></li>
</ul>
</li>
<li><a href="#key"><code>@Key</code></a></li>
<li><a href="#latitude"><code>@Latitude</code></a></li>
<li><a href="#longitude"><code>@Longitude</code></a></li>
<li><a href="#normalizer"><code>@Normalizer</code></a></li>
<li><a href="#normalizerdef"><code>@NormalizerDef</code>, <code>@NormalizerDefs</code></a></li>
<li><a href="#numericfield"> <code>@NumericField</code>, <code>@NumericFields</code></a></li>
<li><a href="#providedid"> <code>@ProvidedId</code></a></li>
<li><a href="#sortablefield"><code>@SortableField</code>, <code>@SortableFields</code></a></li>
<li><a href="#spatial"><code>@Spatial</code>, <code>@Spatials</code></a>
<ul class="sectlevel4">
<li><a href="#spatial-basics">Basics</a></li>
<li><a href="#spatial-boost"><code>@Spatial.boost</code></a></li>
<li><a href="#spatial-name"><code>@Spatial.name</code></a></li>
<li><a href="#spatial-spatialmode"><code>@Spatial.spatialMode</code>, <code>@Spatial.topSpatialHashLevel</code>, <code>@Spatial.bottomSpatialHashLevel</code></a></li>
<li><a href="#spatial-store"><code>@Spatial.store</code></a></li>
</ul>
</li>
<li><a href="#tikabridge"><code>@TikaBridge</code></a></li>
<li><a href="#tokenfilterdef"><code>@TokenFilterDef</code></a></li>
<li><a href="#tokenizerdef"><code>@TokenizerDef</code></a></li>
</ul>
</li>
<li><a href="#mapping-programmatic">Programmatic mapping</a></li>
<li><a href="#analysis-definition-provider">Analysis definition provider</a></li>
<li><a href="#bridges">Bridges</a></li>
<li><a href="#entity-indexing-interceptors">Entity indexing interceptors</a></li>
<li><a href="#fulltextsession"><code>FullTextEntityManager</code>/<code>FullTextSession</code></a>
<ul class="sectlevel3">
<li><a href="#fulltextsession-basics">Basics</a></li>
<li><a href="#fulltextsession-createfulltextquery"><code>FullTextSession.createFullTextQuery</code></a></li>
<li><a href="#fulltextsession-indexing"><code>FullTextSession.index(&#8230;&#8203;)</code>, <code>FullTextSession.purge(&#8230;&#8203;)</code></a></li>
<li><a href="#fulltextsession-flushtoindexes"><code>FullTextSession.flushToIndexes()</code></a></li>
<li><a href="#fulltextsession-purgeall"><code>FullTextSession.purgeAll(&#8230;&#8203;)</code></a></li>
<li><a href="#fulltextsession-createindexer"><code>FullTextSession.createIndexer(&#8230;&#8203;)</code></a></li>
</ul>
</li>
<li><a href="#searching">Searching</a>
<ul class="sectlevel3">
<li><a href="#searching-fulltextquery"><code>FullTextQuery</code> &#8658; DSL</a>
<ul class="sectlevel4">
<li><a href="#searching-fulltextquery-basics">Basics</a></li>
<li><a href="#searching-fulltextquery-jpa-orm">Adapter from search query to JPA/ORM query</a></li>
<li><a href="#searching-fulltextquery-initializeObjectsWith"><code>FullTextQuery.initializeObjectsWith</code></a></li>
<li><a href="#searching-fulltextquery-setCriteriaQuery"><code>FullTextQuery.setCriteriaQuery(&#8230;&#8203;)</code></a></li>
<li><a href="#searching-fulltextquery-explain"><code>FullTextQuery.explain(&#8230;&#8203;)</code></a></li>
<li><a href="#searching-fulltextquery-setfilter"><code>FullTextQuery.setFilter(&#8230;&#8203;)</code></a></li>
<li><a href="#searching-fulltextquery-fulltextfilter"><code>FullTextQuery.enableFullTextFilter(&#8230;&#8203;)</code> / <code>FullTextQuery.disableFullTextFilter(&#8230;&#8203;)</code></a></li>
</ul>
</li>
<li><a href="#queries"><code>org.apache.lucene.search.Query</code> &#8658; <code>SearchPredicate</code></a>
<ul class="sectlevel4">
<li><a href="#queries-basics">Basics</a></li>
<li><a href="#queries-reference"><code>Query</code> DSL migration reference</a></li>
<li><a href="#queries-native">Native query</a></li>
</ul>
</li>
<li><a href="#sorts"><code>org.apache.lucene.search.Sort</code> / <code>SortField</code> &#8658; <code>SearchSort</code></a>
<ul class="sectlevel4">
<li><a href="#sorts-reference"><code>Sort</code> DSL migration reference</a></li>
<li><a href="#sorts-native">Native sorts</a></li>
</ul>
</li>
<li><a href="#projections">Projections</a>
<ul class="sectlevel4">
<li><a href="#projections-basics">Basics</a></li>
<li><a href="#projections-reference"><code>ProjectionConstants</code>/<code>ElasticsearchProjectionConstants</code> migration reference</a></li>
</ul>
</li>
<li><a href="#searching-facet">Facets &#8658; Aggregations</a>
<ul class="sectlevel4">
<li><a href="#searching-facet-discrete-faceting"> Discrete faceting</a></li>
<li><a href="#searching-facet-range-faceting"> Range faceting</a></li>
<li><a href="#searching-facets-selectfacets">Drill-down with <code>.selectFacets</code></a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#error-handler">Error handler</a></li>
<li><a href="#full-text-filter">Full-text filter</a></li>
<li><a href="#factory"><code>@Factory</code></a></li>
<li><a href="#searchexception"><code>SearchException</code></a></li>
<li><a href="#sharding">Sharding: <code>IndexShardingStrategy</code>/<code>ShardIdentifierProvider</code>/<code>ShardIdentifierProviderTemplate</code></a></li>
<li><a href="#searchfactory"> <code>SearchFactory</code></a>
<ul class="sectlevel3">
<li><a href="#searchfactory-basics">Basics</a></li>
<li><a href="#searchfactory-optimize">Merging segments: <code>SearchFactory.optimize()</code>/<code>SearchFactory.optimize(&#8230;&#8203;)</code></a></li>
<li><a href="#searchfactory-getanalyzer">Getting Lucene analyzers: <code>SearchFactory.getAnalyzer(&#8230;&#8203;)</code></a></li>
<li><a href="#searchfactory-buildquerybuilder">Building queries: <code>SearchFactory.buildQueryBuilder()</code></a></li>
<li><a href="#searchfactory-getstatistics">Statistics: <code>SearchFactory.getStatistics()</code></a></li>
<li><a href="#searchfactory-getindexreaderaccessor">Accessing Lucene index readers: <code>SearchFactory.getIndexReaderAccessor</code></a></li>
<li><a href="#metamodel">Metamodel: <code>SearchFactory.getIndexedTypeDescriptor</code>, <code>SearchFactory.getIndexedTypes</code></a></li>
<li><a href="#searchfactory-getindexfamily">Accessing the Elasticsearch client: <code>SearchFactory.getIndexFamily</code></a></li>
</ul>
</li>
<li><a href="#massindexer"><code>MassIndexer</code></a>
<ul class="sectlevel3">
<li><a href="#massindexer-basics">Basics</a></li>
<li><a href="#massindexer-optimizeonfinish"><code>MassIndexer.optimizeOnFinish(&#8230;&#8203;)</code></a></li>
<li><a href="#massindexer-optimizeafterpurge"><code>MassIndexer.optimizeAfterPurge(&#8230;&#8203;)</code></a></li>
<li><a href="#massindexer-progressmonitor"><code>MassIndexer.progressMonitor(&#8230;&#8203;)</code></a></li>
<li><a href="#massindexer-threadsforsubsequentfetching"><code>MassIndexer.threadsForSubsequentFetching(&#8230;&#8203;)</code></a></li>
</ul>
</li>
<li><a href="#jsr352">Batch (JSR-352) integration</a></li>
</ul>
</li>
<li><a href="#spi">SPI changes</a></li>
<li><a href="#behavior">Behavior changes</a>
<ul class="sectlevel2">
<li><a href="#behavior-default-bridge-java-util-class"> No default bridge for <code>java.util.Class</code></a></li>
<li><a href="#document-id-is-not-a-field">The document ID is not an index field</a></li>
<li><a href="#indexed-is-inherited"><code>@Indexed</code> is inherited</a></li>
<li><a href="#index-exclusive">One index &#8658; one type</a></li>
<li><a href="#index-name-defaults-to-entity-name">The index name defaults to the entity name</a></li>
<li><a href="#indexnullas-is-for-indexing"><code>indexNullAs</code> is irrelevant when building predicates and when projecting</a></li>
<li><a href="#faceting-strings-are-normalized">Faceting returns normalized strings</a></li>
<li><a href="#automatic-indexing-across-associations-by-default"><code>@IndexedEmbedded</code> on an association enables reindexing when the target entity changes by default</a></li>
<li><a href="#indexed-transient-requires-configuration">Indexed, <code>@Transient</code> properties require additional configuration</a></li>
<li><a href="#implicit-container-extraction">Container extraction for <code>@*Field</code> is implied</a></li>
<li><a href="#more-numeric-by-default">More fields are numeric by default</a></li>
<li><a href="#scrolling-forward-only">Scrolling is forward-only</a></li>
<li><a href="#scrolling-iterate-batch-loading">Scrolling/<code>Query.iterate()</code> load entities eagerly in batches</a></li>
<li><a href="#sort-missing-values-last-by-default">When sorting by field value or distance, missing values are last by default</a></li>
<li><a href="#query-logging-trace">Logger <code>org.hibernate.search.query</code> uses the <code>TRACE</code> level</a></li>
<li><a href="#default-similarity">The default similarity for Lucene is now BM25</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="introduction"><a class="anchor" href="#introduction"></a><a id="_introduction"></a> Introduction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The aim of this guide is to assist you migrating
an existing application using any version <code>5.11.x</code> of Hibernate Search
to the latest of the <code>6.0.x</code> series.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If you think something is missing or something does not work, please <a href="https://hibernate.org/community">contact us</a>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If you&#8217;re looking to migrate from an earlier version,
you should migrate step-by-step, from one minor version to the next,
following the migration guide of <a href="https://hibernate.org/search/documentation/">each version</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="recommended-procedure"><a class="anchor" href="#recommended-procedure"></a>Recommended procedure</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Search 6 introduces new APIs, so migrating older projects will be more work than usual.</p>
</div>
<div class="paragraph">
<p>To facilitate the process of migrating, Hibernate Search 6 includes a "migration helper" module
that allows you to use the Hibernate Search 5 APIs with Hibernate Search 6 and a Lucene backend under the hood.
However, this module does not offer full backward compatibility: for some features that changed dramatically,
it may not be possible to use the Search 5 APIs anymore.
See <a href="#migration-helper">Migration helper</a> for more information.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>For those who cannot afford to, or do not want to, spend the time required to migrate,
we intend to continue maintenance releases (= bugfixes) of Hibernate Search 5.x:
no end-of-life date has been set at the moment.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="requirements"><a class="anchor" href="#requirements"></a>Requirements</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Hibernate Search 6 is still compatible with both JDK8 and JDK11.</p>
</div>
<div class="paragraph">
<p>The required versions of dependencies changed:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The Hibernate ORM mapper now requires Hibernate ORM 5.4.32.Final
(5.4.3.Final and earlier won&#8217;t work correctly).</p>
</li>
<li>
<p>The Elasticsearch backend now requires Elasticsearch 5.6, 6.8 or 7.10.</p>
</li>
<li>
<p>The Lucene backend now requires Lucene 8.7.0.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="maven-coordinates"><a class="anchor" href="#maven-coordinates"></a>Maven coordinates changes</h2>
<div class="sectionbody">
<div class="paragraph">
<p>If you pull Hibernate Search artifacts from a Maven repository and you come from Hibernate Search 5,
be aware that just bumping the version number will not be enough:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the group IDs changed from <code>org.hibernate</code> to <code>org.hibernate.search</code></p>
</li>
<li>
<p>most of the artifact IDs changed to reflect the new mapper/backend design</p>
</li>
<li>
<p>the Lucene integration now requires an explicit dependency instead of being pulled by the engine by default.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Read the <a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#getting-started-dependencies">getting started guide, section "dependencies"</a>
for more information.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="data-format"><a class="anchor" href="#data-format"></a>Data format and schema changes</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Indexes created with Hibernate Search 5 or earlier are not compatible with Hibernate Search 6.
This goes for embedded-Lucene indexes as well as Elasticsearch indexes.</p>
</div>
<div class="paragraph">
<p>In order to upgrade an application to Hibernate Search 6, all data must be reindexed.
See <a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#mapper-orm-indexing-massindexer">the documentation of the <code>MassIndexer</code></a>
for instructions.</p>
</div>
<div class="paragraph">
<p>Similarly, native queries/predicates/sorts targeting Hibernate Search 5 indexes
(e.g. manual instantiation of Lucene <code>Query</code> types, Elasticsearch JSON) may not work correctly
with Hibernate Search 6, because the underlying type of some fields may have changed.
To avoid that sort of problem in future major upgrades, we recommend you use the <a href="#searching">Hibernate Search DSL</a>
to create predicates and sorts,
so that Hibernate Search will automatically pick the right predicate/sort depending on the field type.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="migration-helper"><a class="anchor" href="#migration-helper"></a>Migration helper</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="migration-helper-purpose"><a class="anchor" href="#migration-helper-purpose"></a><a id="_purpose"></a> Purpose</h3>
<div class="paragraph">
<p>Hibernate Search 6 includes a temporary additional "migration helper" module
that provides partial compatibility with Hibernate Search 5 APIs backed by the Hibernate Search 6 implementations.</p>
</div>
<div class="paragraph">
<p>This module should make migration easier by making sure that code relying on the most-frequently-used APIs
(mapping annotations, search DSL, &#8230;&#8203;)
continues to compile and run.
The idea is to use the migration helper temporarily to make most of the application code (search queries, &#8230;&#8203;) work,
making it easier to focus on migrating configuration and to assess the effort required to migrate the remaining code.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The migration helper only works with a Lucene backend.</p>
</div>
<div class="paragraph">
<p>Hibernate Search 5 APIs are not well suited to Elasticsearch,
so applications relying on Hibernate Search 5&#8217;s experimental Elasticsearch integration
should migrate to the more adapted Hibernate Search 6 APIs right away.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The migration helper should not be used in production environments.</p>
</div>
<div class="paragraph">
<p>It has limitations preventing full compatibility with Hibernate Search 5,
and these limitations will never be addressed.</p>
</div>
<div class="paragraph">
<p>All APIs defined in the migration helper are deprecated and will be removed in the next major version
of Hibernate Search.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="migration-helper-howto"><a class="anchor" href="#migration-helper-howto"></a><a id="_how_to_use_the_migration_helper"></a> How to use the migration helper</h3>
<div class="paragraph">
<p>To use the migration helper, add the following dependency to your project:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="XML"><span class="tag">&lt;dependency&gt;</span>
   <span class="tag">&lt;groupId&gt;</span>org.hibernate.search<span class="tag">&lt;/groupId&gt;</span>
   <span class="tag">&lt;artifactId&gt;</span>hibernate-search-v5migrationhelper-orm<span class="tag">&lt;/artifactId&gt;</span>
   <span class="tag">&lt;version&gt;</span>6.0.10.Final<span class="tag">&lt;/version&gt;</span>
<span class="tag">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Then, try to recompile your application.
Compilation errors should point you to the most significant API changes that require your immediate attention;
most of the code that still compiles should work as it used to in Hibernate Search 5.</p>
</div>
</div>
<div class="sect2">
<h3 id="migration-helper-limitations"><a class="anchor" href="#migration-helper-limitations"></a>Limitations of the migration helper</h3>
<div class="paragraph">
<p>First, the migration helper <strong>only works with a Lucene backend</strong>.
Hibernate Search 5 APIs are not well suited to Elasticsearch,
so applications relying on Hibernate Search 5&#8217;s experimental Elasticsearch integration
should migrate to the more adapted Hibernate Search 6 APIs right away.</p>
</div>
<div class="paragraph">
<p>Second, the migration helper only addresses Java API compatibility.
This excludes in particular:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Configuration properties: they must still be <a href="#configuration">replaced with Search 6 properties</a>.</p>
</li>
<li>
<p>Data format: data must still be <a href="#data-format">reindexed</a>.</p>
</li>
<li>
<p>Behavior: most of the <a href="#behavior">behavior changes</a> in Hibernate Search 6 also affect the migration helper.
In particular, <a href="#index-exclusive">One index &#8658; one type</a>, <a href="#indexed-is-inherited"><code>@Indexed</code> is inherited</a> and <a href="#document-id-is-not-a-field">The document ID is not an index field</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Finally, even for Java APIs, not <strong>all</strong> APIs from Hibernate Search 5 are present in the migration helper.
You should get compilation errors when APIs are missing, which should make them easy to spot,
but here are the main pitfalls:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>APIs that have no equivalent in Hibernate Search 6
are not available in the migration helper.</p>
<div class="paragraph">
<p>This includes in particular <a href="#full-text-filter">full-text filters</a>, <a href="#boost">index-time boost</a>,
<a href="#searchfactory-getstatistics">statistics</a>, <a href="#searchfactory-getindexreaderaccessor"><code>IndexReaderAccessor</code></a>,
<a href="#analyzer">referring to analyzers by class</a>,
annotation-based analyzer definitions (<a href="#analyzerdef"><code>@AnalyzerDef</code>, <code>@AnalyzerDefs</code></a>/<a href="#normalizerdef"><code>@NormalizerDef</code>, <code>@NormalizerDefs</code></a>),
<a href="#analyzerdiscriminator"><code>@AnalyzerDiscriminator</code></a>, &#8230;&#8203;</p>
</div>
</li>
<li>
<p>Hibernate Search 5 bridges cannot be used in the migration helper.
You can however mix Hibernate Search 5 annotations with Hibernate Search 6 annotations,
so feel free to migrate only annotations where a custom bridge is used (see <a href="#field"><code>@Field</code>, <code>@Fields</code></a>), as a first step.</p>
</li>
<li>
<p>Hibernate Search 5 programmatic mapping cannot be used in the migration helper.
You should move to the Hibernate Search 6 programmatic mapping, as explained <a href="#mapping-programmatic">here</a>.</p>
</li>
<li>
<p>Hibernate Search 5 metamodel APIs cannot be used in the migration helper.
You should move to the Hibernate Search 6 metamodel APIs, as explained in <a href="#metamodel">Metamodel: <code>SearchFactory.getIndexedTypeDescriptor</code>, <code>SearchFactory.getIndexedTypes</code></a>.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="configuration"><a class="anchor" href="#configuration"></a>Configuration changes</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="configuration-basics"><a class="anchor" href="#configuration-basics"></a>Basics</h3>
<div class="paragraph">
<p>Most configuration properties changed in Hibernate Search 6.
In most cases it&#8217;s only a matter of changing the prefix of a configuration property
(due to the different structure of Hibernate Search 6),
but in a few cases the relevant feature changed so much that a new approach was necessary for configuration.</p>
</div>
<div class="paragraph">
<p>For a quick introduction to the basics of configuration in Hibernate Search 6,
refer to the <a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#getting-started-configuration">getting started guide, section "configuration"</a>.</p>
</div>
<div class="paragraph">
<p>For more details,
see the <a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#configuration">main "configuration" section of the reference documentation</a>.</p>
</div>
<div class="paragraph">
<p>For a complete list of Hibernate Search 5 properties and their equivalent in Hibernate Search 6,
refer to the section below.</p>
</div>
</div>
<div class="sect2">
<h3 id="configuration-contants"><a class="anchor" href="#configuration-contants"></a><a id="_constants_for_property_keys"></a> Constants for property keys</h3>
<div class="paragraph">
<p>In Hibernate Search 5, constants for configuration property keys used to be provided through
<code>org.hibernate.search.cfg.Environment</code> and <code>org.hibernate.search.elasticsearch.cfg.ElasticsearchEnvironment</code>.</p>
</div>
<div class="paragraph">
<p>In Hibernate Search 6, constants are provided through classes whose name ends with <code>Settings</code>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>org.hibernate.search.engine.cfg.EngineSettings</code></p>
</li>
<li>
<p><code>org.hibernate.search.engine.cfg.BackendSettings</code></p>
</li>
<li>
<p><code>org.hibernate.search.engine.cfg.IndexSettings</code></p>
</li>
<li>
<p><code>org.hibernate.search.mapper.orm.cfg.HibernateOrmMapperSettings</code></p>
</li>
<li>
<p><code>org.hibernate.search.backend.lucene.cfg.LuceneBackendSettings</code></p>
</li>
<li>
<p><code>org.hibernate.search.backend.lucene.cfg.LuceneIndexSettings</code></p>
</li>
<li>
<p><code>org.hibernate.search.backend.elasticsearch.cfg.ElasticsearchBackendSettings</code></p>
</li>
<li>
<p><code>org.hibernate.search.backend.elasticsearch.cfg.ElasticsearchIndexSettings</code></p>
</li>
<li>
<p><code>org.hibernate.search.backend.elasticsearch.aws.cfg.ElasticsearchAwsBackendSettings</code></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="configuration-property-reference"><a class="anchor" href="#configuration-property-reference"></a><a id="_configuration_property_reference"></a> Configuration property reference</h3>
<div class="paragraph">
<p>Below is a list of Hibernate Search 5 properties in alphabetical order,
along with their equivalent in Hibernate Search 6.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Index defaults are no longer specified using the prefix <code>hibernate.search.default.</code>,
and <code>hibernate.search.indexes.default.</code> will not work either.</p>
</div>
<div class="paragraph">
<p>To specify configuration to be applied by default to all indexes,
just set the configuration at the backend level using the prefix <code>hibernate.search.backend.</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>hibernate.search.analyzer</code></dt>
<dd>
<p>No direct equivalent in Hibernate Search 6.</p>
<div class="paragraph">
<p>To override the default analyzer, define a custom analyzer named <code>default</code>.
See <a href="#analysis-definition-provider">Analysis definition provider</a>.</p>
</div>
</dd>
<dt class="hdlist1"><code>hibernate.search.autoregister_listeners</code></dt>
<dd>
<p>Hibernate Search 6 equivalent: <code>hibernate.search.enabled</code>.</p>
</dd>
<dt class="hdlist1"><code>hibernate.search.batch_size</code></dt>
<dd>
<p>No direct equivalent in Hibernate Search 6.</p>
<div class="paragraph">
<p>This property was not documented in Hibernate Search 5.
For the specific use case of batch processes,
know that upon Hibernate ORM session flushes,
Hibernate Search 6 will automatically turn entities to documents
and hold documents in memory until the transaction commit.</p>
</div>
<div class="paragraph">
<p>See also <a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#mapper-orm-indexing-manual">this section of the documentation</a>.</p>
</div>
</dd>
<dt class="hdlist1"><code>hibernate.search.default.elasticsearch.aws.*</code></dt>
<dd>
<p>The syntax for configuring AWS authentication changed slightly in Hibernate Search 6.</p>
<div class="paragraph">
<p>In short, the following configuration in Hibernate Search 5:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>hibernate.search.default.elasticsearch.aws.signing.enabled = true
hibernate.search.default.elasticsearch.aws.region = us-east-1
hibernate.search.default.elasticsearch.aws.access_key = AKIDEXAMPLE
hibernate.search.default.elasticsearch.aws.secret_key = wJalrXUtnFEMI/K7MDENG+bPxRfiCYEXAMPLEKEY</code></pre>
</div>
</div>
<div class="paragraph">
<p>Will look like this in Hibernate Search 6:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>hibernate.search.backend.aws.signing.enabled = true
hibernate.search.backend.aws.region = us-east-1
hibernate.search.backend.aws.credentials.type = static
hibernate.search.backend.aws.credentials.access_key_id = AKIDEXAMPLE
hibernate.search.backend.aws.credentials.secret_access_key = wJalrXUtnFEMI/K7MDENG+bPxRfiCYEXAMPLEKEY</code></pre>
</div>
</div>
<div class="paragraph">
<p>Other types of credentials are available in Hibernate Search 6,
see <a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#backend-elasticsearch-configuration-aws">this section of the documentation</a></p>
</div>
</dd>
<dt class="hdlist1"><code>hibernate.search.default.elasticsearch.connection_timeout</code></dt>
<dd>
<p>Hibernate Search 6 equivalent: <code>hibernate.search.backend.connection_timeout</code>.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Defaults to 1000 (1 second) in Hibernate Search 6 instead of 3 seconds in Hibernate Search 5.
More information <a href="https://in.relation.to/2020/09/07/hibernate-search-6-0-0-Beta10/#improved-timeouts">here</a>.
</td>
</tr>
</table>
</div>
</dd>
<dt class="hdlist1"><code>hibernate.search.default.elasticsearch.discovery.default_scheme</code></dt>
<dd>
<p>Hibernate Search 6 equivalent: <code>hibernate.search.backend.protocol</code>.</p>
</dd>
<dt class="hdlist1"><code>hibernate.search.default.elasticsearch.discovery.enabled</code></dt>
<dd>
<p>Hibernate Search 6 equivalent: <code>hibernate.search.backend.discovery.enabled</code>.</p>
</dd>
<dt class="hdlist1"><code>hibernate.search.default.elasticsearch.discovery.refresh_interval</code></dt>
<dd>
<p>Hibernate Search 6 equivalent: <code>hibernate.search.backend.discovery.refresh_interval</code>.</p>
</dd>
<dt class="hdlist1"><code>hibernate.search.default.elasticsearch.dynamic_mapping</code>, <code>hibernate.search.&lt;index-name&gt;.elasticsearch.dynamic_mapping</code></dt>
<dd>
<p>Hibernate Search 6 equivalent (global defaults): <code>hibernate.search.backend.dynamic_mapping</code>.</p>
<div class="paragraph">
<p>Hibernate Search 6 equivalent (per-index): <code>hibernate.search.backend.indexes.&lt;index-name&gt;.dynamic_mapping</code>.</p>
</div>
</dd>
<dt class="hdlist1"><code>hibernate.search.default.elasticsearch.host</code></dt>
<dd>
<p>Hibernate Search 6 equivalent: <code>hibernate.search.backend.uris</code>.</p>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
In Hibernate Search 6, the property <code>hibernate.search.backend.hosts</code> can also be used,
but the URI scheme (<code>http://</code> or <code>https://</code>) must <strong>not</strong> be included there;
either use <code>hibernate.search.backend.uris</code> and include the URI scheme directly in URIs,
or use <code>hibernate.search.backend.hosts</code> without the URI scheme and specify the protocol
through the separate property <code>hibernate.search.backend.protocol</code>.
See <a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#backend-elasticsearch-configuration-hosts">this section of the documentation</a> for more details.
</td>
</tr>
</table>
</div>
</dd>
<dt class="hdlist1"><code>hibernate.search.default.elasticsearch.index_management_wait_timeout</code>, <code>hibernate.search.&lt;index-name&gt;.elasticsearch.index_management_wait_timeout</code></dt>
<dd>
<p>Hibernate Search 6 equivalent (global defaults): <code>hibernate.search.backend.schema_management.minimal_required_status_wait_timeout</code>.</p>
<div class="paragraph">
<p>Hibernate Search 6 equivalent (per-index): <code>hibernate.search.backend.indexes.&lt;index-name&gt;.schema_management.minimal_required_status_wait_timeout</code>.</p>
</div>
</dd>
<dt class="hdlist1"><code>hibernate.search.default.elasticsearch.index_schema_management_strategy</code>, <code>hibernate.search.&lt;index-name&gt;.elasticsearch.index_schema_management_strategy</code></dt>
<dd>
<p>Hibernate Search 6 equivalent (global defaults): <code>hibernate.search.schema_management.strategy</code>.</p>
<div class="paragraph">
<p>Hibernate Search 6 equivalent (per-index): none.</p>
</div>
<div class="paragraph">
<p>Defaults to <code>create-or-validate</code> in Hibernate Search 6.
See <a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#mapper-orm-schema-management-strategy">schema management</a>.</p>
</div>
<div class="paragraph">
<p>There is no direct equivalent for the per-index variant in Hibernate Search 6:
automatic schema management is configured globally for all indexes, not on a per-index basis.
However, you can achieve more control by setting <code>hibernate.search.schema_management.strategy</code> to <code>none</code>
and <a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#mapper-orm-schema-management-manager">managing the schema manually after startup</a>.</p>
</div>
</dd>
<dt class="hdlist1"><code>hibernate.search.default.elasticsearch.max_total_connection_per_route</code></dt>
<dd>
<p>Hibernate Search 6 equivalent: <code>hibernate.search.backend.max_connections_per_route</code>.</p>
</dd>
<dt class="hdlist1"><code>hibernate.search.default.elasticsearch.max_total_connection</code></dt>
<dd>
<p>Hibernate Search 6 equivalent: <code>hibernate.search.backend.max_connections</code>.</p>
</dd>
<dt class="hdlist1"><code>hibernate.search.default.elasticsearch.password</code></dt>
<dd>
<p>Hibernate Search 6 equivalent: <code>hibernate.search.backend.password</code>.</p>
</dd>
<dt class="hdlist1"><code>hibernate.search.default.elasticsearch.path_prefix</code></dt>
<dd>
<p>Hibernate Search 6 equivalent: <code>hibernate.search.backend.path_prefix</code>.</p>
</dd>
<dt class="hdlist1"><code>hibernate.search.default.elasticsearch.read_timeout</code></dt>
<dd>
<p>Hibernate Search 6 equivalent: <code>hibernate.search.backend.read_timeout</code>.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Defaults to 30000 (30 seconds) in Hibernate Search 6 instead of 60 seconds in Hibernate Search 5.
More information <a href="https://in.relation.to/2020/09/07/hibernate-search-6-0-0-Beta10/#improved-timeouts">here</a>.
</td>
</tr>
</table>
</div>
</dd>
<dt class="hdlist1"><code>hibernate.search.default.elasticsearch.refresh_after_write</code>, <code>hibernate.search.&lt;index-name&gt;.elasticsearch.refresh_after_write</code></dt>
<dd>
<p>Hibernate Search 6 equivalent (global defaults): <code>hibernate.search.automatic_indexing.synchronization.strategy</code>.</p>
<div class="paragraph">
<p>Hibernate Search 6 equivalent (per-index): none.</p>
</div>
<div class="paragraph">
<p>Setting <code>hibernate.search.automatic_indexing.synchronization.strategy</code> to <code>read-sync</code> or <code>sync</code> will produce results
similar to setting <code>hibernate.search.default.elasticsearch.refresh_after_write</code> to <code>true</code>.
See <a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#mapper-orm-indexing-automatic-synchronization">automatic indexing synchronization</a>
for more information.</p>
</div>
<div class="paragraph">
<p>There is no equivalent for the per-index variant in Hibernate Search 6:
the synchronization strategy can only be set globally, not on a per-index basis.</p>
</div>
</dd>
<dt class="hdlist1"><code>hibernate.search.default.elasticsearch.request_timeout</code></dt>
<dd>
<p>Hibernate Search 6 equivalent: <code>hibernate.search.backend.request_timeout</code>.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Defaults to no timeout in Hibernate Search 6.
More information <a href="https://in.relation.to/2020/09/07/hibernate-search-6-0-0-Beta10/#improved-timeouts">here</a>.
</td>
</tr>
</table>
</div>
</dd>
<dt class="hdlist1"><code>hibernate.search.default.elasticsearch.required_index_status</code>, <code>hibernate.search.&lt;index-name&gt;.elasticsearch.required_index_status</code></dt>
<dd>
<p>Hibernate Search 6 equivalent (global defaults): <code>hibernate.search.backend.schema_management.minimal_required_status</code>.</p>
<div class="paragraph">
<p>Hibernate Search 6 equivalent (per-index): <code>hibernate.search.backend.indexes.&lt;index-name&gt;.schema_management.minimal_required_status</code>.</p>
</div>
</dd>
<dt class="hdlist1"><code>hibernate.search.default.elasticsearch.username</code></dt>
<dd>
<p>Hibernate Search 6 equivalent: <code>hibernate.search.backend.username</code>.</p>
</dd>
<dt class="hdlist1"><code>hibernate.search.default.exclusive_index_use</code>, <code>hibernate.search.&lt;index-name&gt;.exclusive_index_use</code></dt>
<dd>
<p>No equivalent in Hibernate Search 6.</p>
</dd>
<dt class="hdlist1"><code>hibernate.search.default.directory_provider</code>, <code>hibernate.search.&lt;index-name&gt;.directory_provider</code></dt>
<dd>
<p>Hibernate Search 6 equivalent (global defaults): <code>hibernate.search.backend.directory.type</code>.</p>
<div class="paragraph">
<p>Hibernate Search 6 equivalent (per-index): <code>hibernate.search.backend.indexes.&lt;index-name&gt;.directory.type</code>.</p>
</div>
<div class="paragraph">
<p>Values for this property may have changed:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>filesystem</code> &#8658; <code>local-filesystem</code></p>
</li>
<li>
<p><code>local-heap</code> &#8658; <code>local-heap</code></p>
</li>
<li>
<p><code>ram</code> &#8658; <code>local-heap</code></p>
</li>
<li>
<p><code>filesystem-master</code>, <code>filesystem-slave</code>, <code>infinispan</code> &#8658; <a href="#search-5-backends">no longer supported</a></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><code>hibernate.search.default.indexBase</code>, <code>hibernate.search.&lt;index-name&gt;.indexBase</code></dt>
<dd>
<p>Hibernate Search 6 equivalent (global defaults): <code>hibernate.search.backend.directory.root</code>.</p>
<div class="paragraph">
<p>Hibernate Search 6 equivalent (per-index): <code>hibernate.search.backend.indexes.&lt;index-name&gt;.directory.root</code>.</p>
</div>
</dd>
<dt class="hdlist1"><code>hibernate.search.default.indexName</code>, <code>hibernate.search.&lt;index-name&gt;.indexName</code></dt>
<dd>
<p>No equivalent in Hibernate Search 6.</p>
<div class="paragraph">
<p>The name of an index can still be customized in the mapping, using <code>@Indexed(name = &#8230;&#8203;)</code>,
or with the <a href="#mapping-programmatic">programmatic</a> equivalent.</p>
</div>
</dd>
<dt class="hdlist1"><code>hibernate.search.default.index_flush_interval</code>, <code>hibernate.search.&lt;index-name&gt;.index_flush_interval</code></dt>
<dd>
<p>Hibernate Search 6 equivalent (global defaults): <code>hibernate.search.backend.io.commit_interval</code>.</p>
<div class="paragraph">
<p>Hibernate Search 6 equivalent (per-index): <code>hibernate.search.backend.indexes.&lt;index name&gt;.io.commit_interval</code>.</p>
</div>
</dd>
<dt class="hdlist1"><code>hibernate.search.default.index_metadata_complete</code>, <code>hibernate.search.&lt;index-name&gt;.index_metadata_complete</code></dt>
<dd>
<p>No equivalent in Hibernate Search 6.</p>
<div class="paragraph">
<p>This property was not documented in Hibernate Search 5.</p>
</div>
</dd>
<dt class="hdlist1"><code>hibernate.search.default.indexmanager</code>, <code>hibernate.search.&lt;index-name&gt;.indexmanager</code></dt>
<dd>
<p>Hibernate Search 6 equivalent (global defaults): <code>hibernate.search.backend.type</code>.</p>
<div class="paragraph">
<p>Hibernate Search 6 equivalent (per-index): none.</p>
</div>
<div class="paragraph">
<p>Setting the backend type (<code>elasticsearch</code> or <code>lucene</code>) should no longer be necessary:
it will be picked automatically if there is only one backend type available in the classpath.</p>
</div>
<div class="paragraph">
<p>If you have multiple backend types available in the classpath for some reason,
but only want to use one, set <code>hibernate.search.backend.type</code> to either <code>lucene</code> or <code>elasticsearch</code>.</p>
</div>
<div class="paragraph">
<p>If you need both a Lucene backend and an Elasticsearch backend, proceed as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Annotate entities that must be indexed in the Elasticsearch backend with <code>@Indexed(backend = "elasticsearch")</code>.</p>
</li>
<li>
<p>Annotate entities that must be indexed in the Lucene backend with <code>@Indexed(backend = "lucene")</code>.</p>
</li>
<li>
<p>Configure two separate backends in your configuration properties:</p>
<div class="ulist">
<ul>
<li>
<p>prefix properties of the Elasticsearch backend with
<code>hibernate.search.backends.elasticsearch.</code> instead of <code>hibernate.search.backend.</code>.</p>
</li>
<li>
<p>prefix properties of the Lucene backend with
<code>hibernate.search.backends.lucene.</code> instead of <code>hibernate.search.backend.</code>.</p>
</li>
<li>
<p>same goes for indexes,
e.g. <code>hibernate.search.backends.elasticsearch.indexes.&lt;index-name&gt;.someProperty</code>
for indexes of the Elasticsearch backend
or <code>hibernate.search.backends.lucene.indexes.&lt;index-name&gt;.someProperty</code>
for indexes of the Lucene backend.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><code>hibernate.search.default.indexwriter.<strong></code>, <code>hibernate.search.&lt;index-name&gt;.indexwriter.</strong></code></dt>
<dd>
<p>Hibernate Search 6 equivalent (global defaults): <code>hibernate.search.backend.io.writer.<strong></code> or <code>hibernate.search.backend.io.merge.</strong></code>.</p>
<div class="paragraph">
<p>Hibernate Search 6 equivalent (per-index): <code>hibernate.search.backend.indexes.&lt;index-name&gt;.io.writer.<strong></code> or <code>hibernate.search.backend.indexes.&lt;index-name&gt;.io.merge.</strong></code>.</p>
</div>
<div class="paragraph">
<p>The writer settings and merge settings are now split.
See <a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#backend-lucene-io-writer">here for available writer settings</a>
and <a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#backend-lucene-io-merge">here for available merge settings</a>.</p>
</div>
</dd>
<dt class="hdlist1"><code>hibernate.search.default.locking_strategy</code>, <code>hibernate.search.&lt;index-name&gt;.locking_strategy</code></dt>
<dd>
<p>Hibernate Search 6 equivalent (global defaults): <code>hibernate.search.backend.directory.locking.strategy</code>.</p>
<div class="paragraph">
<p>Hibernate Search 6 equivalent (per-index): <code>hibernate.search.backend.indexes.&lt;index-name&gt;.directory.locking.strategy</code>.</p>
</div>
<div class="paragraph">
<p>See <a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#backend-lucene-configuration-directory-locking-strategy">here for available locking strategies</a>.</p>
</div>
</dd>
<dt class="hdlist1"><code>hibernate.search.default.max_queue_length</code>, <code>hibernate.search.&lt;index-name&gt;.max_queue_length</code></dt>
<dd>
<p>Hibernate Search 6 equivalent (global defaults): <code>hibernate.search.backend.indexing.queue_size</code>.</p>
<div class="paragraph">
<p>Hibernate Search 6 equivalent (per-index): <code>hibernate.search.backend.indexes.&lt;index-name&gt;.indexing.queue_size</code>.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
In Hibernate Search 6, there are multiple queues per index, enabling parallel indexing of documents.
See <a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#backend-lucene-indexing-queues">here for Lucene</a>
or <a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#backend-elasticsearch-indexing-queues">here for Elasticsearch</a>.
</td>
</tr>
</table>
</div>
</dd>
<dt class="hdlist1"><code>hibernate.search.default_null_token</code></dt>
<dd>
<p>No equivalent in Hibernate Search 6.</p>
<div class="paragraph">
<p>In most cases, you <a href="#field-indexnullas">won&#8217;t need to use <code>indexNullAs</code> anymore</a>.
Where <code>indexNullAs</code> is still needed, define the token explicitly for each index field.</p>
</div>
</dd>
<dt class="hdlist1"><code>hibernate.search.default.reader.<strong></code>, <code>hibernate.search.&lt;index-name&gt;.reader.</strong></code></dt>
<dd>
<p>No direct equivalent in Hibernate Search 6.</p>
<div class="paragraph">
<p>To enable async reader refresh, set <code>hibernate.search.backend.io.refresh_interval</code> or
<code>hibernate.search.backend.indexes.&lt;index-name&gt;.io.refresh_interval</code>
to a strictly positive value (in milliseconds).
See <a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#backend-lucene-io-refresh">here for more information</a>.</p>
</div>
<div class="paragraph">
<p>Custom reader strategies are no longer supported.</p>
</div>
</dd>
<dt class="hdlist1"><code>hibernate.search.default.retry_marker_lookup</code>, <code>hibernate.search.&lt;index-name&gt;.retry_marker_lookup</code></dt>
<dd>
<p>No equivalent in Hibernate Search 6: <a href="#search-5-backends">the <code>filesystem-slave</code> directory provider is no longer supported</a>.</p>
</dd>
<dt class="hdlist1"><code>hibernate.search.default.sharding_strategy</code>, <code>hibernate.search.&lt;index-name&gt;.sharding_strategy</code></dt>
<dd>
<p>No direct equivalent in Hibernate Search 6: sharding is configured differently.
See <a href="#sharding">Sharding: <code>IndexShardingStrategy</code>/<code>ShardIdentifierProvider</code>/<code>ShardIdentifierProviderTemplate</code></a>.</p>
</dd>
<dt class="hdlist1"><code>hibernate.search.default.sharding_strategy.nbr_of_shards</code>, <code>hibernate.search.&lt;index-name&gt;.sharding_strategy.nbr_of_shards</code></dt>
<dd>
<p>No direct equivalent in Hibernate Search 6: sharding is configured differently.
See <a href="#sharding">Sharding: <code>IndexShardingStrategy</code>/<code>ShardIdentifierProvider</code>/<code>ShardIdentifierProviderTemplate</code></a>.</p>
</dd>
<dt class="hdlist1"><code>hibernate.search.default.similarity</code>, <code>hibernate.search.&lt;index-name&gt;.similarity</code></dt>
<dd>
<p>No direct equivalent in Hibernate Search 6: the similarity is configured through the <a href="#analysis-definition-provider">analysis configurer</a>.</p>
</dd>
<dt class="hdlist1"><code>hibernate.search.default.worker.backend</code>, <code>hibernate.search.&lt;index-name&gt;.worker.backend</code></dt>
<dd>
<p>No equivalent in Hibernate Search 6: <a href="#search-5-backends">the JMS/JGroups backends are no longer supported</a>.</p>
</dd>
<dt class="hdlist1"><code>hibernate.search.default.worker.execution</code>, <code>hibernate.search.&lt;index-name&gt;.worker.execution</code></dt>
<dd>
<p>No direct equivalent in Hibernate Search 6.</p>
<div class="paragraph">
<p>Setting <code>hibernate.search.automatic_indexing.synchronization.strategy</code> to <code>async</code> or <code>sync</code> will produce results
similar to setting <code>hibernate.search.&lt;index-name&gt;.worker.execution</code> to the same value.
See <a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#mapper-orm-indexing-automatic-synchronization">automatic indexing synchronization</a>
for more information.</p>
</div>
</dd>
<dt class="hdlist1"><code>hibernate.search.default.worker.<strong></code>, <code>hibernate.search.&lt;index-name&gt;.worker.</strong></code></dt>
<dd>
<p>No equivalent in Hibernate Search 6: <a href="#search-5-backends">the JMS/JGroups backends are no longer supported</a>.</p>
</dd>
<dt class="hdlist1"><code>hibernate.search.elasticsearch.analysis_definition_provider</code></dt>
<dd>
<p>Hibernate Search 6 equivalent: <code>hibernate.search.backend.analysis.configurer</code>.</p>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
A different interface should be implemented: see <a href="#analysis-definition-provider">Analysis definition provider</a>.
</td>
</tr>
</table>
</div>
</dd>
<dt class="hdlist1"><code>hibernate.search.elasticsearch.log.json_pretty_printing</code></dt>
<dd>
<p>Hibernate Search 6 equivalent: <code>hibernate.search.backend.log.json_pretty_printing</code>.</p>
</dd>
<dt class="hdlist1"><code>hibernate.search.elasticsearch.scroll_backtracking_window_size</code></dt>
<dd>
<p>No equivalent in Hibernate Search 6: <a href="#scrolling-forward-only">scrolling is forward-only</a>.</p>
</dd>
<dt class="hdlist1"><code>hibernate.search.elasticsearch.scroll_fetch_size</code></dt>
<dd>
<p>No direct equivalent in Hibernate Search 6.</p>
<div class="paragraph">
<p>When using Hibernate Search APIs, the "chunk size" is an argument to the
<a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#search-dsl-query-fetching-results-scrolling"><code>scroll</code> method</a>.
When using the <a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#search-dsl-query-object">Hibernate ORM or JPA adapters</a>,
the "chunk size" is set to the same value as the <a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#search-dsl-query-fetch-size">fetch size</a>.</p>
</div>
</dd>
<dt class="hdlist1"><code>hibernate.search.elasticsearch.scroll_timeout</code></dt>
<dd>
<p>Hibernate Search 6 equivalent: <code>hibernate.search.backend.scroll_timeout</code>.</p>
</dd>
<dt class="hdlist1"><code>hibernate.search.enable_dirty_check</code></dt>
<dd>
<p>Hibernate Search 6 equivalent: <code>hibernate.search.automatic_indexing.enable_dirty_check</code>.</p>
</dd>
<dt class="hdlist1"><code>hibernate.search.error_handler</code></dt>
<dd>
<p>Hibernate Search 6 equivalent: <code>hibernate.search.background_failure_handler</code>.</p>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
A different interface should be implemented: see <a href="#error-handler">Error handler</a>.
</td>
</tr>
</table>
</div>
</dd>
<dt class="hdlist1"><code>hibernate.search.filter.cache_docidresults.size</code></dt>
<dd>
<p>No equivalent in Hibernate Search 6.0. See <a href="#full-text-filter">Full-text filter</a>.</p>
<div class="paragraph">
<p>If you need caching for some of your Lucene queries,
consider upgrading directly to Hibernate Search 6.1,
which provides configurable <a href="https://docs.jboss.org/hibernate/search/6.1/reference/en-US/html_single/#backend-lucene-search-caching">Low-level hit caching</a>.</p>
</div>
</dd>
<dt class="hdlist1"><code>hibernate.search.filter.cache_strategy</code></dt>
<dd>
<p>No equivalent in Hibernate Search 6.0. See <a href="#full-text-filter">Full-text filter</a>.</p>
<div class="paragraph">
<p>If you need caching for some of your Lucene queries,
consider upgrading directly to Hibernate Search 6.1,
which provides configurable <a href="https://docs.jboss.org/hibernate/search/6.1/reference/en-US/html_single/#backend-lucene-search-caching">Low-level hit caching</a>.</p>
</div>
</dd>
<dt class="hdlist1"><code>hibernate.search.generate_statistics</code></dt>
<dd>
<p>No equivalent in Hibernate Search 6. See <a href="#searchfactory-getstatistics">Statistics: <code>SearchFactory.getStatistics()</code></a>.</p>
</dd>
<dt class="hdlist1"><code>hibernate.search.index_uninverting_allowed</code></dt>
<dd>
<p>Index uninverting was deprecated in Hibernate Search 5 due to poor performance and is no longer allowed.
All index fields that you want to sort on must be <a href="#sortablefield">marked as sortable</a>.</p>
</dd>
<dt class="hdlist1"><code>hibernate.search.indexing_strategy</code></dt>
<dd>
<p>Hibernate Search 6 equivalent: <code>hibernate.search.automatic_indexing.strategy</code>.</p>
<div class="paragraph">
<p>Set to <code>none</code> to get the equivalent of <code>hibernate.search.indexing_strategy = manual</code> in Hibernate Search 5.</p>
</div>
</dd>
<dt class="hdlist1"><code>hibernate.search.jmx_bean_suffix</code></dt>
<dd>
<p>No equivalent in Hibernate Search 6. See <a href="#jmx">JMX</a>.</p>
</dd>
<dt class="hdlist1"><code>hibernate.search.jmx_enabled</code></dt>
<dd>
<p>No equivalent in Hibernate Search 6. See <a href="#jmx">JMX</a>.</p>
</dd>
<dt class="hdlist1"><code>hibernate.search.lucene.analysis_definition_provider</code></dt>
<dd>
<p>Hibernate Search 6 equivalent: <code>hibernate.search.backend.analysis.configurer</code>.</p>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
A different interface should be implemented: see <a href="#analysis-definition-provider">Analysis definition provider</a>.
</td>
</tr>
</table>
</div>
</dd>
<dt class="hdlist1"><code>hibernate.search.lucene_version</code></dt>
<dd>
<p>Hibernate Search 6 equivalent: <code>hibernate.search.backend.lucene_version</code>.</p>
</dd>
<dt class="hdlist1"><code>hibernate.search.model_mapping</code></dt>
<dd>
<p>Hibernate Search 6 equivalent: <code>hibernate.search.mapping.configurer</code>.</p>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
A different interface should be implemented: see <a href="#mapping-programmatic">Programmatic mapping</a>.
</td>
</tr>
</table>
</div>
</dd>
<dt class="hdlist1"><code>hibernate.search.query.database_retrieval_method</code></dt>
<dd>
<p>No equivalent in Hibernate Search 6: entities are always loaded with a query.</p>
</dd>
<dt class="hdlist1"><code>hibernate.search.query.object_lookup_method</code></dt>
<dd>
<p>Hibernate Search 6 equivalent: <code>hibernate.search.query.loading.cache_lookup.strategy</code>.</p>
<div class="paragraph">
<p>See <a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#search-dsl-query-cache-lookup-strategy">this section of the documentation</a>.</p>
</div>
</dd>
<dt class="hdlist1"><code>hibernate.search.similarity</code></dt>
<dd>
<p>No direct equivalent in Hibernate Search 6: the similarity is configured through the <a href="#analysis-definition-provider">analysis configurer</a>.</p>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
The default similarity when this property is not set changed; see <a href="#default-similarity">The default similarity for Lucene is now BM25</a>.
</td>
</tr>
</table>
</div>
</dd>
<dt class="hdlist1"><code>hibernate.search.worker.*</code></dt>
<dd>
<p>No equivalent to the concept of "worker" in Hibernate Search 6:</p>
<div class="ulist">
<ul>
<li>
<p>automatic indexing is <a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#mapper-orm-indexing-automatic-concepts">always performed on transaction commit or,
when there is no transaction, on session flush</a>.</p>
</li>
<li>
<p><a href="#search-5-backends">transactional backends, for example the JMS backend, are no longer supported</a>.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="jmx"><a class="anchor" href="#jmx"></a>JMX</h3>
<div class="paragraph">
<p>Hibernate Search 6 does not provide JMX support at the moment.</p>
</div>
<div class="paragraph">
<p>The current plans are to implement support for tracing in a future release
(<a href="https://hibernate.atlassian.net/browse/HSEARCH-4057">HSEARCH-4057</a>).
This would provide a more powerful solution to users looking for insight into the behavior of their application.</p>
</div>
<div class="paragraph">
<p>If you need this feature urgently, we&#8217;ll gladly help anyone interested in contributing a patch:
feel free to <a href="https://hibernate.org/community">contact us</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="search-5-backends"><a class="anchor" href="#search-5-backends"></a>Backends</h3>
<div class="paragraph">
<p>Hibernate Search 6 does not provide support for the JGroups or JMS backends at the moment,
nor does it support the related <code>filesystem-master</code>/<code>filesystem-slave</code>/<code>infinispan</code> directory providers.</p>
</div>
<div class="paragraph">
<p>If you need to scale your application to multiple nodes,
consider switching to the <a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#architecture-examples-elasticsearch">Elasticsearch backend</a>.</p>
</div>
<div class="paragraph">
<p>To ensure robustness of distributed indexing,
consider upgrading directly to Hibernate Search 6.1,
which provides a feature called <a href="https://docs.jboss.org/hibernate/search/6.1/reference/en-US/html_single/#coordination">coordination</a>,
and in particular the <a href="https://docs.jboss.org/hibernate/search/6.1/reference/en-US/html_single/#coordination-database-polling"><code>database-polling</code> coordination strategy</a>.
When used together with the Elasticsearch backend,
the <code>database-polling</code> coordination strategy enables distributed applications,
as the JMS/JGroups backends in Hibernate Search 5 do,
though through a different implementation relying on the database instead of JMS/JGroups queues.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="api"><a class="anchor" href="#api"></a>API changes</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A lot of APIs changed. We recommend having a look at
<a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#getting-started">the getting started guide</a> before migrating.</p>
</div>
<div class="sect2">
<h3 id="mapping-annotation"><a class="anchor" href="#mapping-annotation"></a>Annotation mapping</h3>
<div class="sect3">
<h4 id="analyzer"><a class="anchor" href="#analyzer"></a><code>@Analyzer</code></h4>
<div class="paragraph">
<p>In Hibernate Search 5, it was possible to apply an <code>@Analyzer</code> annotation to a class or property,
so that the corresponding analyzer would be used by default for any index field declared in this scope.</p>
</div>
<div class="paragraph">
<p>There is no equivalent to that feature in Hibernate Search 6:
all fields must specify their analyzer explicitly using <code>@FullTextField(analyzer = "myAnalyzer")</code>,
or rely on the (global) default analyzer.</p>
</div>
<div class="paragraph">
<p>Also, still in Hibernate Search 5, <code>@Analyzer</code> could point directly to a class extending <code>org.apache.lucene.analysis.Analyzer</code>,
for example with <code>@Analyzer(impl = StandardAnalyzer.class)</code>.</p>
</div>
<div class="paragraph">
<p>This is no longer possible: analyzers are now always referenced by their name.
However, you can assign a name to a given analyzer instance using
the <a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#backend-lucene-analysis-analyzers">Lucene analysis configurer</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="analyzerdef"><a class="anchor" href="#analyzerdef"></a><code>@AnalyzerDef</code>, <code>@AnalyzerDefs</code></h4>
<div class="paragraph">
<p>Annotation-based analyzer definitions are no longer supported.</p>
</div>
<div class="paragraph">
<p>Instead, implement an analysis configurer:
see <a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#backend-lucene-analysis-analyzers">here for Lucene</a>,
or <a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#backend-elasticsearch-analysis-analyzers">here for Elasticsearch</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="analyzerdiscriminator"><a class="anchor" href="#analyzerdiscriminator"></a><code>@AnalyzerDiscriminator</code></h4>
<div class="paragraph">
<p><code>@AnalyzerDiscriminator</code> has no direct equivalent in Hibernate Search 6:
the analyzer assigned to each field is static and cannot change at runtime,
because that results in unreliable matches and in scoring issues.</p>
</div>
<div class="paragraph">
<p>Instead, Hibernate Search 6 allows declaring multiple index fields for a single property,
and putting the content of that property in a different field depending on a discriminator.
Then, when searching, you can target all fields at once.</p>
</div>
<div class="paragraph">
<p>See <a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#mapper-orm-alternatives">Mapping multiple alternatives</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="boost"><a class="anchor" href="#boost"></a><code>@Boost</code></h4>
<div class="paragraph">
<p>Index-time boosting was deprecated in Hibernate Search 5.
It is no longer available in Hibernate Search 6.</p>
</div>
<div class="paragraph">
<p>Instead, rely on <a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#search-dsl-predicate-common-boost">query-time boosting</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="cachefromindex"><a class="anchor" href="#cachefromindex"></a><code>@CacheFromIndex</code></h4>
<div class="paragraph">
<p>This annotation was deprecated and non-functional in Hibernate Search 5.
It is no longer available in Hibernate Search 6.</p>
</div>
</div>
<div class="sect3">
<h4 id="calendarbridge"><a class="anchor" href="#calendarbridge"></a><code>@CalendarBridge</code></h4>
<div class="paragraph">
<p><code>@CalendarBridge</code> is not necessary to index <code>Calendar</code> values:
you can simply apply <code>@GenericField</code> to a property of type <code>Calendar</code>,
and an appropriate default bridge will be used.</p>
</div>
<div class="paragraph">
<p>The main purpose of <code>@CalendarBridge</code> in Hibernate Search 5 was to provide the ability
to "truncate" calendars upon indexing, e.g. zeroing out all data more precise than the day
with <code>@CalendarBridge(resolution = Resolution.DAY)</code>.</p>
</div>
<div class="paragraph">
<p>For such use case, the recommended approach in Hibernate Search 6 is to index values with full resolution
(not using <code>@CalendarBridge</code>) and to control resolution when searching,
with a <a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#search-dsl-predicate-range"><code>range</code> predicate</a>.
Note that you can pass <code>ZonedDateTime</code> values to the predicate, which are much easier to truncate manually.
For example, to match only documents whose calendar is within a given day:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="predefined-type">Calendar</span> toMatch = <span class="comment">/* ... */</span>;
ZonedDateTime toMatchZonedDateTime = ( (<span class="predefined-type">GregorianCalendar</span>) toMatch ).toZonedDateTime();
ZonedDateTime dayStart = toMatchZonedDateTime.truncatedTo( ChronoUnit.DAYS );
ZonedDateTime nextDayStart = dayStart.plus( <span class="integer">1</span>, ChronoUnit.DAYS );

<span class="predefined-type">List</span>&lt;MyEntity&gt; hits = searchSession.search( MyEntity.class )
        .where( f -&gt; f.range().field( <span class="string"><span class="delimiter">&quot;</span><span class="content">calendar</span><span class="delimiter">&quot;</span></span> )
                .range( Range.canonical( dayStart, nextDayStart ), ValueConvert.NO )
        .fetchHits( <span class="integer">20</span> );</code></pre>
</div>
</div>
<div class="paragraph">
<p>If that approach doesn&#8217;t work for you, <a href="https://hibernate.org/community">let us know</a> and we&#8217;ll try to come up with a solution together.</p>
</div>
</div>
<div class="sect3">
<h4 id="charfilterdef"><a class="anchor" href="#charfilterdef"></a><code>@CharFilterDef</code></h4>
<div class="paragraph">
<p>See <a href="#analyzerdef"><code>@AnalyzerDef</code>, <code>@AnalyzerDefs</code></a> or <a href="#normalizerdef"><code>@NormalizerDef</code>, <code>@NormalizerDefs</code></a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="classbridge"><a class="anchor" href="#classbridge"></a><code>@ClassBridge</code>, <code>@ClassBridges</code></h4>
<div class="paragraph">
<p>See <a href="#bridges">Bridges</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="containedin"><a class="anchor" href="#containedin"></a><code>@ContainedIn</code></h4>
<div class="paragraph">
<p><code>@ContainedIn</code> is no longer necessary in Hibernate Search 6.</p>
</div>
<div class="paragraph">
<p>Hibernate Search 6 infers indexing dependencies from the mapping,
and raises errors at bootstrap when the equivalent of <code>@ContainedIn</code> cannot be applied automatically
(for example an <code>@IndexedEmbedded</code> association with no inverse side).</p>
</div>
<div class="paragraph">
<p>Thus, the recommended approach when migrating is to simply remove all <code>@ContainedIn</code> annotations,
then deal with the bootstrap errors, if any.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Hibernate Search 6 is able to raise multiple mapping errors during a single startup,
so you don&#8217;t have to restart the application 20 times to address 20 different problems.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>See <a href="#automatic-indexing-across-associations-by-default">this section</a> for guidance on how to address these errors.</p>
</div>
</div>
<div class="sect3">
<h4 id="datebridge"><a class="anchor" href="#datebridge"></a><code>@DateBridge</code></h4>
<div class="paragraph">
<p><code>@DateBridge</code> is not necessary to index <code>Date</code> values:
you can simply apply <code>@GenericField</code> to a property of type <code>java.util.Date</code>, <code>java.sql.Date</code>, <code>java.sql.Time</code> or <code>java.sql.Timestamp</code>,
and an appropriate default bridge will be used.</p>
</div>
<div class="paragraph">
<p>The main purpose of <code>@DateBridge</code> in Hibernate Search 5 was to provide the ability
to "truncate" dates upon indexing, e.g. zeroing out all data more precise than the day
with <code>@DateBridge(resolution = Resolution.DAY)</code>.</p>
</div>
<div class="paragraph">
<p>For such use case, the recommended approach in Hibernate Search 6 is to index values with full resolution
(not using <code>@DateBridge</code>) and to control resolution when searching,
with a <a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#search-dsl-predicate-range"><code>range</code> predicate</a>.
Note that you can pass <code>Instant</code> values to the predicate, which are much easier to truncate manually.
For example, to match only documents whose date is within a given day:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="predefined-type">Date</span> toMatch = <span class="comment">/* ... */</span>;
ZoneId userZoneId = <span class="comment">/* ... */</span>;
ZonedDateTime toMatchZonedDateTime = Instant.ofEpochMilli( toMatch.getTime() ).atZone( userZoneId );
ZonedDateTime dayStart = toMatchZonedDateTime.truncatedTo( ChronoUnit.DAYS );
ZonedDateTime nextDayStart = dayStart.plus( <span class="integer">1</span>, ChronoUnit.DAYS );

<span class="predefined-type">List</span>&lt;MyEntity&gt; hits = searchSession.search( MyEntity.class )
        .where( f -&gt; f.range().field( <span class="string"><span class="delimiter">&quot;</span><span class="content">date</span><span class="delimiter">&quot;</span></span> )
                .range( Range.canonical( dayStart.toInstant(), nextDayStart.toInstant() ),
                        ValueConvert.NO )
        .fetchHits( <span class="integer">20</span> );</code></pre>
</div>
</div>
<div class="paragraph">
<p>If that approach doesn&#8217;t work for you, <a href="https://hibernate.org/community">let us know</a> and we&#8217;ll try to come up with a solution together.</p>
</div>
</div>
<div class="sect3">
<h4 id="documentid"><a class="anchor" href="#documentid"></a><code>@DocumentId</code></h4>
<div class="paragraph">
<p><code>@DocumentId</code> is still available in Hibernate Search 6, but moved to a different package:
<code>org.hibernate.search.mapper.pojo.mapping.definition.annotation.DocumentId</code>.</p>
</div>
<div class="paragraph">
<p>However, it no longer exposes a <code>name</code> attribute,
because <a href="#document-id-is-not-a-field">the document ID is no longer an index field</a>,
and thus it does not need a name.</p>
</div>
</div>
<div class="sect3">
<h4 id="dynamicboost"><a class="anchor" href="#dynamicboost"></a><code>@DynamicBoost</code></h4>
<div class="paragraph">
<p>Index-time boosting was deprecated in Hibernate Search 5.
It is no longer available in Hibernate Search 6.</p>
</div>
<div class="paragraph">
<p>Instead, rely on <a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#search-dsl-predicate-common-boost">query-time boosting</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="facet"><a class="anchor" href="#facet"></a><code>@Facet</code>, <code>@Facets</code></h4>
<div class="sect4">
<h5 id="facet-basics"><a class="anchor" href="#facet-basics"></a>Basics</h5>
<div class="paragraph">
<p>Facets are now called aggregations, which are a generalization of the concept of faceting.</p>
</div>
<div class="paragraph">
<p>To make a field aggregable, just set the <code>@*Field.aggregable</code> attribute to <code>Aggregable.YES</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="annotation">@KeywordField</span>(aggregable = Aggregable.YES)
<span class="directive">private</span> <span class="predefined-type">String</span> myKeyword;
<span class="annotation">@GenericField</span>(aggregable = Aggregable.YES)
<span class="directive">private</span> <span class="predefined-type">Integer</span> myInteger;
<span class="annotation">@GenericField</span>(aggregable = Aggregable.YES)
<span class="directive">private</span> LocalDate myLocalDate;</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>An aggregable <code>@KeywordField</code> with a normalizer will return normalized values in aggregations,
whereas Hibernate Search 5 used to return raw (non-normalized) values.</p>
</div>
<div class="paragraph">
<p>See <a href="#faceting-strings-are-normalized">Faceting returns normalized strings</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p><code>aggregable</code> is not available on <code>@FullTextField</code>,
because aggregation on a tokenized field would aggregate tokens instead of field values,
which is rarely the intent.</p>
</div>
<div class="paragraph">
<p>If you need both an analyzer and aggregations on the same property, create two separate fields:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="annotation">@FullTextField</span>
<span class="annotation">@KeywordField</span>(name = <span class="string"><span class="delimiter">&quot;</span><span class="content">category_aggregation</span><span class="delimiter">&quot;</span></span>, aggregable = Aggregable.YES)
<span class="directive">private</span> <span class="predefined-type">String</span> category;</code></pre>
</div>
</div>
<div class="paragraph">
<p>For instructions on how to execute aggregations, see <a href="#searching-facet">Facets &#8658; Aggregations</a>.</p>
</div>
<div class="paragraph">
<p>This will lead to two separate fields being created in the index, for the same property.
Just make sure to use the correct field name when searching:
<code>category</code> when creating <a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#search-dsl-predicate-match">predicates</a>,
but <code>category_aggregation</code> when creating <a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#search-dsl-aggregation-terms">aggregations</a>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="facet-encoding"><a class="anchor" href="#facet-encoding"></a><a id="_facet_encoding"></a> <code>@Facet.encoding</code></h5>
<div class="paragraph">
<p>The facet encoding options no longer exists:
strings will be indexed as strings and numbers will be indexed as numbers.</p>
</div>
<div class="paragraph">
<p>For the few cases where encoding a number as a string is necessary,
you can define a separate field exclusively for aggregations,
and apply a <a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#mapper-orm-bridge-valuebridge">custom value bridge</a>
to convert the number to a string (and back).</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="field"><a class="anchor" href="#field"></a><code>@Field</code>, <code>@Fields</code></h4>
<div class="sect4">
<h5 id="field-basics"><a class="anchor" href="#field-basics"></a>Basics</h5>
<div class="paragraph">
<p>The <code>@Field</code> annotation was split into multiple annotations, specific to each field type:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>org.hibernate.search.mapper.pojo.mapping.definition.annotation.FullTextField</code></p>
</li>
<li>
<p><code>org.hibernate.search.mapper.pojo.mapping.definition.annotation.KeywordField</code></p>
</li>
<li>
<p><code>org.hibernate.search.mapper.pojo.mapping.definition.annotation.GenericField</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Here is a quick reference of how to convert a <code>@Field</code> annotation to Hibernate Search 6:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 40%;">
<col style="width: 40%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property type</th>
<th class="tableblock halign-left valign-top">Hibernate Search 5</th>
<th class="tableblock halign-left valign-top">Hibernate Search 6</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" rowspan="5"><div class="content"><div class="paragraph">
<p><code>String</code>, <code>Character</code>, <code>char</code>, enum</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="annotation">@Field</span></code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="annotation">@FullTextField</span></code></pre>
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="annotation">@Field</span>(analyzer = <span class="annotation">@Analyzer</span>(definition = <span class="string"><span class="delimiter">&quot;</span><span class="content">myAnalyzer</span><span class="delimiter">&quot;</span></span>))</code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top" rowspan="2"><div class="content"><div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="annotation">@FullTextField</span>(analyzer = <span class="string"><span class="delimiter">&quot;</span><span class="content">myAnalyzer</span><span class="delimiter">&quot;</span></span>)</code></pre>
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="annotation">@Field</span>
<span class="annotation">@Analyzer</span>(definition = <span class="string"><span class="delimiter">&quot;</span><span class="content">myAnalyzer</span><span class="delimiter">&quot;</span></span>)</code></pre>
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="annotation">@Field</span>(normalizer = <span class="annotation">@Normalizer</span>(definition = <span class="string"><span class="delimiter">&quot;</span><span class="content">myNormalizer</span><span class="delimiter">&quot;</span></span>))</code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="annotation">@KeywordField</span>(normalizer = <span class="string"><span class="delimiter">&quot;</span><span class="content">myNormalizer</span><span class="delimiter">&quot;</span></span>)</code></pre>
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="annotation">@Field</span>(analyze = analyze.NO)</code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="annotation">@KeywordField</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>or</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="annotation">@GenericField</span></code></pre>
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" rowspan="2"><div class="content"><div class="paragraph">
<p>Other</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="annotation">@Field</span>
<span class="annotation">@NumericField</span></code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="annotation">@GenericField</span></code></pre>
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="annotation">@Field</span></code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="annotation">@GenericField</span></code></pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="field-analyze"><a class="anchor" href="#field-analyze"></a><code>@Field.analyze</code></h5>
<div class="paragraph">
<p><code>@Field.analyze</code> has no direct equivalent in Hibernate Search 6.
Instead of enabling/disabling analysis explicitly,
<a href="#field-basics">pick the right <code>@*Field</code> annotation according to your needs</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="field-analyzer"><a class="anchor" href="#field-analyzer"></a><code>@Field.analyzer</code></h5>
<div class="paragraph">
<p>See <a href="#field-basics">Basics</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="field-boost"><a class="anchor" href="#field-boost"></a><code>@Field.boost</code></h5>
<div class="paragraph">
<p>Index-time boosting was deprecated in Hibernate Search 5.
It is no longer available in Hibernate Search 6.</p>
</div>
<div class="paragraph">
<p>Instead, rely on <a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#search-dsl-predicate-common-boost">query-time boosting</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="field-bridge"><a class="anchor" href="#field-bridge"></a><code>@Field.bridge</code></h5>
<div class="paragraph">
<p>See <a href="#bridges">Bridges</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="field-index"><a class="anchor" href="#field-index"></a><code>@Field.index</code></h5>
<div class="paragraph">
<p><code>@Field.index</code> is now <code>@*Field.searchable</code>:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Hibernate Search 5</th>
<th class="tableblock halign-left valign-top">Hibernate Search 6</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="annotation">@Field</span>(index = Index.YES)</code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="annotation">@GenericField</span>(searchable = Searchable.YES)</code></pre>
</div>
</div>
<div class="paragraph">
<p>or</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="annotation">@FullTextField</span>(searchable = Searchable.YES)</code></pre>
</div>
</div>
<div class="paragraph">
<p>or</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="annotation">@KeywordField</span>(searchable = Searchable.YES)</code></pre>
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="annotation">@Field</span>(index = Index.NO)</code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="annotation">@GenericField</span>(searchable = Searchable.NO)</code></pre>
</div>
</div>
<div class="paragraph">
<p>or</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="annotation">@FullTextField</span>(searchable = Searchable.NO)</code></pre>
</div>
</div>
<div class="paragraph">
<p>or</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="annotation">@KeywordField</span>(searchable = Searchable.NO)</code></pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="field-indexnullas"><a class="anchor" href="#field-indexnullas"></a><code>@Field.indexNullAs</code></h5>
<div class="paragraph">
<p><code>@Field.indexNullAs</code> is still available for most Hibernate Search 6&#8217;s <code>@*Field</code> annotations:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Hibernate Search 5</th>
<th class="tableblock halign-left valign-top">Hibernate Search 6</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="annotation">@Field</span>(indexNullAs = <span class="string"><span class="delimiter">&quot;</span><span class="content">_null_</span><span class="delimiter">&quot;</span></span>)</code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="annotation">@GenericField</span>(indexNullAs = <span class="string"><span class="delimiter">&quot;</span><span class="content">_null_</span><span class="delimiter">&quot;</span></span>)</code></pre>
</div>
</div>
<div class="paragraph">
<p>or</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="annotation">@KeywordField</span>(indexNullAs = <span class="string"><span class="delimiter">&quot;</span><span class="content">_null_</span><span class="delimiter">&quot;</span></span>)</code></pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>However:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>You should consider whether it is really necessary,
as the new <a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#search-dsl-predicate-exists"><code>exists</code> predicate</a>
introduced in Hibernate Search 6 allows finding documents where a field is present or not
<strong>without</strong> relying on <code>indexNullAs</code>.</p>
</li>
<li>
<p><code>indexNullAs</code> is not available on <code>@FullTextField</code>.</p>
</li>
<li>
<p>The default null token is no longer supported, i.e. <code>Field.DEFAULT_NULL_TOKEN</code> has no equivalent in Hibernate search 6.
Each field that requires <code>indexNullAs</code> must have its value set explicitly.</p>
</li>
<li>
<p>The (text) value passed to <code>indexNullAs</code> must be <a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#mapper-orm-directfieldmapping-supported-types">formatted according to the type of the field</a>.</p>
</li>
<li>
<p><a href="#indexnullas-is-for-indexing"><code>indexNullAs</code> is irrelevant when building predicates and when projecting</a>.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="field-name"><a class="anchor" href="#field-name"></a><code>@Field.name</code></h5>
<div class="paragraph">
<p><code>@Field.name</code> stays the same in Hibernate Search 6&#8217;s <code>@*Field</code> annotations:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Hibernate Search 5</th>
<th class="tableblock halign-left valign-top">Hibernate Search 6</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="annotation">@Field</span>(name = <span class="string"><span class="delimiter">&quot;</span><span class="content">myField</span><span class="delimiter">&quot;</span></span>)</code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="annotation">@GenericField</span>(name = <span class="string"><span class="delimiter">&quot;</span><span class="content">myField</span><span class="delimiter">&quot;</span></span>)</code></pre>
</div>
</div>
<div class="paragraph">
<p>or</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="annotation">@FullTextField</span>(name = <span class="string"><span class="delimiter">&quot;</span><span class="content">myField</span><span class="delimiter">&quot;</span></span>)</code></pre>
</div>
</div>
<div class="paragraph">
<p>or</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="annotation">@KeywordField</span>(name = <span class="string"><span class="delimiter">&quot;</span><span class="content">myField</span><span class="delimiter">&quot;</span></span>)</code></pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="field-normalizer"><a class="anchor" href="#field-normalizer"></a><code>@Field.normalizer</code></h5>
<div class="paragraph">
<p>See <a href="#field-basics">Basics</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="field-norms"><a class="anchor" href="#field-norms"></a><code>@Field.norms</code></h5>
<div class="paragraph">
<p><code>@Field.norms</code> only has an equivalent in Hibernate Search 6&#8217;s <code>@FullTextField</code> and <code>@KeywordField</code>.
The <code>Norms</code> enum has moved to <code>org.hibernate.search.engine.backend.types.Norms</code>.</p>
</div>
</div>
<div class="sect4">
<h5 id="field-store"><a class="anchor" href="#field-store"></a><code>@Field.store</code></h5>
<div class="paragraph">
<p><code>@Field.store</code> is now <code>@*Field.projectable</code>:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Hibernate Search 5</th>
<th class="tableblock halign-left valign-top">Hibernate Search 6</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="annotation">@Field</span>(store = Store.YES)</code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="annotation">@GenericField</span>(projectable = Projectable.YES)</code></pre>
</div>
</div>
<div class="paragraph">
<p>or</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="annotation">@FullTextField</span>(projectable = Projectable.YES)</code></pre>
</div>
</div>
<div class="paragraph">
<p>or</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="annotation">@KeywordField</span>(projectable = Projectable.YES)</code></pre>
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="annotation">@Field</span>(store = Store.NO)</code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="annotation">@GenericField</span>(projectable = Projectable.NO)</code></pre>
</div>
</div>
<div class="paragraph">
<p>or</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="annotation">@FullTextField</span>(projectable = Projectable.NO)</code></pre>
</div>
</div>
<div class="paragraph">
<p>or</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="annotation">@KeywordField</span>(projectable = Projectable.NO)</code></pre>
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="annotation">@Field</span>(store = Store.COMPRESS)</code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>No direct equivalent; use <code>Projectable.YES</code>.</p>
</div>
<div class="paragraph">
<p>See also <a href="https://hibernate.atlassian.net/browse/HSEARCH-3081">HSEARCH-3081</a>.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="field-termVector"><a class="anchor" href="#field-termVector"></a><code>@Field.termVector</code></h5>
<div class="paragraph">
<p><code>@Field.termVector</code> only has an equivalent in Hibernate Search 6&#8217;s <code>@FullTextField</code>.
The <code>TermVector</code> enum has moved to <code>org.hibernate.search.engine.backend.types.TermVector</code>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="fieldbridge"><a class="anchor" href="#fieldbridge"></a><code>@FieldBridge</code></h4>
<div class="paragraph">
<p>See <a href="#bridges">Bridges</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="fulltextfilterdef"><a class="anchor" href="#fulltextfilterdef"></a><code>@FullTextFilterDef</code>, <code>@FullTextFilterDefs</code></h4>
<div class="paragraph">
<p>Full-text filters have no direct equivalent in Hibernate Search 6.</p>
</div>
<div class="paragraph">
<p>See <a href="#full-text-filter">Full-text filter</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="indexed"><a class="anchor" href="#indexed"></a><code>@Indexed</code></h4>
<div class="sect4">
<h5 id="indexed-basics"><a class="anchor" href="#indexed-basics"></a>Basics</h5>
<div class="paragraph">
<p><code>@Indexed</code> is still available in Hibernate Search 6, but moved to a different package:
<code>org.hibernate.search.mapper.pojo.mapping.definition.annotation.Indexed</code>.</p>
</div>
<div class="paragraph">
<p>However, in Hibernate Search 6:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#index-name-defaults-to-entity-name">index names default to the entity name, not the class name</a>.</p>
</li>
<li>
<p><a href="#indexed-is-inherited"><code>@Indexed</code> is inherited</a>.</p>
</li>
<li>
<p><a href="#index-exclusive">each indexed type has its own index</a>.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="indexed-index"><a class="anchor" href="#indexed-index"></a><a id="_indexed_index"></a> <code>@Indexed.index</code></h5>
<div class="paragraph">
<p><code>@Indexed.index</code> stays the same in Hibernate Search 6.</p>
</div>
</div>
<div class="sect4">
<h5 id="indexed-interceptor"><a class="anchor" href="#indexed-interceptor"></a><a id="_indexed_interceptor"></a> <code>@Indexed.interceptor</code></h5>
<div class="paragraph">
<p>Entity indexing interceptors have no direct equivalent in Hibernate Search 6,
but conditional indexing can be implemented through routing bridges.</p>
</div>
<div class="paragraph">
<p>See <a href="#entity-indexing-interceptors">Entity indexing interceptors</a>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="indexedembeded"><a class="anchor" href="#indexedembeded"></a><code>@IndexedEmbedded</code></h4>
<div class="sect4">
<h5 id="indexedembeded-basics"><a class="anchor" href="#indexedembeded-basics"></a>Basics</h5>
<div class="paragraph">
<p><code>@IndexedEmbedded</code> is still available in Hibernate Search 6, but moved to a different package:
<code>org.hibernate.search.mapper.pojo.mapping.definition.annotation.IndexedEmbedded</code>.</p>
</div>
</div>
<div class="sect4">
<h5 id="indexedembeded-depth"><a class="anchor" href="#indexedembeded-depth"></a><a id="_indexedembedded_depth"></a> <code>@IndexedEmbedded.depth</code></h5>
<div class="paragraph">
<p><code>@IndexedEmbedded.depth</code> was renamed to <code>includeDepth</code> in Hibernate Search 6:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Hibernate Search 5</th>
<th class="tableblock halign-left valign-top">Hibernate Search 6</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="annotation">@IndexedEmbedded</span>(depth = <span class="integer">2</span>)</code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="annotation">@IndexedEmbedded</span>(includeDepth = <span class="integer">2</span>)</code></pre>
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="annotation">@IndexedEmbedded</span>(depth = <span class="integer">1</span>, includePaths = {<span class="string"><span class="delimiter">&quot;</span><span class="content">foo.bar</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">foo.bar2</span><span class="delimiter">&quot;</span></span>})</code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="annotation">@IndexedEmbedded</span>(includeDepth = <span class="integer">1</span>, includePaths = {<span class="string"><span class="delimiter">&quot;</span><span class="content">foo.bar</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">foo.bar2</span><span class="delimiter">&quot;</span></span>})</code></pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="indexedembeded-includePaths"><a class="anchor" href="#indexedembeded-includePaths"></a><a id="_indexedembedded_includepaths"></a> <code>@IndexedEmbedded.includePaths</code></h5>
<div class="paragraph">
<p><code>@IndexedEmbedded.includePaths</code> stays the same in Hibernate Search 6.</p>
</div>
<div class="paragraph">
<p>However, the document id of other entities is no longer a field by default,
so you can no longer use <code>@IndexedEmbedded(includePaths = "id")</code> (for example)
to embed another entity&#8217;s ID, unless you explicitly add a <code>@GenericField</code> annotation on the id property.
See <a href="#document-id-is-not-a-field">The document ID is not an index field</a> for more information.</p>
</div>
</div>
<div class="sect4">
<h5 id="indexedembeded-prefix"><a class="anchor" href="#indexedembeded-prefix"></a><a id="_indexedembedded_prefix"></a> <code>@IndexedEmbedded.prefix</code></h5>
<div class="paragraph">
<p><code>@IndexedEmbedded.prefix</code> is still available in Hibernate Search 6, but is deprecated for removal in the next major version.</p>
</div>
<div class="paragraph">
<p>You should use <code>@IndexedEmbedded.name</code> instead,
which doesn&#8217;t prepend a prefix to the embedded fields, but instead creates an object field with the given name:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Hibernate Search 5</th>
<th class="tableblock halign-left valign-top">Hibernate Search 6</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="annotation">@IndexedEmbedded</span>(prefix = <span class="string"><span class="delimiter">&quot;</span><span class="content">foo.</span><span class="delimiter">&quot;</span></span>)</code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="annotation">@IndexedEmbedded</span>(name = <span class="string"><span class="delimiter">&quot;</span><span class="content">foo</span><span class="delimiter">&quot;</span></span>)</code></pre>
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="annotation">@IndexedEmbedded</span>(prefix = <span class="string"><span class="delimiter">&quot;</span><span class="content">foo.bar.</span><span class="delimiter">&quot;</span></span>)</code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
No equivalent: <code>name</code> only allows one object field.
</td>
</tr>
</table>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="annotation">@IndexedEmbedded</span>(prefix = <span class="string"><span class="delimiter">&quot;</span><span class="content">foo_</span><span class="delimiter">&quot;</span></span>)</code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top" rowspan="2"><div class="content"><div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
No equivalent: <code>name</code> does not allow prefixes to be prepended to embedded field names.
</td>
</tr>
</table>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="annotation">@IndexedEmbedded</span>(prefix = <span class="string"><span class="delimiter">&quot;</span><span class="content">foo.bar_</span><span class="delimiter">&quot;</span></span>)</code></pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="indexedembeded-targetElement"><a class="anchor" href="#indexedembeded-targetElement"></a><a id="_indexedembedded_targetelement"></a> <code>@IndexedEmbedded.targetElement</code></h5>
<div class="paragraph">
<p><code>@IndexedEmbedded.targetElement</code> was renamed to <code>targetType</code> in Hibernate Search 6:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Hibernate Search 5</th>
<th class="tableblock halign-left valign-top">Hibernate Search 6</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="annotation">@IndexedEmbedded</span>(targetElement = MyConcreteEntity.class)</code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="annotation">@IndexedEmbedded</span>(targetType = MyConcreteEntity.class)</code></pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="indexedembeded-indexNullAs"><a class="anchor" href="#indexedembeded-indexNullAs"></a><a id="_indexedembedded_indexnullas"></a> <code>@IndexedEmbedded.indexNullAs</code></h5>
<div class="paragraph">
<p><code>@IndexedEmbedded.indexNullAs</code> has no equivalent in Hibernate Search 6.</p>
</div>
<div class="paragraph">
<p>To search for documents where an object field is present (or absent),
use the <a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#search-dsl-predicate-exists"><code>exists</code> predicate</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="indexedembeded-includeEmbeddedObjectId"><a class="anchor" href="#indexedembeded-includeEmbeddedObjectId"></a><a id="_indexedembedded_includeembeddedobjectid"></a> <code>@IndexedEmbedded.includeEmbeddedObjectId</code></h5>
<div class="paragraph">
<p><code>@IndexedEmbedded.includeEmbeddedObjectId</code> stays the same in Hibernate Search 6.</p>
</div>
<div class="paragraph">
<p>However, embedded IDs of numeric or date/time types (<code>Integer</code>, <code>Long</code>, <code>Date</code>, &#8230;&#8203;)
used to be indexed as string values by default in Hibernate Search 5,
but are indexed as numeric values by default in Hibernate Search 6.
See <a href="#more-numeric-by-default">More fields are numeric by default</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="indexedembeded-containerextraction"><a class="anchor" href="#indexedembeded-containerextraction"></a><a id="_using_indexedembedded_to_request_container_extraction"></a> Using <code>@IndexedEmbedded</code> to request container extraction</h5>
<div class="paragraph">
<p>A little-known and undocumented feature of <code>@IndexedEmbedded</code> was to combine it with <code>@Field</code>
on a property of a container type (<code>Collection</code>, <code>List</code>, <code>Map</code>, &#8230;&#8203;) to instruct Hibernate Search to apply <code>@Field</code> to the container elements
instead of the container.</p>
</div>
<div class="paragraph">
<p>For example, the code below would lead to a bootstrap failure, because there is no default bridge for the <code>List</code> type:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="annotation">@Field</span>
<span class="annotation">@ElementCollection</span>
<span class="directive">private</span> <span class="predefined-type">List</span>&lt;<span class="predefined-type">String</span>&gt; notes;</code></pre>
</div>
</div>
<div class="paragraph">
<p>However, the code below would work just fine,
and would instruct Hibernate Search to index each element of the <code>List</code> in the <code>notes</code> index field:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="annotation">@Field</span>
<span class="annotation">@IndexedEmbedded</span>
<span class="annotation">@ElementCollection</span>
<span class="directive">private</span> <span class="predefined-type">List</span>&lt;<span class="predefined-type">String</span>&gt; notes;</code></pre>
</div>
</div>
<div class="paragraph">
<p>In Hibernate Search 6, <code>@IndexedEmbedded</code> should no longer be used this way,
as the container extraction is now implied:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="annotation">@FullTextField</span>
<span class="annotation">@ElementCollection</span>
<span class="directive">private</span> <span class="predefined-type">List</span>&lt;<span class="predefined-type">String</span>&gt; notes;</code></pre>
</div>
</div>
<div class="paragraph">
<p>See also <a href="#implicit-container-extraction">Container extraction for <code>@*Field</code> is implied</a>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="key"><a class="anchor" href="#key"></a><code>@Key</code></h4>
<div class="paragraph">
<p><code>@Key</code> has no equivalent in Hibernate Search 6.</p>
</div>
<div class="paragraph">
<p>See also <a href="#full-text-filter">Full-text filter</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="latitude"><a class="anchor" href="#latitude"></a><code>@Latitude</code></h4>
<div class="paragraph">
<p><code>@Latitude</code> is still available in Hibernate Search 6, but moved to a different package:
<code>org.hibernate.search.annotations.Latitude</code>.</p>
</div>
<div class="paragraph">
<p>See also <a href="#spatial"><code>@Spatial</code>, <code>@Spatials</code></a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="longitude"><a class="anchor" href="#longitude"></a><code>@Longitude</code></h4>
<div class="paragraph">
<p><code>@Longitude</code> is still available in Hibernate Search 6, but moved to a different package:
<code>org.hibernate.search.annotations.Longitude</code>.</p>
</div>
<div class="paragraph">
<p>See also <a href="#spatial"><code>@Spatial</code>, <code>@Spatials</code></a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="normalizer"><a class="anchor" href="#normalizer"></a><code>@Normalizer</code></h4>
<div class="paragraph">
<p>In Hibernate Search 5, <code>@Normalizer</code> could point directly to a class extending <code>org.apache.lucene.analysis.Analyzer</code>,
for example with <code>@Normalizer(impl = MyNormalizer.class)</code>.</p>
</div>
<div class="paragraph">
<p>This is no longer possible: normalizers are now always referenced by their name.
However, you can assign a name to a given normalizer instance using
the <a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#backend-lucene-analysis-analyzers">Lucene analysis configurer</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="normalizerdef"><a class="anchor" href="#normalizerdef"></a><code>@NormalizerDef</code>, <code>@NormalizerDefs</code></h4>
<div class="paragraph">
<p>Annotation-based normalizer definitions are no longer supported.</p>
</div>
<div class="paragraph">
<p>Instead, implement an analysis configurer:
see <a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#backend-lucene-analysis-analyzers">here for Lucene</a>,
or <a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#backend-elasticsearch-analysis-analyzers">here for Elasticsearch</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="numericfield"><a class="anchor" href="#numericfield"></a><a id="_numericfield_numericfields"></a> <code>@NumericField</code>, <code>@NumericFields</code></h4>
<div class="paragraph">
<p><code>@NumericField</code> no longer exists in Hibernate Search 6.</p>
</div>
<div class="paragraph">
<p>Numeric types are indexed as numeric values by default, so this annotation can simply be removed.</p>
</div>
<div class="paragraph">
<p>See also <a href="#more-numeric-by-default">More fields are numeric by default</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="providedid"><a class="anchor" href="#providedid"></a><a id="_providedid"></a> <code>@ProvidedId</code></h4>
<div class="paragraph">
<p><code>@ProvidedId</code> was deprecated in Hibernate Search 5.
It no longer exists in Hibernate Search 6.</p>
</div>
</div>
<div class="sect3">
<h4 id="sortablefield"><a class="anchor" href="#sortablefield"></a><code>@SortableField</code>, <code>@SortableFields</code></h4>
<div class="paragraph">
<p><code>@SortableField</code> no longer exists in Hibernate Search 6. Instead, use <code>@*Field.sortable</code>:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Hibernate Search 5</th>
<th class="tableblock halign-left valign-top">Hibernate Search 6</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="annotation">@Field</span>
<span class="annotation">@SortableField</span></code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="annotation">@GenericField</span>(sortable = Sortable.YES)</code></pre>
</div>
</div>
<div class="paragraph">
<p>or</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="annotation">@KeywordField</span>(sortable = Sortable.YES)</code></pre>
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="annotation">@Field</span>
<span class="annotation">@Field</span>(name = <span class="string"><span class="delimiter">&quot;</span><span class="content">myField_sort</span><span class="delimiter">&quot;</span></span>, analyze = Analyze.NO)
<span class="annotation">@SortableField</span>(forField = <span class="string"><span class="delimiter">&quot;</span><span class="content">myField_sort</span><span class="delimiter">&quot;</span></span>)</code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="annotation">@FullTextField</span>
<span class="annotation">@KeywordField</span>(name = <span class="string"><span class="delimiter">&quot;</span><span class="content">myField_sort</span><span class="delimiter">&quot;</span></span>, sortable = Sortable.YES)</code></pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p><code>sortable</code> is not available on <code>@FullTextField</code>,
because <a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#mapper-orm-directfieldmapping-annotations-fulltextfield">tokenized data cannot be reliably sorted on</a>.</p>
</div>
<div class="paragraph">
<p>If you need both an analyzer and sorts on the same property, create two separate fields:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="annotation">@FullTextField</span>
<span class="annotation">@KeywordField</span>(name = <span class="string"><span class="delimiter">&quot;</span><span class="content">title_sort</span><span class="delimiter">&quot;</span></span>, normalizer = <span class="string"><span class="delimiter">&quot;</span><span class="content">myNormalizer</span><span class="delimiter">&quot;</span></span>, sortable = Sortable.YES)
<span class="directive">private</span> <span class="predefined-type">String</span> title;</code></pre>
</div>
</div>
<div class="paragraph">
<p>This will lead to two separate fields being created in the index, for the same property.
Just make sure to use the correct field name when searching:
<code>title</code> when creating <a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#search-dsl-predicate-match">predicates</a>,
but <code>title_sort</code> when creating <a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#search-dsl-sort-field">sorts</a>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="spatial"><a class="anchor" href="#spatial"></a><code>@Spatial</code>, <code>@Spatials</code></h4>
<div class="sect4">
<h5 id="spatial-basics"><a class="anchor" href="#spatial-basics"></a>Basics</h5>
<div class="paragraph">
<p><code>@Spatial</code> has no direct equivalent in Hibernate Search 6.</p>
</div>
<div class="paragraph">
<p>Here is a quick reference of how to convert a <code>@Spatial</code> annotation to Hibernate Search 6:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 40%;">
<col style="width: 20%;">
<col style="width: 40%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Hibernate Search 5</th>
<th class="tableblock halign-left valign-top">Latitude/longitude are mutable?</th>
<th class="tableblock halign-left valign-top">Hibernate Search 6</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" rowspan="2"><div class="content"><div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="annotation">@Indexed</span>
<span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">MyEntity</span> {
    <span class="annotation">@Spatial</span>
    <span class="directive">private</span> MyCoordinates location;
}
<span class="directive">public</span> <span class="type">class</span> <span class="class">MyCoordinates</span> <span class="directive">implements</span> Coordinates {
    <span class="directive">private</span> <span class="predefined-type">Double</span> latitude;
    <span class="directive">private</span> <span class="predefined-type">Double</span> longitude;
    <span class="annotation">@Override</span>
    <span class="directive">public</span> <span class="predefined-type">Double</span> getLatitude() {
        <span class="keyword">return</span> latitude;
    }
    <span class="annotation">@Override</span>
    <span class="directive">public</span> <span class="predefined-type">Double</span> getLongitude() {
        <span class="keyword">return</span> longitude;
    }
}</code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Yes</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="annotation">@Indexed</span>
<span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">MyEntity</span> {
    <span class="annotation">@GeoPointBinding</span>(projectable = Projectable.YES)
    <span class="directive">private</span> MyCoordinates location;
}
<span class="directive">public</span> <span class="type">class</span> <span class="class">MyCoordinates</span> {
    <span class="directive">private</span> <span class="predefined-type">Double</span> latitude;
    <span class="directive">private</span> <span class="predefined-type">Double</span> longitude;
    <span class="annotation">@Latitude</span>
    <span class="directive">public</span> <span class="predefined-type">Double</span> getLatitude() {
        <span class="keyword">return</span> latitude;
    }
    <span class="annotation">@Longitude</span>
    <span class="directive">public</span> <span class="predefined-type">Double</span> getLongitude() {
        <span class="keyword">return</span> longitude;
    }
}</code></pre>
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>No</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="annotation">@Indexed</span>
<span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">MyEntity</span> {
    <span class="annotation">@GenericField</span>(projectable = Projectable.YES)
    <span class="directive">private</span> MyCoordinates location;
}
<span class="directive">public</span> <span class="type">class</span> <span class="class">MyCoordinates</span> <span class="directive">implements</span> GeoPoint {
    <span class="directive">private</span> <span class="directive">final</span> <span class="type">double</span> latitude;
    <span class="directive">private</span> <span class="directive">final</span> <span class="type">double</span> longitude;
    <span class="annotation">@Override</span>
    <span class="directive">public</span> <span class="type">double</span> latitude() {
        <span class="keyword">return</span> latitude;
    }
    <span class="annotation">@Override</span>
    <span class="directive">public</span> <span class="type">double</span> longitude() {
        <span class="keyword">return</span> longitude;
    }
}</code></pre>
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="annotation">@Indexed</span>
<span class="annotation">@Entity</span>
<span class="annotation">@Spatial</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">MyEntity</span> {
    <span class="annotation">@Latitude</span>
    <span class="directive">private</span> <span class="predefined-type">Double</span> latitude;

    <span class="annotation">@Longitude</span>
    <span class="directive">private</span> <span class="predefined-type">Double</span> longitude;
}</code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Yes</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="annotation">@Indexed</span>
<span class="annotation">@Entity</span>
<span class="annotation">@GeoPointBinding</span>(projectable = Projectable.YES)
<span class="directive">public</span> <span class="type">class</span> <span class="class">MyEntity</span> {
    <span class="annotation">@Latitude</span>
    <span class="directive">private</span> <span class="predefined-type">Double</span> latitude;

    <span class="annotation">@Longitude</span>
    <span class="directive">private</span> <span class="predefined-type">Double</span> longitude;
}</code></pre>
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="annotation">@Indexed</span>
<span class="annotation">@Entity</span>
<span class="annotation">@Spatial</span>(name = <span class="string"><span class="delimiter">&quot;</span><span class="content">home_coordinates</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@Spatial</span>(name = <span class="string"><span class="delimiter">&quot;</span><span class="content">work_coordinates</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> MyEntity {
    <span class="annotation">@Latitude</span>(of = <span class="string"><span class="delimiter">&quot;</span><span class="content">home_coordinates</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">private</span> <span class="predefined-type">Double</span> homeLatitude;

    <span class="annotation">@Longitude</span>(of = <span class="string"><span class="delimiter">&quot;</span><span class="content">home_coordinates</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">private</span> <span class="predefined-type">Double</span> homeLongitude;

    <span class="annotation">@Latitude</span>(of = <span class="string"><span class="delimiter">&quot;</span><span class="content">work_coordinates</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">private</span> <span class="predefined-type">Double</span> workLatitude;

    <span class="annotation">@Longitude</span>(of = <span class="string"><span class="delimiter">&quot;</span><span class="content">home_coordinates</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">private</span> <span class="predefined-type">Double</span> workLongitude;
}</code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Yes</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="annotation">@Indexed</span>
<span class="annotation">@Entity</span>
<span class="annotation">@GeoPointBinding</span>(name = <span class="string"><span class="delimiter">&quot;</span><span class="content">home_coordinates</span><span class="delimiter">&quot;</span></span>, markerSet = <span class="string"><span class="delimiter">&quot;</span><span class="content">home</span><span class="delimiter">&quot;</span></span>, projectable = Projectable.YES)
<span class="annotation">@GeoPointBinding</span>(name = <span class="string"><span class="delimiter">&quot;</span><span class="content">work_coordinates</span><span class="delimiter">&quot;</span></span>, markerSet = <span class="string"><span class="delimiter">&quot;</span><span class="content">work</span><span class="delimiter">&quot;</span></span>, projectable = Projectable.YES)
<span class="directive">public</span> MyEntity {
    <span class="annotation">@Latitude</span>(markerSet = <span class="string"><span class="delimiter">&quot;</span><span class="content">home</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">private</span> <span class="predefined-type">Double</span> homeLatitude;

    <span class="annotation">@Longitude</span>(markerSet = <span class="string"><span class="delimiter">&quot;</span><span class="content">home</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">private</span> <span class="predefined-type">Double</span> homeLongitude;

    <span class="annotation">@Latitude</span>(markerSet = <span class="string"><span class="delimiter">&quot;</span><span class="content">work</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">private</span> <span class="predefined-type">Double</span> workLatitude;

    <span class="annotation">@Longitude</span>(markerSet = <span class="string"><span class="delimiter">&quot;</span><span class="content">home</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">private</span> <span class="predefined-type">Double</span> workLongitude;
}</code></pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="spatial-boost"><a class="anchor" href="#spatial-boost"></a><code>@Spatial.boost</code></h5>
<div class="paragraph">
<p>Index-time boosting was deprecated in Hibernate Search 5.
It is no longer available in Hibernate Search 6.</p>
</div>
<div class="paragraph">
<p>Instead, rely on <a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#search-dsl-predicate-common-boost">query-time boosting</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="spatial-name"><a class="anchor" href="#spatial-name"></a><code>@Spatial.name</code></h5>
<div class="paragraph">
<p><code>@Field.name</code> stays the same in Hibernate Search 6&#8217;s <code>@GeoPointBinding</code> and <code>@GenericField</code> annotations,
with one exception: the field name is mandatory when <code>@GeoPointBinding</code> is applied to a class.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Hibernate Search 5</th>
<th class="tableblock halign-left valign-top">Hibernate Search 6</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="annotation">@Spatial</span>(name = <span class="string"><span class="delimiter">&quot;</span><span class="content">myField</span><span class="delimiter">&quot;</span></span>)</code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="annotation">@GeoPointBinding</span>(name = <span class="string"><span class="delimiter">&quot;</span><span class="content">myField</span><span class="delimiter">&quot;</span></span>)</code></pre>
</div>
</div>
<div class="paragraph">
<p>or</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="annotation">@GenericField</span>(name = <span class="string"><span class="delimiter">&quot;</span><span class="content">myField</span><span class="delimiter">&quot;</span></span>)</code></pre>
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="annotation">@Spatial</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">MyEntity</span> {
    <span class="comment">// ...</span>
}</code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="annotation">@GeoPointBinding</span>(name = <span class="string"><span class="delimiter">&quot;</span><span class="content">location</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">MyEntity</span> {
    <span class="comment">// ...</span>
}</code></pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="spatial-spatialmode"><a class="anchor" href="#spatial-spatialmode"></a><code>@Spatial.spatialMode</code>, <code>@Spatial.topSpatialHashLevel</code>, <code>@Spatial.bottomSpatialHashLevel</code></h5>
<div class="paragraph">
<p><code>@Spatial.spatialMode</code>, <code>@Spatial.topSpatialHashLevel</code>, <code>@Spatial.bottomSpatialHashLevel</code>
have no equivalent in Hibernate Search 6:
geohash-based geo-point fields are no longer supported.</p>
</div>
<div class="paragraph">
<p>For Lucene, this is because Hibernate Search now uses Lucene&#8217;s built-in spatial support,
which is range-based.</p>
</div>
<div class="paragraph">
<p>For Elasticsearch, hash-based geo-point fields have never been available in the first place.</p>
</div>
</div>
<div class="sect4">
<h5 id="spatial-store"><a class="anchor" href="#spatial-store"></a><code>@Spatial.store</code></h5>
<div class="paragraph">
<p><code>@Spatial.store</code> is now <code>@GeoPointBinding.projectable</code>/<code>@GenericField.projectable</code>:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Hibernate Search 5</th>
<th class="tableblock halign-left valign-top">Hibernate Search 6</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="annotation">@Spatial</span>(store = Store.YES)</code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="annotation">@GeoPointBinding</span>(projectable = Projectable.YES)</code></pre>
</div>
</div>
<div class="paragraph">
<p>or</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="annotation">@GenericField</span>(projectable = Projectable.YES)</code></pre>
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="annotation">@Spatial</span>(store = Store.NO)</code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="annotation">@GeoPointBinding</span>(projectable = Projectable.YES)</code></pre>
</div>
</div>
<div class="paragraph">
<p>or</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="annotation">@GenericField</span>(projectable = Projectable.YES)</code></pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
In Hibernate Search 6, <code>projectable</code> must be set to <code>Projectable.YES</code>
to enable distance projections on a geo-point field.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="tikabridge"><a class="anchor" href="#tikabridge"></a><code>@TikaBridge</code></h4>
<div class="paragraph">
<p><code>@TikaBridge</code> has no equivalent in Hibernate Search 6 yet.</p>
</div>
<div class="paragraph">
<p>If you need this feature, vote for it to be re-implemented using the new bridge API
in a later version of Hibernate Search:
<a href="https://hibernate.atlassian.net/browse/HSEARCH-3350">HSEARCH-3350</a>.
We&#8217;ll also gladly help anyone interested in contributing a patch:
feel free to <a href="https://hibernate.org/community">contact us</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="tokenfilterdef"><a class="anchor" href="#tokenfilterdef"></a><code>@TokenFilterDef</code></h4>
<div class="paragraph">
<p>See <a href="#analyzerdef"><code>@AnalyzerDef</code>, <code>@AnalyzerDefs</code></a> or <a href="#normalizerdef"><code>@NormalizerDef</code>, <code>@NormalizerDefs</code></a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="tokenizerdef"><a class="anchor" href="#tokenizerdef"></a><code>@TokenizerDef</code></h4>
<div class="paragraph">
<p>See <a href="#analyzerdef"><code>@AnalyzerDef</code>, <code>@AnalyzerDefs</code></a>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="mapping-programmatic"><a class="anchor" href="#mapping-programmatic"></a>Programmatic mapping</h3>
<div class="paragraph">
<p>Programmatic mapping was overhauled to match the new mapping annotations.</p>
</div>
<div class="paragraph">
<p>See <a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#mapper-orm-programmatic-mapping">here</a> for the entry point,
and refer to the javadoc for details.</p>
</div>
</div>
<div class="sect2">
<h3 id="analysis-definition-provider"><a class="anchor" href="#analysis-definition-provider"></a>Analysis definition provider</h3>
<div class="paragraph">
<p>Analysis definition providers are now called analysis configurers.
The interfaces are slightly different but follow the same general principle.</p>
</div>
<div class="paragraph">
<p>See <a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#backend-lucene-analysis-analyzers">here for Lucene</a>,
or <a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#backend-elasticsearch-analysis-analyzers">here for Elasticsearch</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Analysis configurers can be used to override the default analyzer.
To do so, just define a custom analyzer named <code>default</code>.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
With the Lucene backend, analysis configurers can be used to override the default similarity.
See <a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#backend-lucene-analysis-similarity">here for more information</a>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="bridges"><a class="anchor" href="#bridges"></a>Bridges</h3>
<div class="paragraph">
<p>The bridge API was completely reworked in Hibernate Search 6 to offer a more powerful, Lucene-independent solution.
New features include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the ability to <a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#mapper-orm-bridge-index-field-type-dsl">define field types precisely</a>,
allowing in particular to pick an analyzer or to enable aggregation (faceting) on a bridge-declared field;</p>
</li>
<li>
<p>the ability to <a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#mapper-orm-bridge-bridgedelement-dependencies">declare the properties the bridge relies on</a>,
allowing Hibernate Search to reindex less often;</p>
</li>
<li>
<p>the ability to <a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#mapper-orm-bridge-index-field-dsl-dynamic">declare dynamic fields with a precise type</a>
which the Search DSL will be aware of;</p>
</li>
<li>
<p>the ability to <a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#mapper-orm-custom-annotations">define custom field annotations</a>;</p>
</li>
<li>
<p>and <a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#mapper-orm-bridge">more</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If your application relied on custom bridges with Hibernate Search 5,
and you need to re-implement them with Hibernate Search 6,
see <a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#mapper-orm-directfieldmapping-custom-types">mapping custom property types</a>.</p>
</div>
<div class="paragraph">
<p>The new bridge API is quite different from Hibernate Search 5,
but most changes should be addressed rather easily, especially
for the simpler bridges which will be implemented through <code>ValueBridge</code>.</p>
</div>
<div class="paragraph">
<p>Perhaps the only change to note is that bridges must declare the index fields they will create at bootstrap.
To set the value of new fields with random names dynamically at runtime,
you will have to rely on <a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#mapper-orm-bridge-index-field-dsl-dynamic">field templates</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="entity-indexing-interceptors"><a class="anchor" href="#entity-indexing-interceptors"></a>Entity indexing interceptors</h3>
<div class="paragraph">
<p>Entity indexing interceptors were used in Hibernate Search 5 to implement conditional indexing.</p>
</div>
<div class="paragraph">
<p>Conditional indexing can be implemented in Hibernate Search 6 with a different,
but equivalent solution: the <code>RoutingBridge</code>.</p>
</div>
<div class="paragraph">
<p>The idea is for the <code>RoutingBridge</code> to decide, based on the state of an entity,
whether its document should be routed to the index (indexed) or not (not indexed).</p>
</div>
<div class="paragraph">
<p>See <a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#mapper-orm-entityindexmapping-conditional-and-routing">this section of the documentation</a>
for more information.</p>
</div>
</div>
<div class="sect2">
<h3 id="fulltextsession"><a class="anchor" href="#fulltextsession"></a><code>FullTextEntityManager</code>/<code>FullTextSession</code></h3>
<div class="sect3">
<h4 id="fulltextsession-basics"><a class="anchor" href="#fulltextsession-basics"></a>Basics</h4>
<div class="paragraph">
<p>The equivalent to Hibernate Search 5&#8217;s <code>FullTextEntityManager</code>/<code>FullTextSession</code> is Hibernate Search 6&#8217;s <code>SearchSession</code>.</p>
</div>
<div class="paragraph">
<p>Here is how to retrieve the <code>FullTextEntityManager</code>/<code>FullTextSession</code> in Hibernate Search 5:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA">FullTextEntityManager fullTextEntityManager = Search.getFullTextEntityManager( entityManager );
FullTextSession fullTextSession = Search.getFullTextSession( session );</code></pre>
</div>
</div>
<div class="paragraph">
<p>The main entry point to Hibernate Search APIs is still named <code>Search</code>, but it moved to another package:
<code>org.hibernate.search.mapper.orm.Search</code>.
Here is how to retrieve the <code>SearchSession</code> in Hibernate Search 6:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA">SearchSession searchSession = Search.session( entityManager );
SearchSession searchSession = Search.session( session );</code></pre>
</div>
</div>
<div class="paragraph">
<p>Tha main difference between Hibernate Search 5 and 6 is that <code>SearchSession</code> does not extend <code>EntityManager</code> or <code>Session</code>:
the interface stands on its own.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>To retrieve the <code>EntityManager</code>/<code>Session</code> for a given <code>SearchSession</code>,
you can simply call <code>searchSession.toEntityManager()</code>/<code>searchSession.toOrmSession()</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>See the following sections for the exact equivalent of each operation.</p>
</div>
</div>
<div class="sect3">
<h4 id="fulltextsession-createfulltextquery"><a class="anchor" href="#fulltextsession-createfulltextquery"></a><code>FullTextSession.createFullTextQuery</code></h4>
<div class="paragraph">
<p>See <a href="#searching">Searching</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="fulltextsession-indexing"><a class="anchor" href="#fulltextsession-indexing"></a><code>FullTextSession.index(&#8230;&#8203;)</code>, <code>FullTextSession.purge(&#8230;&#8203;)</code></h4>
<div class="paragraph">
<p>In Hibernate Search 6, indexing operations are handled through the indexing plan:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>fullTextSession.index(entity)</code> is equivalent to <code>searchSession.indexingPlan().addOrUpdate(entity)</code>;</p>
</li>
<li>
<p><code>fullTextSession.purge(entity)</code> is equivalent to <code>searchSession.indexingPlan().delete(entity)</code>;</p>
</li>
<li>
<p><code>fullTextSession.purge(entityType, id)</code> is equivalent to <code>searchSession.indexingPlan().purge(entityType, id, null)</code>
(if you don&#8217;t use <a href="#sharding">sharding</a>)
or <code>searchSession.indexingPlan().purge(entityType, id, routingKey)</code>
(if you do use <a href="#sharding">sharding</a>).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>However:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>In Hibernate Search 5, these operations used to bypass the custom <a href="#entity-indexing-interceptors">Entity indexing interceptors</a>.
In Hibernate Search 6, the <code>addOrUppdate</code> and <code>delete</code> operations do not bypass the equivalent <code>RoutingBridge</code>,
but the <code>purge</code> operation still does.</p>
</li>
<li>
<p>In Hibernate Search 5, <code>index</code> only triggered indexing of the entity passed as an argument.
In Hibernate Search 6, <code>addOrUpdate</code> will also trigger reindexing of other entities that embed it
(through <code>@IndexedEmbedded</code> for example).</p>
</li>
<li>
<p>In Hibernate Search 5, passing a <code>null</code> identifier to <code>purge</code> used to trigger removal of all entities from the index.
In Hibernate Search 6, passing <code>null</code> to <code>delete</code>/<code>purge</code> will result in an exception being thrown.
To remove all entities from the index, see <a href="#fulltextsession-purgeall"><code>FullTextSession.purgeAll(&#8230;&#8203;)</code></a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>See <a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#mapper-orm-indexing-manual">this section of the documentation</a> for more information.</p>
</div>
</div>
<div class="sect3">
<h4 id="fulltextsession-flushtoindexes"><a class="anchor" href="#fulltextsession-flushtoindexes"></a><code>FullTextSession.flushToIndexes()</code></h4>
<div class="paragraph">
<p>The equivalent of <code>fullTextSession.flushToIndexes()</code> is <code>searchSession.indexingPlan().execute()</code>.</p>
</div>
<div class="paragraph">
<p>However, keep in mind that Hibernate Search 6 (on contrary to 5)
turns entities into documents upon Hibernate ORM session flushes,
so you generally don&#8217;t need to write to indexes until the write happens automatically on transaction commit,
<strong>even if you manually flush/clear the Hibernate ORM session</strong>.</p>
</div>
<div class="paragraph">
<p>The only valid reason to use this method is to preserve memory
when you&#8217;re processing a very large number of entities.</p>
</div>
<div class="paragraph">
<p>See <a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#mapper-orm-indexing-manual-indexingplan-process-execute">this section of the documentation</a>
for more information.</p>
</div>
</div>
<div class="sect3">
<h4 id="fulltextsession-purgeall"><a class="anchor" href="#fulltextsession-purgeall"></a><code>FullTextSession.purgeAll(&#8230;&#8203;)</code></h4>
<div class="paragraph">
<p>In Hibernate Search 5:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA">FullTextSession ftSession = Search.getFullTextSession( session );

ftSession.purgeAll( <span class="predefined-type">Book</span>.class );</code></pre>
</div>
</div>
<div class="paragraph">
<p>Equivalent in Hibernate Search 6:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA">SearchSession searchSession = Search.session( session );

searchSession.workspace( <span class="predefined-type">Book</span>.class ).purge();</code></pre>
</div>
</div>
<div class="paragraph">
<p>However, the purge is no longer performed on transaction commit: it&#8217;s executed immediately.</p>
</div>
<div class="paragraph">
<p>See <a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#mapper-orm-indexing-manual-largescale">this section of the documentation</a>
for more information.</p>
</div>
</div>
<div class="sect3">
<h4 id="fulltextsession-createindexer"><a class="anchor" href="#fulltextsession-createindexer"></a><code>FullTextSession.createIndexer(&#8230;&#8203;)</code></h4>
<div class="paragraph">
<p>See <a href="#massindexer"><code>MassIndexer</code></a>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="searching"><a class="anchor" href="#searching"></a>Searching</h3>
<div class="sect3">
<h4 id="searching-fulltextquery"><a class="anchor" href="#searching-fulltextquery"></a><code>FullTextQuery</code> &#8658; DSL</h4>
<div class="sect4">
<h5 id="searching-fulltextquery-basics"><a class="anchor" href="#searching-fulltextquery-basics"></a>Basics</h5>
<div class="paragraph">
<p>Search APIs have changed significantly, in order to implement several improvements, in particular:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>to get rid of Lucene types leaking through Hibernate Search APIs;</p>
</li>
<li>
<p>to avoid returning raw types in search results;</p>
</li>
<li>
<p>to expose a more adapted, native interface for Hibernate Search queries,
instead of trying to make do with JPA&#8217;s <code>Query</code> type;</p>
</li>
<li>
<p>to offer a less verbose, lambda-based syntax as an alternative to the "traditional", object-based syntax.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The recommended way to build search queries in Hibernate Search 6 is through the Hibernate Search DSL.
You can find an explanation of entry points and all available features of this DSL
in <a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#search-dsl-query">the dedicated section of the documentation</a>.</p>
</div>
<div class="paragraph">
<p>As to migrating existing queries, let&#8217;s take the following query in Hibernate Search 5 as an example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="type">int</span> pageIndex = ...;
<span class="type">int</span> pageSize = ...;
FullTextEntityManager fullTextEntityManager = Search.getFullTextEntityManager( em );
QueryBuilder qb = fullTextEntityManager.getSearchFactory()
        .buildQueryBuilder().forEntity( <span class="predefined-type">Book</span>.class ).get();

org.apache.lucene.search.Query luceneQuery = qb.keyword()
        .onField( <span class="string"><span class="delimiter">&quot;</span><span class="content">title</span><span class="delimiter">&quot;</span></span> ).boostedTo( <span class="integer">3</span> )
        .matching( <span class="string"><span class="delimiter">&quot;</span><span class="content">robot</span><span class="delimiter">&quot;</span></span> )
        .createQuery();

FullTextQuery fullTextQuery = fullTextEntityManager.createFullTextQuery( luceneQuery, <span class="predefined-type">Book</span>.class );
fullTextQuery.setFirstResult( pageIndex * pageSize );
fullTextQuery.setMaxResults( pageSize );

<span class="predefined-type">List</span> hits = fullTextQuery.getResultList();
<span class="type">int</span> totalHitCount = fullTextQuery.getResultSize();</code></pre>
</div>
</div>
<div class="paragraph">
<p>With the recommended lambda-based syntax, the equivalent code in Hibernate Search 6 will be:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="type">int</span> pageIndex = ...;
<span class="type">int</span> pageSize = ...;
SearchSession session = Search.session( entityManager );

<span class="predefined-type">SearchResult</span>&lt;<span class="predefined-type">Book</span>&gt; result = session.search( <span class="predefined-type">Book</span>.class )
        .where( f -&gt; f.match().field( <span class="string"><span class="delimiter">&quot;</span><span class="content">title</span><span class="delimiter">&quot;</span></span> ).matching( <span class="string"><span class="delimiter">&quot;</span><span class="content">robot</span><span class="delimiter">&quot;</span></span> ).boost( <span class="integer">3</span> ) )
        .fetch( pageIndex * pageSize, pageSize );

<span class="predefined-type">List</span>&lt;<span class="predefined-type">Book</span>&gt; hits = result.hits();
<span class="type">long</span> totalHitCount = result.total().hitCount();</code></pre>
</div>
</div>
<div class="paragraph">
<p>Alternatively, if the total hit count is not desired, you can use <code>fetchHits()</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="type">int</span> pageIndex = ...;
<span class="type">int</span> pageSize = ...;
SearchSession session = Search.session( entityManager );

<span class="predefined-type">List</span>&lt;<span class="predefined-type">Book</span>&gt; hits = session.search( <span class="predefined-type">Book</span>.class )
        .where( f -&gt; f.match().field( <span class="string"><span class="delimiter">&quot;</span><span class="content">title</span><span class="delimiter">&quot;</span></span> ).matching( <span class="string"><span class="delimiter">&quot;</span><span class="content">robot</span><span class="delimiter">&quot;</span></span> ).boost( <span class="integer">3</span> ) )
        .fetchHits( pageIndex * pageSize, pageSize );</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="searching-fulltextquery-jpa-orm"><a class="anchor" href="#searching-fulltextquery-jpa-orm"></a>Adapter from search query to JPA/ORM query</h5>
<div class="paragraph">
<p>If you really need a <code>Query</code> object implementing JPA or Hibernate ORM interfaces,
for example to integrate with external code designed for JPA/Hibernate ORM,
know that the Hibernate Search query can still be converted.</p>
</div>
<div class="paragraph">
<p>See <a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#search-dsl-query-object">this section of the documentation</a> for more information.</p>
</div>
</div>
<div class="sect4">
<h5 id="searching-fulltextquery-initializeObjectsWith"><a class="anchor" href="#searching-fulltextquery-initializeObjectsWith"></a><code>FullTextQuery.initializeObjectsWith</code></h5>
<div class="paragraph">
<p>Hibernate Search 6 does not allow setting a <code>DatabaseRetrievalMethod</code> on a search query:
entities are always loaded with a Hibernate ORM query.</p>
</div>
<div class="paragraph">
<p>In Hibernate Search 6,
the equivalent to setting the <code>ObjectLookupMethod</code> with <code>FullTextQuery.initializeObjectsWith</code>
is to <a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#search-dsl-query-cache-lookup-strategy">set the cache lookup strategy</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="searching-fulltextquery-setCriteriaQuery"><a class="anchor" href="#searching-fulltextquery-setCriteriaQuery"></a><code>FullTextQuery.setCriteriaQuery(&#8230;&#8203;)</code></h5>
<div class="paragraph">
<p>Hibernate Search 6 does not allow adding a <code>Criteria</code> object to a search query.</p>
</div>
<div class="paragraph">
<p>If your goal is to control loading of associations precisely,
<a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#search-dsl-query-entity-graph">set an entity graph in loading options</a> instead.</p>
</div>
<div class="paragraph">
<p>If your goal is to apply a filter expressed by an SQL "where" clause executed in-database,
rework your query to <a href="#projections">project on the entity ID</a>,
and execute a JPA/Hibernate ORM query after the search query to filter the entities and load them.</p>
</div>
</div>
<div class="sect4">
<h5 id="searching-fulltextquery-explain"><a class="anchor" href="#searching-fulltextquery-explain"></a><code>FullTextQuery.explain(&#8230;&#8203;)</code></h5>
<div class="paragraph">
<p>Hibernate Search 6 still offers a way to explain the score of hits through an <code>explain</code> method,
but that method expects the entity ID, not the internal Lucene document ID
(which can change from one query execution to the next).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA">LuceneSearchQuery&lt;<span class="predefined-type">Book</span>&gt; query = searchSession.search( <span class="predefined-type">Book</span>.class )
        .extension( LuceneExtension.get() )
        .where( f -&gt; f.match()
                .field( <span class="string"><span class="delimiter">&quot;</span><span class="content">title</span><span class="delimiter">&quot;</span></span> )
                .matching( <span class="string"><span class="delimiter">&quot;</span><span class="content">robot</span><span class="delimiter">&quot;</span></span> ) )
        .toQuery();

Explanation explanation = query.explain( <span class="integer">1</span> );</code></pre>
</div>
</div>
<div class="paragraph">
<p>See <a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#search-dsl-query-debugging-scores">this section of the documentation</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="searching-fulltextquery-setfilter"><a class="anchor" href="#searching-fulltextquery-setfilter"></a><code>FullTextQuery.setFilter(&#8230;&#8203;)</code></h5>
<div class="paragraph">
<p><code>FullTextQuery.setFilter(&#8230;&#8203;)</code> was deprecated in Hibernate Search 5.
It is no longer available in Hibernate Search 6.</p>
</div>
<div class="paragraph">
<p>To filter a query, just wrap your predicate in a boolean predicate
and add a <a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#search-dsl-predicate-boolean-filter"><code>filter</code> clause</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="searching-fulltextquery-fulltextfilter"><a class="anchor" href="#searching-fulltextquery-fulltextfilter"></a><code>FullTextQuery.enableFullTextFilter(&#8230;&#8203;)</code> / <code>FullTextQuery.disableFullTextFilter(&#8230;&#8203;)</code></h5>
<div class="paragraph">
<p>See <a href="#full-text-filter">Full-text filter</a>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="queries"><a class="anchor" href="#queries"></a><code>org.apache.lucene.search.Query</code> &#8658; <code>SearchPredicate</code></h4>
<div class="sect4">
<h5 id="queries-basics"><a class="anchor" href="#queries-basics"></a>Basics</h5>
<div class="paragraph">
<p>Lucene queries are replaced with Lucene-independent "search predicates" in Hibernate Search 6.</p>
</div>
<div class="paragraph">
<p>Most of the time, code that builds queries does not need to manipulate search predicates directly,
thanks to the lambda syntax.
However, it&#8217;s still possible to manipulate <code>SearchPredicate</code> objects if you need to pass them around from a method to another.</p>
</div>
<div class="paragraph">
<p>You can find more information about building predicates and details about all available predicates
in <a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#search-dsl-predicate">the dedicated section of the documentation</a>,
and instructions to migrate from the Hibernate Search 5 Query DSL in <a href="#queries-reference"><code>Query</code> DSL migration reference</a>.</p>
</div>
<div class="paragraph">
<p>As to migrating existing complex queries, let&#8217;s consider the query below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA">MySearchParameters searchParameters = ...;
FullTextEntityManager fullTextEntityManager = Search.getFullTextEntityManager( em );
QueryBuilder qb = fullTextEntityManager.getSearchFactory()
        .buildQueryBuilder().forEntity( <span class="predefined-type">Book</span>.class ).get();

BooleanJunction junction = qb.bool();
junction.must(qb.all().createQuery());

<span class="keyword">if</span> ( searchParameters.getSearchTerms() != <span class="predefined-constant">null</span> ) {
    junction.must( qb.simpleQueryString().onFields( <span class="string"><span class="delimiter">&quot;</span><span class="content">title</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">description</span><span class="delimiter">&quot;</span></span> )
            .withAndAsDefaultOperator()
            .matching( searchParameters.getSearchTerms() )
            .createQuery() );
}
<span class="keyword">if</span> ( searchParameters.getMaxBookLength() != <span class="predefined-constant">null</span> ) {
    junction.must( qb.range().onField( <span class="string"><span class="delimiter">&quot;</span><span class="content">pageCount</span><span class="delimiter">&quot;</span></span> )
            .below( searchParameters.getMaxBookLength() ) );
}
<span class="keyword">if</span> ( !searchParameters.getGenres().isEmpty() ) {
    BooleanJunction junction2 = qb.bool();
    <span class="keyword">for</span> ( Genre genre : searchParameters.getGenres() ) {
        junction2.should( qb.keyword().onField( <span class="string"><span class="delimiter">&quot;</span><span class="content">genre</span><span class="delimiter">&quot;</span></span> )
                .matching( genre ) );
    }
    junction.must( junction2.createQuery() );
}

org.apache.lucene.search.Query luceneQuery = junction.createQuery();

FullTextQuery fullTextQuery = fullTextEntityManager.createFullTextQuery( luceneQuery, <span class="predefined-type">Book</span>.class );
fullTextQuery.setFirstResult( params.getPageIndex() * params.getPageSize() );
fullTextQuery.setMaxResults( params.getPageSize() );

<span class="predefined-type">List</span> hits = fullTextQuery.getResultList();</code></pre>
</div>
</div>
<div class="paragraph">
<p>It would look like this in Hibernate Search 6:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA">MySearchParameters searchParameters = ...;
SearchSession session = Search.session( entityManager );
<span class="predefined-type">List</span>&lt;<span class="predefined-type">Book</span>&gt; hits = searchSession.search( <span class="predefined-type">Book</span>.class )
        .where( f -&gt; f.bool( b -&gt; {
            b.must( f.matchAll() );
            <span class="keyword">if</span> ( searchParameters.getSearchTerms() != <span class="predefined-constant">null</span> ) {
                b.must( f.simpleQueryString().fields( <span class="string"><span class="delimiter">&quot;</span><span class="content">title</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">description</span><span class="delimiter">&quot;</span></span> )
                        .matching( searchParameters.getSearchTerms() )
                        .defaultOperator( BooleanOperator.AND ) );
            }
            <span class="keyword">if</span> ( searchParameters.getMaxBookLength() != <span class="predefined-constant">null</span> ) {
                b.must( f.range().field( <span class="string"><span class="delimiter">&quot;</span><span class="content">pageCount</span><span class="delimiter">&quot;</span></span> )
                        .atMost( searchParameters.getMaxBookLength() ) );
            }
            <span class="keyword">if</span> ( !searchParameters.getGenres().isEmpty() ) {
                b.must( f.bool( b2 -&gt; {
                    <span class="keyword">for</span> ( Genre genre : searchParameters.getGenres() ) {
                        b2.should( f.match().field( <span class="string"><span class="delimiter">&quot;</span><span class="content">genre</span><span class="delimiter">&quot;</span></span> )
                                .matching( genre ) );
                    }
                } ) );
            }
        } ) )
        .fetchHits( searchParameters.getPageIndex() * searchParameters.getPageSize(),
                searchParameters.getPageSize() );</code></pre>
</div>
</div>
<div class="paragraph">
<p>Alternatively, if for some reasons predicate objects are necessary:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA">MySearchParameters searchParameters = ...;
SearchSession session = Search.session( entityManager );
SearchPredicateFactory pf = session.scope( <span class="predefined-type">Book</span>.class ).predicate();
<span class="predefined-type">List</span>&lt;SearchPredicate&gt; predicates = <span class="keyword">new</span> <span class="predefined-type">ArrayList</span>&lt;&gt;();

<span class="keyword">if</span> ( searchParameters.getSearchTerms() != <span class="predefined-constant">null</span> ) {
    predicates.add( pf.simpleQueryString().fields( <span class="string"><span class="delimiter">&quot;</span><span class="content">title</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">description</span><span class="delimiter">&quot;</span></span> )
            .matching( searchParameters.getSearchTerms() )
            .defaultOperator( BooleanOperator.AND )
            .toPredicate() );
}
<span class="keyword">if</span> ( searchParameters.getMaxBookLength() != <span class="predefined-constant">null</span> ) {
    predicates.add( pf.range().field( <span class="string"><span class="delimiter">&quot;</span><span class="content">pageCount</span><span class="delimiter">&quot;</span></span> )
            .atMost( searchParameters.getMaxBookLength() )
            .toPredicate() );
}
<span class="keyword">if</span> ( !searchParameters.getGenres().isEmpty() ) {
    predicates.add( f.bool( b -&gt; {
        <span class="keyword">for</span> ( Genre genre : searchParameters.getGenres() ) {
            b.should( f.match().field( <span class="string"><span class="delimiter">&quot;</span><span class="content">genre</span><span class="delimiter">&quot;</span></span> )
                    .matching( genre ) );
        }
    } )
            .toPredicate() );
}

SearchPredicate topLevelPredicate = pf.bool( b -&gt; {
    b.must( f.matchAll() );
    <span class="keyword">for</span> ( SearchPredicate predicate : predicates ) {
        b.must( predicate );
    }
} );

<span class="predefined-type">List</span>&lt;<span class="predefined-type">Book</span>&gt; hits = searchSession.search( <span class="predefined-type">Book</span>.class )
        .where( topLevelPredicate )
        .fetchHits( searchParameters.getPageIndex() * searchParameters.getPageSize(),
                searchParameters.getPageSize() );</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="queries-reference"><a class="anchor" href="#queries-reference"></a><code>Query</code> DSL migration reference</h5>
<div class="paragraph">
<p>The code below makes some assumptions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>For Hibernate Search 5, a <code>QueryBuilder</code> was retrieved from the <code>SearchFactory</code> and put in variable <code>qb</code>.</p>
</li>
<li>
<p>For Hibernate Search 6, the predicate is being built in a lambda expression:
<code>Search.session( entityManager ).search( Book.class ).where( f &#8594; &#8230;&#8203; )</code>.</p>
</li>
</ul>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Hibernate Search 5</th>
<th class="tableblock halign-left valign-top">Hibernate Search 6</th>
<th class="tableblock halign-left valign-top">Documentation</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="literal"><pre>qb.all().createQuery()</pre></div></td>
<td class="tableblock halign-left valign-top"><div class="literal"><pre>f.matchAll()</pre></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#search-dsl-predicate-match-all"><code>matchAll</code></a></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="literal"><pre>qb.keyword().onField("field")
        .matching("value")
        .createQuery()</pre></div></td>
<td class="tableblock halign-left valign-top"><div class="literal"><pre>f.match().field("field")
        .matching("value")</pre></div></td>
<td class="tableblock halign-left valign-top" rowspan="6"><div class="content"><div class="paragraph">
<p><a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#search-dsl-predicate-match"><code>match</code></a></p>
</div>
<div class="paragraph">
<p>For matches on the identifier (which is <a href="#document-id-is-not-a-field">no longer a field by default</a>),
use the <code>id</code> predicate instead (see below).</p>
</div>
<div class="paragraph">
<p><code>matching(&#8230;&#8203;)</code> <a href="#indexnullas-is-for-indexing">no longer accepts <code>null</code></a>;
use a (negated) <code>exists</code> predicate instead (see below).</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="literal"><pre>qb.keyword().onField("field")
        .matching("value")
        .ignoreFieldBridge()
        .createQuery()</pre></div></td>
<td class="tableblock halign-left valign-top"><div class="literal"><pre>f.match().field("field")
        .matching("value",
                ValueConvert.NO)</pre></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="literal"><pre>qb.keyword().onField("field")
        .matching("value")
        .ignoreAnalyzer()
        .createQuery()</pre></div></td>
<td class="tableblock halign-left valign-top"><div class="literal"><pre>f.match().field("field")
        .matching("value")
        .skipAnalysis()</pre></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="literal"><pre>qb.keyword().onField("field")
        .fuzzy()
        .matching("value")
        .createQuery()</pre></div></td>
<td class="tableblock halign-left valign-top"><div class="literal"><pre>f.match().field("field")
        .matching("value")
        .fuzzy()</pre></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="literal"><pre>qb.keyword().onField("field")
        .fuzzy()
        .withEditDistanceUpTo(2)
        .matching("value")
        .createQuery()</pre></div></td>
<td class="tableblock halign-left valign-top"><div class="literal"><pre>f.match().field("field")
        .matching("value")
        .fuzzy(2)</pre></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="literal"><pre>qb.keyword().onField("field")
        .fuzzy()
        .withEditDistanceUpTo(2)
        .withPrefixLength(1)
        .matching("value")
        .createQuery()</pre></div></td>
<td class="tableblock halign-left valign-top"><div class="literal"><pre>f.match().field("field")
        .matching("value")
        .fuzzy(2,1)</pre></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="literal"><pre>qb.keyword().onField("field")
        .matching(null)
        .createQuery()</pre></div></td>
<td class="tableblock halign-left valign-top"><div class="literal"><pre>f.bool().mustNot(f.exists()
        .field("field"))</pre></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#search-dsl-predicate-exists"><code>exists</code></a></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="literal"><pre>qb.keyword().onField("id")
        .matching(123L)
        .createQuery()</pre></div></td>
<td class="tableblock halign-left valign-top"><div class="literal"><pre>f.id().matching(123L)</pre></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#search-dsl-predicate-id"><code>id</code></a></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="literal"><pre>qb.keyword().wildcard()
        .onField("field")
        .matching("pattern*")
        .createQuery()</pre></div></td>
<td class="tableblock halign-left valign-top"><div class="literal"><pre>f.wildcard().field("field")
        .matching("pattern*")</pre></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#search-dsl-predicate-wildcard"><code>wildcard</code></a></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="literal"><pre>qb.range().onField("field")
        .from(0).to(3)
        .createQuery()</pre></div></td>
<td class="tableblock halign-left valign-top"><div class="literal"><pre>f.range().field("field")
        .between(0,3)</pre></div></td>
<td class="tableblock halign-left valign-top" rowspan="6"><div class="content"><div class="paragraph">
<p><a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#search-dsl-predicate-range"><code>range</code></a></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="literal"><pre>qb.range().onField("field")
        .from(0).to(3).excludeLimit()
        .createQuery()</pre></div></td>
<td class="tableblock halign-left valign-top"><div class="literal"><pre>f.range().field("field")
        .range(Range.canonical(0,3))</pre></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="literal"><pre>qb.range().onField("field")
        .below(3)
        .createQuery()</pre></div></td>
<td class="tableblock halign-left valign-top"><div class="literal"><pre>f.range().field("field")
        .atMost(3)</pre></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="literal"><pre>qb.range().onField("field")
        .below(3).excludeLimit()
        .createQuery()</pre></div></td>
<td class="tableblock halign-left valign-top"><div class="literal"><pre>f.range().field("field")
        .lessThan(3)</pre></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="literal"><pre>qb.range().onField("field")
        .above(0)
        .createQuery()</pre></div></td>
<td class="tableblock halign-left valign-top"><div class="literal"><pre>f.range().field("field")
        .atLeast(0)</pre></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="literal"><pre>qb.range().onField("field")
        .above(0).excludeLimit()
        .createQuery()</pre></div></td>
<td class="tableblock halign-left valign-top"><div class="literal"><pre>f.range().field("field")
        .greaterThan(0)</pre></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="literal"><pre>qb.phrase().onField("field")
        .sentence("a few words")
        .createQuery()</pre></div></td>
<td class="tableblock halign-left valign-top"><div class="literal"><pre>f.phrase().field("field")
        .matching("a few words")</pre></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#search-dsl-predicate-phrase"><code>phrase</code></a></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="literal"><pre>qb.bool()
.must(qb.keyword().onField("field1")
        .matching("value1")
        .createQuery())
.should(qb.keyword().onField("field2")
        .matching("value2")
        .createQuery())
.filter(qb.keyword().onField("field3")
        .matching("value3")
        .createQuery())
.must(qb.keyword().onField("field4")
        .matching("value4")
        .createQuery())
        .not()
.createQuery()</pre></div></td>
<td class="tableblock halign-left valign-top"><div class="literal"><pre>f.bool()
.must(f.match().field("field1")
        .matching("value1"))
.should(f.match().field("field2")
        .matching("value2"))
.filter(f.match().field("field3")
        .matching("value3"))
.mustNot(f.match().field("field4")
        .matching("value4"))</pre></div></td>
<td class="tableblock halign-left valign-top" rowspan="2"><div class="content"><div class="paragraph">
<p><a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#search-dsl-predicate-boolean"><code>bool</code></a></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="literal"><pre>qb.bool()
.minimumShouldMatchNumber(2)
.should(qb.keyword().onField("field1")
        .matching("value1")
        .createQuery())
.should(qb.keyword().onField("field2")
        .matching("value2")
        .createQuery())
.createQuery()</pre></div></td>
<td class="tableblock halign-left valign-top"><div class="literal"><pre>f.bool()
.minimumShouldMatchNumber(2)
.should(f.match().field("field1")
        .matching("value1"))
.should(f.match().field("field2")
        .matching("value2"))</pre></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="literal"><pre>qb.simpleQueryString().onField("field")
        .matching("querystring")</pre></div></td>
<td class="tableblock halign-left valign-top"><div class="literal"><pre>f.simpleQueryString().field("field")
        .matching("querystring")</pre></div></td>
<td class="tableblock halign-left valign-top" rowspan="2"><div class="content"><div class="paragraph">
<p><a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#search-dsl-predicate-simple-query-string"><code>simpleQueryString</code></a></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="literal"><pre>qb.simpleQueryString()
        .onField("field")
        .withAndAsDefaultOperator()
        .matching("querystring")</pre></div></td>
<td class="tableblock halign-left valign-top"><div class="literal"><pre>f.simpleQueryString().field("field")
        .defaultOperator(BooleanOperator.AND)
        .matching("querystring")</pre></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="literal"><pre>qb.spatial().onField("field")
        .within(51,Unit.KM)
        .ofLatitude(centerLatitude)
        .andLongitude(centerLongitude)
        .createQuery()</pre></div></td>
<td class="tableblock halign-left valign-top"><div class="literal"><pre>f.spatial().within()
        .field("field")
        .circle(centerLatitude,
                centerLongitude,
                51,
                DistanceUnit.KILOMETERS)</pre></div></td>
<td class="tableblock halign-left valign-top" rowspan="2"><div class="content"><div class="paragraph">
<p><a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#search-dsl-predicate-spatial-within"><code>within</code></a></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="literal"><pre>Coordinates center = ...;
qb.spatial().onField("field")
        .within(51,Unit.KM)
        .ofCoordinates(center)
        .createQuery()</pre></div></td>
<td class="tableblock halign-left valign-top"><div class="literal"><pre>GeoPoint center = ...;
f.spatial().within()
        .field("field")
        .circle(center,
                51,
                DistanceUnit.KILOMETERS)</pre></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="literal"><pre>qb.moreLikeThis()</pre></div></td>
<td class="tableblock halign-left valign-top"><div class="literal"><pre>-</pre></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="more-like-this"></a>No equivalent in Hibernate Search 6.</p>
</div>
<div class="paragraph">
<p>If you need more-like-this predicates,
feel free to drop a comment to explain your use case on <a href="https://hibernate.atlassian.net/browse/HSEARCH-3272">HSEARCH-3272</a>.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="queries-native"><a class="anchor" href="#queries-native"></a>Native query</h5>
<div class="paragraph">
<p>It is still possible to rely on native Lucene queries (e.g. <code>new RegexpQuery(&#8230;&#8203;)</code>)
or Elasticsearch queries (e.g. <code>{'match': {&#8230;&#8203;}}</code>)
in Hibernate Search 6:
you will just need to rely on the <a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#search-dsl-predicate-extensions">backend-specific extension</a>.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Be aware that internal field types may have changed since Hibernate Search 5;
see <a href="#data-format">Data format and schema changes</a>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sorts"><a class="anchor" href="#sorts"></a><code>org.apache.lucene.search.Sort</code> / <code>SortField</code> &#8658; <code>SearchSort</code></h4>
<div class="paragraph">
<p>Lucene sort fields are replaced with Lucene-independent "search sorts" in Hibernate Search 6.</p>
</div>
<div class="paragraph">
<p>Most of the time, code that builds queries does not need to manipulate search sorts directly,
thanks to the lambda syntax.
However, it&#8217;s still possible to manipulate <code>SearchSort</code> objects if you need to pass them around from a method to another.</p>
</div>
<div class="paragraph">
<p>You can find more information about building sorts and details about all available sorts
in <a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#search-dsl-sort">the dedicated section of the documentation</a>,
and instructions to migrate from the Hibernate Search 5 Query DSL in <a href="#sorts-reference"><code>Sort</code> DSL migration reference</a>.</p>
</div>
<div class="paragraph">
<p>As to adding sorts to search queries, let&#8217;s consider the query below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA">MySearchParameters params = ...;
FullTextEntityManager fullTextEntityManager = Search.getFullTextEntityManager( em );
QueryBuilder qb = fullTextEntityManager.getSearchFactory()
        .buildQueryBuilder().forEntity( <span class="predefined-type">Book</span>.class ).get();

FullTextQuery fullTextQuery = fullTextEntityManager.createFullTextQuery( qb.all().createQuery(), <span class="predefined-type">Book</span>.class );
fullTextQuery.setFirstResult( params.getPageIndex() * params.getPageSize() );
fullTextQuery.setMaxResults( params.getPageSize() );

fullTextQuery.sort( qb.sort().byField( <span class="string"><span class="delimiter">&quot;</span><span class="content">pageCount</span><span class="delimiter">&quot;</span></span> ).desc()
        .andByField( <span class="string"><span class="delimiter">&quot;</span><span class="content">title_sort</span><span class="delimiter">&quot;</span></span> )
        .createSort() );

<span class="predefined-type">List</span> hits = fullTextQuery.getResultList();</code></pre>
</div>
</div>
<div class="paragraph">
<p>It would look like this in Hibernate Search 6:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA">MySearchParameters params = ...;
SearchSession session = Search.session( entityManager );
<span class="predefined-type">List</span>&lt;<span class="predefined-type">Book</span>&gt; hits = searchSession.search( <span class="predefined-type">Book</span>.class )
        .where( f -&gt; f.matchAll() )
        .sort( f -&gt; f.field( <span class="string"><span class="delimiter">&quot;</span><span class="content">pageCount</span><span class="delimiter">&quot;</span></span> ).desc()
                .then().field( <span class="string"><span class="delimiter">&quot;</span><span class="content">title_sort</span><span class="delimiter">&quot;</span></span> ) )
        .fetchHits( params.getPageIndex() * params.getPageSize(), params.getPageSize() );</code></pre>
</div>
</div>
<div class="sect4">
<h5 id="sorts-reference"><a class="anchor" href="#sorts-reference"></a><code>Sort</code> DSL migration reference</h5>
<div class="paragraph">
<p>The code below makes some assumptions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>For Hibernate Search 5, a <code>QueryBuilder</code> was retrieved from the <code>SearchFactory</code> and put in variable <code>qb</code>.</p>
</li>
<li>
<p>For Hibernate Search 6, the sort is being built in a lambda expression:
<code>Search.session( entityManager ).search( Book.class ).where( f &#8594; f.matchAll() ).sort( f &#8594; &#8230;&#8203; )</code>.</p>
</li>
</ul>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Hibernate Search 5</th>
<th class="tableblock halign-left valign-top">Hibernate Search 6</th>
<th class="tableblock halign-left valign-top">Documentation</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="literal"><pre>qb.sort().byScore()
        .createSort()</pre></div></td>
<td class="tableblock halign-left valign-top"><div class="literal"><pre>f.score()</pre></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#search-dsl-sort-score"><code>score</code></a></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="literal"><pre>qb.sort().byIndexOrder()
        .createSort()</pre></div></td>
<td class="tableblock halign-left valign-top"><div class="literal"><pre>f.indexOrder()</pre></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#search-dsl-sort-index-order"><code>indexOrder</code></a></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="literal"><pre>qb.sort().byField("field")
        .createSort()</pre></div></td>
<td class="tableblock halign-left valign-top"><div class="literal"><pre>f.field("field")</pre></div></td>
<td class="tableblock halign-left valign-top" rowspan="6"><div class="content"><div class="paragraph">
<p><a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#search-dsl-sort-field"><code>field</code></a></p>
</div>
<div class="paragraph">
<p>Missing values are sorted differently by default.
See <a href="#sort-missing-values-last-by-default">When sorting by field value or distance, missing values are last by default</a>.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="literal"><pre>qb.sort().byField("field")
        .asc()
        .createSort()</pre></div></td>
<td class="tableblock halign-left valign-top"><div class="literal"><pre>f.field("field").asc()</pre></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="literal"><pre>qb.sort().byField("field")
        .desc()
        .createSort()</pre></div></td>
<td class="tableblock halign-left valign-top"><div class="literal"><pre>f.field("field").desc()</pre></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="literal"><pre>qb.sort().byField("field")
        .onMissingValue()
        .sortFirst()
        .createSort()</pre></div></td>
<td class="tableblock halign-left valign-top"><div class="literal"><pre>f.field("field")
        .missing().first()</pre></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="literal"><pre>qb.sort().byField("field")
        .onMissingValue()
        .sortLast()
        .createSort()</pre></div></td>
<td class="tableblock halign-left valign-top"><div class="literal"><pre>f.field("field")
        .missing().last()</pre></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="literal"><pre>qb.sort().byField("field")
        .onMissingValue()
        .use("value")
        .createSort()</pre></div></td>
<td class="tableblock halign-left valign-top"><div class="literal"><pre>f.field("field")
        .missing().use("value")</pre></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="literal"><pre>qb.sort()
        .byField("field",
                SortField.Type.STRING)
        .createSort()</pre></div></td>
<td class="tableblock halign-left valign-top"><div class="literal"><pre>-</pre></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>This method was deprecated in Hibernate Search 5.</p>
</div>
<div class="paragraph">
<p>There is no equivalent in Hibernate Search 6.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="literal"><pre>qb.sort().byDistance().onField("field")
        .fromLatitude(latitude)
        .andLongitude(longitude)
        .createSort()</pre></div></td>
<td class="tableblock halign-left valign-top"><div class="literal"><pre>f.distance("field",
        GeoPoint.of(latitude, longitude))</pre></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#search-dsl-sort-distance"><code>distance</code></a></p>
</div>
<div class="paragraph">
<p>Missing values are sorted differently by default.
See <a href="#sort-missing-values-last-by-default">When sorting by field value or distance, missing values are last by default</a>.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="literal"><pre>qb.sort().byNative(sortField)</pre></div></td>
<td class="tableblock halign-left valign-top"><div class="literal"><pre>f.extension(LuceneExtension.get())
        .fromLuceneSortField(sortField)</pre></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#search-dsl-sort-extensions-lucene-from-lucene-sort-field"><code>fromLuceneSortField</code></a></p>
</div>
<div class="paragraph">
<p>Be aware that internal field types may have changed since Hibernate Search 5;
see <a href="#data-format">Data format and schema changes</a>.</p>
</div>
<div class="paragraph">
<p>In particular, Hibernate Search 6 relies on <code>SORTED_SET</code> docvalues for most field types,
so the classic <code>SortField.TYPE.STRING</code> and similar just won&#8217;t work:
you need to go through the DSL to create the appropriate sorts.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="literal"><pre>qb.sort().byNative("authors.name", "{'order':'asc', 'mode': 'min'}")</pre></div></td>
<td class="tableblock halign-left valign-top"><div class="literal"><pre>f.extension(ElasticsearchExtension.get())
        .fromJson("{'authors.name': {'order':'asc', 'mode': 'min'} }")</pre></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#search-dsl-sort-extensions-elasticsearch-from-json"><code>fromJson</code></a></p>
</div>
<div class="paragraph">
<p>Be aware that internal field types may have changed since Hibernate Search 5;
see <a href="#data-format">Data format and schema changes</a>.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="sorts-native"><a class="anchor" href="#sorts-native"></a>Native sorts</h5>
<div class="paragraph">
<p>It is still possible to rely on native Lucene sort fields (e.g. <code>new SortField(&#8230;&#8203;)</code>)
or Elasticsearch sorts (e.g. <code>{'title_sort': {&#8230;&#8203;}}</code>)
in Hibernate Search 6:
you will just need to rely on the <a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#search-dsl-sort-extensions">backend-specific extension</a>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="projections"><a class="anchor" href="#projections"></a>Projections</h4>
<div class="sect4">
<h5 id="projections-basics"><a class="anchor" href="#projections-basics"></a>Basics</h5>
<div class="paragraph">
<p>Projections gain a full-blown DSL in Hibernate Search 6, allowing more complex projections,
as explained in <a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#search-dsl-sort">the dedicated section of the documentation</a>.</p>
</div>
<div class="paragraph">
<p>The <code>ProjectionConstants</code> are gone, and the projection DSL must be used instead to build <code>SearchProjection</code> objects.
You will find instructions to migrate from <code>ProjectionConstants</code> to the Hibernate Search 6 projection DSL in <a href="#projections-reference"><code>ProjectionConstants</code>/<code>ElasticsearchProjectionConstants</code> migration reference</a>.</p>
</div>
<div class="paragraph">
<p>As to adding projections to search queries, let&#8217;s consider the query below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA">FullTextEntityManager fullTextEntityManager = Search.getFullTextEntityManager( em );
QueryBuilder qb = fullTextEntityManager.getSearchFactory()
        .buildQueryBuilder().forEntity( <span class="predefined-type">Book</span>.class ).get();

FullTextQuery fullTextQuery = fullTextEntityManager.createFullTextQuery( qb.all().createQuery(), <span class="predefined-type">Book</span>.class );
fullTextQuery.setMaxResults( <span class="integer">20</span> );

fullTextQuery.setProjection( <span class="string"><span class="delimiter">&quot;</span><span class="content">isbn</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">title</span><span class="delimiter">&quot;</span></span> );

<span class="predefined-type">List</span> hits = fullTextQuery.getResultList();</code></pre>
</div>
</div>
<div class="paragraph">
<p>It would look like this in Hibernate Search 6:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA">SearchSession session = Search.session( entityManager );
<span class="predefined-type">List</span>&lt;<span class="predefined-type">List</span>&lt;?&gt;&gt; hits = searchSession.search( <span class="predefined-type">Book</span>.class )
        .select( f -&gt; f.composite(
                f.field( <span class="string"><span class="delimiter">&quot;</span><span class="content">isbn</span><span class="delimiter">&quot;</span></span> ),
                f.field( <span class="string"><span class="delimiter">&quot;</span><span class="content">title</span><span class="delimiter">&quot;</span></span> )
        ) )
        .where( f -&gt; f.matchAll() )
        .fetchHits( <span class="integer">20</span> );</code></pre>
</div>
</div>
<div class="paragraph">
<p>Alternatively, the composite projection can be made more type-safe:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA">SearchSession session = Search.session( entityManager );
<span class="predefined-type">List</span>&lt;<span class="predefined-type">Map</span>.Entry&lt;ISBN, <span class="predefined-type">String</span>&gt;&gt; hits = searchSession.search( <span class="predefined-type">Book</span>.class )
        .select( f -&gt; f.composite(
                <span class="predefined-type">Map</span>::entry,
                f.field( <span class="string"><span class="delimiter">&quot;</span><span class="content">isbn</span><span class="delimiter">&quot;</span></span>, ISBN.class ),
                f.field( <span class="string"><span class="delimiter">&quot;</span><span class="content">title</span><span class="delimiter">&quot;</span></span>, <span class="predefined-type">String</span>.class )
        ) )
        .where( f -&gt; f.matchAll() )
        .fetchHits( <span class="integer">20</span> );</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="projections-reference"><a class="anchor" href="#projections-reference"></a><code>ProjectionConstants</code>/<code>ElasticsearchProjectionConstants</code> migration reference</h5>
<div class="paragraph">
<p>The code below makes some assumptions for Hibernate Search 6: the projection is being built in a lambda expression,
e.g. <code>Search.session( entityManager ).search( Book.class ).select( f &#8594; &#8230;&#8203; )</code>.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Hibernate Search 5 <code>ProjectionConstants</code> or <code>ElasticsearchProjectionConstants</code></th>
<th class="tableblock halign-left valign-top">Hibernate Search 6</th>
<th class="tableblock halign-left valign-top">Documentation</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="literal"><pre>THIS</pre></div></td>
<td class="tableblock halign-left valign-top"><div class="literal"><pre>f.entity()</pre></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#search-dsl-projection-entity"><code>entity</code></a></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="literal"><pre>DOCUMENT</pre></div></td>
<td class="tableblock halign-left valign-top"><div class="literal"><pre>f.extension(LuceneExtension.get())
        .document()</pre></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#search-dsl-projection-extensions-lucene-document"><code>document</code></a></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="literal"><pre>SCORE</pre></div></td>
<td class="tableblock halign-left valign-top"><div class="literal"><pre>f.score()</pre></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#search-dsl-projection-score"><code>score</code></a></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="literal"><pre>ID</pre></div></td>
<td class="tableblock halign-left valign-top"><div class="literal"><pre>f.composite(EntityReference::id,
        f.entityReference())</pre></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#search-dsl-projection-reference"><code>entityReference</code></a>,
<a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#search-dsl-projection-composite"><code>composite</code></a></p>
</div>
<div class="paragraph">
<p>Alternatively, <code>f.entityReference()</code> (without the wrapping in the "composite" projection)
will return an instance of <code>EntityReference</code>,
which includes both the type and ID of the entity.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="literal"><pre>DOCUMENT_ID</pre></div></td>
<td class="tableblock halign-left valign-top"><div class="literal"><pre>f.composite(DocumentReference::id,
        f.documentReference())</pre></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#search-dsl-projection-documentReference"><code>documentReference</code></a>,
<a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#search-dsl-projection-composite"><code>composite</code></a></p>
</div>
<div class="paragraph">
<p>This no longer returns the internal Lucene document ID
(which can change from one query execution to the next),
but instead returns the Hibernate Search document ID,
i.e. the String version of the property annotated with <code>@Id</code> or <code>@DocumentId</code>.
Note that you no longer need the internal Lucene document ID
to get an <a href="#searching-fulltextquery-explain">explanation of the score</a>.</p>
</div>
<div class="paragraph">
<p>Alternatively, <code>f.documentReference()</code> (without the wrapping in the "composite" projection)
will return an instance of <code>DocumentReference</code>,
which includes both the type and ID of the document.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="literal"><pre>EXPLANATION</pre></div></td>
<td class="tableblock halign-left valign-top"><div class="literal"><pre>f.extension(LuceneExtension.get())
        .explanation()

OR

f.extension(ElasticsearchExtension.get())
        .explanation()</pre></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#search-dsl-projection-extensions-lucene-explanation"><code>explanation</code> (Lucene)</a></p>
</div>
<div class="paragraph">
<p><a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#search-dsl-projection-extensions-elasticsearch-explanation"><code>explanation</code> (Elasticsearch)</a></p>
</div>
<div class="paragraph">
<p>This projection returns a <code>JsonObject</code> for Elasticsearch.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="literal"><pre>OBJECT_CLASS</pre></div></td>
<td class="tableblock halign-left valign-top"><div class="literal"><pre>f.composite(EntityReference::type,
        f.entityReference())</pre></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#search-dsl-projection-reference"><code>entityReference</code></a>,
<a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#search-dsl-projection-composite"><code>composite</code></a></p>
</div>
<div class="paragraph">
<p>Alternatively, <code>f.entityReference()</code> (without the wrapping in the "composite" projection)
will return an instance of <code>EntityReference</code>,
which includes both the type and ID of the entity.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" rowspan="2"><div class="literal"><pre>SPATIAL_DISTANCE</pre></div></td>
<td class="tableblock halign-left valign-top"><div class="literal"><pre>f.distance("field",
        GeoPoint.of(latitude, longitude))</pre></div></td>
<td class="tableblock halign-left valign-top" rowspan="2"><div class="content"><div class="paragraph">
<p><a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#search-dsl-projection-distance"><code>distance</code></a></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="literal"><pre>f.distance("field",
        GeoPoint.of(latitude, longitude))
        .unit( DistanceUnit.KILOMETERS )</pre></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="literal"><pre>SOURCE</pre></div></td>
<td class="tableblock halign-left valign-top"><div class="literal"><pre>f.extension(ElasticsearchExtension.get())
        .source()</pre></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#search-dsl-projection-extensions-elasticsearch-source"><code>source</code></a></p>
</div>
<div class="paragraph">
<p>This projection used to return a <code>String</code> in Hibernate Search 5,
but returns a <code>JsonObject</code> in Hibernate Search 6.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="literal"><pre>TOOK</pre></div></td>
<td class="tableblock halign-left valign-top"><div class="literal"><pre>-</pre></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>See <a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#search-dsl-query-debugging-took-timedout"><code>took</code> and <code>timedOut</code></a></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="literal"><pre>TIMED_OUT</pre></div></td>
<td class="tableblock halign-left valign-top"><div class="literal"><pre>-</pre></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>See <a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#search-dsl-query-debugging-took-timedout"><code>took</code> and <code>timedOut</code></a></p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="searching-facet"><a class="anchor" href="#searching-facet"></a>Facets &#8658; Aggregations</h4>
<div class="paragraph">
<p>Facets are now called aggregations, which are a generalization of the concept of faceting.</p>
</div>
<div class="paragraph">
<p>Like other concepts (predicates, sorts, &#8230;&#8203;) aggregations have a dedicated DSL in Hibernate Search 6,
as explained in <a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#search-dsl-aggregation">the dedicated section of the documentation</a>.</p>
</div>
<div class="paragraph">
<p>See the following sections for the equivalent aggregation for each type of facet.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
One difference with Hibernate Search 5 is that Hibernate Search 6 aggregations
no longer allow drill-down (<code>.selectFacets(&#8230;&#8203;)</code>).
See <a href="#searching-facets-selectfacets">Drill-down with <code>.selectFacets</code></a>.
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="searching-facet-discrete-faceting"><a class="anchor" href="#searching-facet-discrete-faceting"></a><a id="_discrete_faceting"></a> Discrete faceting</h5>
<div class="paragraph">
<p>Let&#8217;s consider the query below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA">FullTextEntityManager fullTextEntityManager = Search.getFullTextEntityManager( em );
QueryBuilder qb = fullTextEntityManager.getSearchFactory()
        .buildQueryBuilder().forEntity( <span class="predefined-type">Book</span>.class ).get();

FacetingRequest genreFacetingRequest = qb.facet()
        .name( <span class="string"><span class="delimiter">&quot;</span><span class="content">genreFaceting</span><span class="delimiter">&quot;</span></span> )
        .onField( <span class="string"><span class="delimiter">&quot;</span><span class="content">genre</span><span class="delimiter">&quot;</span></span> )
        .discrete()
        .orderedBy( FacetSortOrder.COUNT_DESC )
        .includeZeroCounts( <span class="predefined-constant">false</span> )
        .maxFacetCount( <span class="integer">3</span> )
        .createFacetingRequest();

FullTextQuery fullTextQuery = fullTextEntityManager.createFullTextQuery( qb.all().createQuery(), <span class="predefined-type">Book</span>.class );
fullTextQuery.setMaxResults( <span class="integer">20</span> );

FacetManager facetManager = fullTextQuery.getFacetManager();
facetManager.enableFaceting( genreFacetingRequest );

<span class="predefined-type">List</span> hits = fullTextQuery.getResultList();

<span class="predefined-type">List</span>&lt;Facet&gt; facets = facetManager.getFacets( <span class="string"><span class="delimiter">&quot;</span><span class="content">genreFaceting</span><span class="delimiter">&quot;</span></span> );</code></pre>
</div>
</div>
<div class="paragraph">
<p>It would look like this in Hibernate Search 6:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA">SearchSession session = Search.session( entityManager );

AggregationKey&lt;<span class="predefined-type">Map</span>&lt;Genre, <span class="predefined-type">Long</span>&gt;&gt; countByGenreKey = AggregationKey.of( <span class="string"><span class="delimiter">&quot;</span><span class="content">countByGenre</span><span class="delimiter">&quot;</span></span> );

<span class="predefined-type">SearchResult</span>&lt;<span class="predefined-type">Book</span>&gt; result = searchSession.search( <span class="predefined-type">Book</span>.class )
        .where( f -&gt; f.matchAll() )
        .aggregation( countByGenreKey, f -&gt; f.terms()
                .field( <span class="string"><span class="delimiter">&quot;</span><span class="content">genre</span><span class="delimiter">&quot;</span></span>, Genre.class )
                .orderByCountDescending()
                .minDocumentCount( <span class="integer">1</span> )
                .maxTermCount( <span class="integer">3</span> ) )
        .fetch( <span class="integer">20</span> );

<span class="predefined-type">List</span>&lt;<span class="predefined-type">Book</span>&gt; hits = result.hits();

<span class="predefined-type">Map</span>&lt;Genre, <span class="predefined-type">Long</span>&gt; countByGenre = result.aggregation( countByGenreKey );</code></pre>
</div>
</div>
<div class="paragraph">
<p>See <a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#search-dsl-aggregation-terms">this section of the documentation</a> for more information.</p>
</div>
</div>
<div class="sect4">
<h5 id="searching-facet-range-faceting"><a class="anchor" href="#searching-facet-range-faceting"></a><a id="_range_faceting"></a> Range faceting</h5>
<div class="paragraph">
<p>Let&#8217;s consider the query below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA">FullTextEntityManager fullTextEntityManager = Search.getFullTextEntityManager( em );
QueryBuilder qb = fullTextEntityManager.getSearchFactory()
        .buildQueryBuilder().forEntity( <span class="predefined-type">Book</span>.class ).get();

FacetingRequest priceFacetingRequest = qb.facet()
        .name( <span class="string"><span class="delimiter">&quot;</span><span class="content">priceFaceting</span><span class="delimiter">&quot;</span></span> )
        .onField( <span class="string"><span class="delimiter">&quot;</span><span class="content">price</span><span class="delimiter">&quot;</span></span> )
        .range()
        .below( <span class="integer">1000</span> ).excludeLimit()
        .from( <span class="integer">1001</span> ).to( <span class="integer">1500</span> ).excludeLimit()
        .above( <span class="integer">1500</span> )
        .orderedBy( FacetSortOrder.COUNT_DESC )
        .includeZeroCounts( <span class="predefined-constant">false</span> )
        .maxFacetCount( <span class="integer">3</span> )
        .createFacetingRequest();

FullTextQuery fullTextQuery = fullTextEntityManager.createFullTextQuery( qb.all().createQuery(), <span class="predefined-type">Book</span>.class );
fullTextQuery.setMaxResults( <span class="integer">20</span> );

FacetManager facetManager = fullTextQuery.getFacetManager();
facetManager.enableFaceting( priceFacetingRequest );

<span class="predefined-type">List</span> hits = fullTextQuery.getResultList();

<span class="predefined-type">List</span>&lt;Facet&gt; facets = facetManager.getFacets( <span class="string"><span class="delimiter">&quot;</span><span class="content">priceFaceting</span><span class="delimiter">&quot;</span></span> );</code></pre>
</div>
</div>
<div class="paragraph">
<p>It would look like this in Hibernate Search 6:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA">SearchSession session = Search.session( entityManager );

AggregationKey&lt;<span class="predefined-type">Map</span>&lt;Range&lt;<span class="predefined-type">Double</span>&gt;, <span class="predefined-type">Long</span>&gt;&gt; countByPriceRangeKey = AggregationKey.of( <span class="string"><span class="delimiter">&quot;</span><span class="content">countByPriceRange</span><span class="delimiter">&quot;</span></span> );

<span class="predefined-type">SearchResult</span>&lt;<span class="predefined-type">Book</span>&gt; result = searchSession.search( <span class="predefined-type">Book</span>.class )
        .where( f -&gt; f.matchAll() )
        .aggregation( countByPriceRangeKey, f -&gt; f.range()
                .field( <span class="string"><span class="delimiter">&quot;</span><span class="content">price</span><span class="delimiter">&quot;</span></span>, <span class="predefined-type">Double</span>.class )
                .range( Range.lessThan( <span class="float">1000.0</span> ) )
                .range( Range.canonical( <span class="float">1000.0</span>, <span class="float">1500.0</span> ) )
                .range( Range.atLeast( <span class="float">1500.0</span> ) )
                <span class="comment">// Not equivalent to 'orderedBy'</span>
                <span class="comment">// Not equivalent to 'includeZeroCounts'</span>
                <span class="comment">// Not equivalent to 'maxFacetCount'</span>
        .fetch( <span class="integer">20</span> );

<span class="predefined-type">List</span>&lt;<span class="predefined-type">Book</span>&gt; hits = result.hits();

<span class="predefined-type">Map</span>&lt;Range&lt;<span class="predefined-type">Double</span>&gt;, <span class="predefined-type">Long</span>&gt; countByPriceRange = result.aggregation( countByPriceRangeKey );</code></pre>
</div>
</div>
<div class="paragraph">
<p>See <a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#search-dsl-aggregation-range">this section of the documentation</a> for more information.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p><code>orderedBy</code>, <code>includeZeroCounts</code> and <code>maxFacetCount</code> have no equivalent Hibernate Search 6 range aggregations:
all given ranges will always be included in the resulting <code>Map</code>.</p>
</div>
<div class="paragraph">
<p>The behavior of these methods can be implemented by post-processing the <code>Map</code> in user code.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="searching-facets-selectfacets"><a class="anchor" href="#searching-facets-selectfacets"></a>Drill-down with <code>.selectFacets</code></h5>
<div class="paragraph">
<p>In Hibernate Search 5, the <code>.selectFacets</code> method used to allow "drill-down",
i.e. adding a filter to the query to only consider documents in a given facet.</p>
</div>
<div class="paragraph">
<p>Hibernate Search 6 no longer supports this feature directly.</p>
</div>
<div class="paragraph">
<p>To perform a drill-down, create a new query with the original predicate wrapped in a boolean predicate
and add a <a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#search-dsl-predicate-boolean-filter"><code>filter</code> clause</a>
to restrict the hits to the selected facet(s):</p>
</div>
<div class="ulist">
<ul>
<li>
<p>For discrete faceting, use a <a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#search-dsl-predicate-match"><code>match</code> predicate</a>.</p>
</li>
<li>
<p>For range faceting, use a <a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#search-dsl-predicate-range"><code>range</code> predicate</a>.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="error-handler"><a class="anchor" href="#error-handler"></a>Error handler</h3>
<div class="paragraph">
<p>The <code>ErrorHandler</code> interface was replaced with the <code>FailureHandler</code> interface,
and the related configuration properties changed.</p>
</div>
<div class="paragraph">
<p>See <a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#configuration-background-failure-handling">this section of the documentation</a>
for more information about background failure handling.</p>
</div>
<div class="paragraph">
<p>Also, be aware that the <code>MassIndexer</code> now exposes a <code>failureHandler</code> parameter,
to handle failures during mass indexing differently (e.g. report to the web console from which mass indexing was initiated).
More information <a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#configuration-background-failure-handling#mapper-orm-indexing-massindexer-parameters">here</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="full-text-filter"><a class="anchor" href="#full-text-filter"></a>Full-text filter</h3>
<div class="paragraph">
<p>Hibernate Search 6.0 does not support named full-text filters at the moment.
In most cases, you can replace them with static methods.</p>
</div>
<div class="paragraph">
<p>For example, let&#8217;s take this filter from a Hibernate Search 5 application:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="directive">public</span> <span class="type">class</span> <span class="class">SecurityFilterFactory</span> {
    <span class="directive">private</span> <span class="predefined-type">Integer</span> level;

    <span class="comment">/**
     * injected parameter
     */</span>
    <span class="directive">public</span> <span class="type">void</span> setLevel(<span class="predefined-type">Integer</span> level) {
        <span class="local-variable">this</span>.level = level;
    }

    <span class="annotation">@Factory</span>
    <span class="directive">public</span> <span class="predefined-type">Query</span> getFilter() {
        <span class="keyword">return</span> <span class="keyword">new</span> TermQuery( <span class="keyword">new</span> Term( <span class="string"><span class="delimiter">&quot;</span><span class="content">level</span><span class="delimiter">&quot;</span></span>, level.toString() ) );
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="annotation">@Entity</span>
<span class="annotation">@Indexed</span>
<span class="annotation">@FullTextFilterDef</span>(name = <span class="string"><span class="delimiter">&quot;</span><span class="content">security</span><span class="delimiter">&quot;</span></span>, impl = SecurityFilterFactory.class)
<span class="directive">public</span> <span class="type">class</span> <span class="class">Driver</span> {
   <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The filter could be used this way:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA">FullTextEntityManager fullTextEntityManager = Search.getFullTextEntityManager( em );
QueryBuilder qb = fullTextEntityManager.getSearchFactory()
        .buildQueryBuilder().forEntity( <span class="predefined-type">Driver</span>.class ).get();

BooleanJunction junction = qb.bool();
junction.must( qb.all().createQuery() );

<span class="comment">// Not shown: add user predicates to the junction (search terms, etc.).</span>
<span class="comment">// ...</span>

org.apache.lucene.search.Query luceneQuery = junction.createQuery();

FullTextQuery fullTextQuery = fullTextEntityManager.createFullTextQuery( luceneQuery, <span class="predefined-type">Driver</span>.class );
fullTextQuery.setMaxResults( <span class="integer">20</span> );

<span class="comment">// HERE: Enable the filter</span>
fullTextQuery.enableFullTextFilter(<span class="string"><span class="delimiter">&quot;</span><span class="content">security</span><span class="delimiter">&quot;</span></span>).setParameter(<span class="string"><span class="delimiter">&quot;</span><span class="content">level</span><span class="delimiter">&quot;</span></span>, <span class="integer">5</span>);

<span class="predefined-type">List</span> hits = fullTextQuery.getResultList();</code></pre>
</div>
</div>
<div class="paragraph">
<p>In Hibernate Search 6, you can define the filter as a static method:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="directive">public</span> <span class="directive">final</span> <span class="type">class</span> <span class="class">SecurityFilterFactory</span> {
    <span class="directive">private</span> SecurityFilterFactory() {
    }

    <span class="directive">public</span> <span class="directive">static</span> SearchPredicate create(SearchPredicateFactory factory, <span class="type">int</span> level) {
        <span class="keyword">return</span> factory.match().field( <span class="string"><span class="delimiter">&quot;</span><span class="content">level</span><span class="delimiter">&quot;</span></span> ).matching( level.toString() );
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>And then simply add it to the root boolean predicate when searching:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA">SearchSession session = Search.session( entityManager );
<span class="predefined-type">List</span>&lt;<span class="predefined-type">Book</span>&gt; hits = searchSession.search( <span class="predefined-type">Driver</span>.class )
        .where( f -&gt; f.bool( b -&gt; {
            b.must( f.matchAll() );
            <span class="comment">// HERE: Enable the filter</span>
            b.filter( SecurityFilterFactory.create( f, <span class="integer">5</span> ) );

            <span class="comment">// Not shown: add user predicates to the junction (search terms, etc.).</span>
            <span class="comment">// ...</span>
        } ) )
        .fetchHits( <span class="integer">20</span> );</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If you have needs that can be addressed only with named full-text filters,
and cannot be solved with the solution above,
consider upgrading directly to Hibernate Search 6.1,
which provides a similar feature called <a href="https://docs.jboss.org/hibernate/search/6.1/reference/en-US/html_single/#mapper-orm-bridge-named-predicate">named predicates</a>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="factory"><a class="anchor" href="#factory"></a><code>@Factory</code></h3>
<div class="paragraph">
<p>The <code>@Factory</code> annotation does not exist in Hibernate Search 6 anymore.</p>
</div>
<div class="paragraph">
<p>You are encouraged to rely on a proper dependency injection framework if you need such a feature:
just reference the bean name instead of referencing the bean class in your Hibernate Search mapping/configuration.
See <a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#configuration-bean">the section of the documentation about beans in Hibernate Search</a>
for details and supported DI frameworks.</p>
</div>
<div class="paragraph">
<p>If you don&#8217;t use a dependency injection framework,
here are details on how to migrate:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">String bridges, field bridges, class bridges</dt>
<dd>
<p>Use their <code>*Binder</code> equivalent in Hibernate Search 6,
which can act as a factory:
<a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#mapper-orm-bridge-valuebridge-valuebinder"><code>ValueBinder</code></a>,
<a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#mapper-orm-bridge-propertybridge"><code>PropertyBinder</code></a>,
<a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#mapper-orm-bridge-typebridge"><code>TypeBinder</code></a>.</p>
</dd>
<dt class="hdlist1">Full-text filters</dt>
<dd>
<p>These no longer exist in Hibernate Search 6.
See <a href="#full-text-filter">Full-text filter</a>.</p>
</dd>
<dt class="hdlist1">Programmatic mapping</dt>
<dd>
<p><code>@Factory</code> is no longer needed for the programmatic mapping,
since you will pass a callback (<a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#mapper-orm-programmatic-mapping"><code>HibernateOrmSearchMappingConfigurer</code></a>)
instead of passing the mapping directly.
Whatever code was implemented in your factory can be moved to the configurer.</p>
</dd>
<dt class="hdlist1">Analysis definition providers</dt>
<dd>
<p>Analysis definition providers <a href="#analysis-definition-provider">are now called analysis configurers</a>,
and as they are just callbacks that are used only once,
the <code>@Factory</code> annotation should not be necessary.
Whatever code was implemented in your factory can be moved to the configurer.</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="searchexception"><a class="anchor" href="#searchexception"></a><code>SearchException</code></h3>
<div class="paragraph">
<p><code>org.hibernate.search.exception.SearchException</code> has moved to <code>org.hibernate.search.util.common.SearchException</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="sharding"><a class="anchor" href="#sharding"></a>Sharding: <code>IndexShardingStrategy</code>/<code>ShardIdentifierProvider</code>/<code>ShardIdentifierProviderTemplate</code></h3>
<div class="paragraph">
<p>Static sharding is still available in Hibernate Search 6,
but it works differently, so the Hibernate Search 5 APIs are no longer available.
To implement static sharding in Hibernate Search 6,
refer to <a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#concepts-sharding-routing">this section of the documentation</a>.</p>
</div>
<div class="paragraph">
<p>Dynamic sharding is no longer available in Hibernate Search 6.
If your application absolutely requires it,
<a href="https://hibernate.org/community">contact us</a> so we can discuss how to best address your needs,
or drop a comment <a href="https://hibernate.atlassian.net/browse/HSEARCH-3313">here</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="searchfactory"><a class="anchor" href="#searchfactory"></a><a id="_searchfactory"></a> <code>SearchFactory</code></h3>
<div class="sect3">
<h4 id="searchfactory-basics"><a class="anchor" href="#searchfactory-basics"></a>Basics</h4>
<div class="paragraph">
<p>The equivalent to Hibernate Search 5&#8217;s <code>SearchFactory</code> is Hibernate Search 6&#8217;s <code>SearchMapping</code>,
but some operations are more conveniently accessible directly from <code>SearchSession</code>.</p>
</div>
<div class="paragraph">
<p>Here is how to retrieve the <code>SessionFactory</code> in Hibernate Search 5:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA">SearchFactory searchFactory = Search.getFullTextEntityManager( entityManager ).getSearchFactory();
<span class="comment">// Alternatively</span>
searchFactory = Search.getFullTextSession( session ).getSearchFactory();</code></pre>
</div>
</div>
<div class="paragraph">
<p>The main entry point to Hibernate Search APIs is still named <code>Search</code>, but it moved to another package:
<code>org.hibernate.search.mapper.orm.Search</code>.
Here is how to retrieve the <code>SearchMapping</code> in Hibernate Search 6:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA">SearchMapping mapping = Search.mapping( entityManagerFactory );
<span class="comment">// Alternatively</span>
mapping = Search.mapping( sessionFactory );
mapping = Search.mapping( entityManager.getEntityManagerFactory() );
mapping = Search.mapping( session.getSessionFactory() );</code></pre>
</div>
</div>
<div class="paragraph">
<p>See the following sections for the exact equivalent of each operation of <code>SearchFactory</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="searchfactory-optimize"><a class="anchor" href="#searchfactory-optimize"></a>Merging segments: <code>SearchFactory.optimize()</code>/<code>SearchFactory.optimize(&#8230;&#8203;)</code></h4>
<div class="paragraph">
<p>In Hibernate Search 5:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA">SearchFactory searchFactory = Search.getFullTextSession( session ).getSearchFactory();

searchFactory.optimize( <span class="predefined-type">Book</span>.class );
<span class="comment">// or</span>
searchFactory.optimize();</code></pre>
</div>
</div>
<div class="paragraph">
<p>Equivalent in Hibernate Search 6:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA">SearchSession searchSession = Search.session( session );

searchSession.workspace( <span class="predefined-type">Book</span>.class ).mergeSegments();
<span class="comment">// or</span>
searchSession.workspace().mergeSegments();</code></pre>
</div>
</div>
<div class="paragraph">
<p>See <a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#mapper-orm-indexing-manual-largescale">this section of the documentation</a>
for more information.</p>
</div>
</div>
<div class="sect3">
<h4 id="searchfactory-getanalyzer"><a class="anchor" href="#searchfactory-getanalyzer"></a>Getting Lucene analyzers: <code>SearchFactory.getAnalyzer(&#8230;&#8203;)</code></h4>
<div class="paragraph">
<p>In Hibernate Search 5:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA">SearchFactory searchFactory = Search.getFullTextSession( session ).getSearchFactory();

<span class="comment">// Get a named analyzer</span>
Analyzer analyzer = searchFactory.getAnalyzer( <span class="string"><span class="delimiter">&quot;</span><span class="content">customanalyzer</span><span class="delimiter">&quot;</span></span> );

<span class="comment">// Get the search analyzer for a given indexed type</span>
Analyzer searchAnalyzer = searchFactory.getAnalyzer( <span class="predefined-type">Book</span>.class );</code></pre>
</div>
</div>
<div class="paragraph">
<p>Equivalent in Hibernate Search 6:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA">SearchMapping mapping = Search.mapping( entityManagerFactory );
<span class="comment">// Alternatively</span>
mapping = Search.mapping( entityManager.getEntityManagerFactory() );

<span class="comment">// Get a named analyzer</span>
Optional&lt;? <span class="directive">extends</span> Analyzer&gt; analyzer = mapping.backend().unwrap( LuceneBackend.class )
        .analyzer( <span class="string"><span class="delimiter">&quot;</span><span class="content">customanalyzer</span><span class="delimiter">&quot;</span></span> );

<span class="comment">// Get the search analyzer for a given indexed type</span>
Analyzer searchAnalyzer = mapping.indexedEntity( <span class="predefined-type">Book</span>.class ).indexManager()
        .unwrap( LuceneIndexManager.class ).searchAnalyzer();

<span class="comment">// Get the search analyzer for a given index</span>
Analyzer searchAnalyzer = mapping.indexexManager( <span class="string"><span class="delimiter">&quot;</span><span class="content">Book</span><span class="delimiter">&quot;</span></span> ).indexManager()
        .unwrap( LuceneIndexManager.class ).searchAnalyzer();</code></pre>
</div>
</div>
<div class="paragraph">
<p>See <a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#backend-lucene-access-analyzers">this section of the documentation</a>
for more information.</p>
</div>
</div>
<div class="sect3">
<h4 id="searchfactory-buildquerybuilder"><a class="anchor" href="#searchfactory-buildquerybuilder"></a>Building queries: <code>SearchFactory.buildQueryBuilder()</code></h4>
<div class="paragraph">
<p>See <a href="#queries"><code>org.apache.lucene.search.Query</code> &#8658; <code>SearchPredicate</code></a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="searchfactory-getstatistics"><a class="anchor" href="#searchfactory-getstatistics"></a>Statistics: <code>SearchFactory.getStatistics()</code></h4>
<div class="paragraph">
<p>Hibernate Search 6 does not provide statistics at the moment.</p>
</div>
<div class="paragraph">
<p>The current plans are to implement support for tracing in a future release
(<a href="https://hibernate.atlassian.net/browse/HSEARCH-4057">HSEARCH-4057</a>).
This would provide a more powerful solution to users looking for insight into the behavior of their application.</p>
</div>
<div class="paragraph">
<p>If you need this feature urgently, we&#8217;ll gladly help anyone interested in contributing a patch:
feel free to <a href="https://hibernate.org/community">contact us</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="searchfactory-getindexreaderaccessor"><a class="anchor" href="#searchfactory-getindexreaderaccessor"></a>Accessing Lucene index readers: <code>SearchFactory.getIndexReaderAccessor</code></h4>
<div class="paragraph">
<p>Hibernate Search 6.0 does not provide direct access to the index reader.</p>
</div>
<div class="paragraph">
<p>If you need direct access to an index reader,
consider upgrading directly to Hibernate Search 6.1,
which provides <a href="https://docs.jboss.org/hibernate/search/6.1/reference/en-US/html_single/#_retrieving_a_lucene_indexreader">just that feature</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="metamodel"><a class="anchor" href="#metamodel"></a>Metamodel: <code>SearchFactory.getIndexedTypeDescriptor</code>, <code>SearchFactory.getIndexedTypes</code></h4>
<div class="paragraph">
<p>The metamodel is still available in Hibernate Search 6,
but through different API calls.
See <a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#mapper-orm-mapping-inspect">this section of the documentation</a> for more information.</p>
</div>
<div class="paragraph">
<p>In Hibernate Search 6, the metamodel includes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>General information about indexed types (entity type, JPA entity name)</p>
</li>
<li>
<p>Detailed information about the indexes and all their declared fields.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Compared to Hibernate Search 5, it <strong>no longer</strong> includes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Detailed information about indexed types and their annotated properties.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="searchfactory-getindexfamily"><a class="anchor" href="#searchfactory-getindexfamily"></a>Accessing the Elasticsearch client: <code>SearchFactory.getIndexFamily</code></h4>
<div class="paragraph">
<p>The main purpose of <code>getIndexFamily</code> in Hibernate Search 5 was to access the Elasticsearch REST client.</p>
</div>
<div class="paragraph">
<p>See <a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#backend-elasticsearch-access-client">this section of the documentation</a>
for an equivalent solution in Hibernate Search 6.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="massindexer"><a class="anchor" href="#massindexer"></a><code>MassIndexer</code></h3>
<div class="sect3">
<h4 id="massindexer-basics"><a class="anchor" href="#massindexer-basics"></a>Basics</h4>
<div class="paragraph">
<p>The <code>MassIndexer</code> mostly stays the same in Hibernate Search 6, but it moved to a different package:
<code>org.hibernate.search.mapper.orm.massindexing.MassIndexer</code>.</p>
</div>
<div class="paragraph">
<p>Here is how to retrieve and use a <code>MassIndexer</code> in Hibernate Search 5:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA">FullTextSession fullTextSession = Search.getFullTextSession( session );
fullTextSession.createIndexer().startAndWait();
<span class="comment">// or</span>
fullTextSession.createIndexer( <span class="predefined-type">Book</span>.class, Author.class ).startAndWait();</code></pre>
</div>
</div>
<div class="paragraph">
<p>Here is how to retrieve and use a <code>MassIndexer</code> in Hibernate Search 6:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA">SearchSession searchSession = Search.session( entityManager );
searchSession.massIndexer().startAndWait();
<span class="comment">// or</span>
searchSession.massIndexer( <span class="predefined-type">Book</span>.class, Author.class ).startAndWait();</code></pre>
</div>
</div>
<div class="paragraph">
<p>Most mass indexing parameters stayed the same;
see the following sections for the exact equivalent of parameters that changed.</p>
</div>
<div class="paragraph">
<p>See <a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#mapper-orm-indexing-massindexer">this section of the documentation</a>
for more information about the mass indexer.</p>
</div>
</div>
<div class="sect3">
<h4 id="massindexer-optimizeonfinish"><a class="anchor" href="#massindexer-optimizeonfinish"></a><code>MassIndexer.optimizeOnFinish(&#8230;&#8203;)</code></h4>
<div class="paragraph">
<p>The equivalent method in Hibernate Search 6 is <code>MassIndexer.mergeSegmentsOnFinish(&#8230;&#8203;)</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="massindexer-optimizeafterpurge"><a class="anchor" href="#massindexer-optimizeafterpurge"></a><code>MassIndexer.optimizeAfterPurge(&#8230;&#8203;)</code></h4>
<div class="paragraph">
<p>The equivalent method in Hibernate Search 6 is <code>MassIndexer.mergeSegmentsAfterPurge(&#8230;&#8203;)</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="massindexer-progressmonitor"><a class="anchor" href="#massindexer-progressmonitor"></a><code>MassIndexer.progressMonitor(&#8230;&#8203;)</code></h4>
<div class="paragraph">
<p>The equivalent method in Hibernate Search 6 is <code>MassIndexer.monitor(&#8230;&#8203;)</code>.
Instead of expecting an instance of <code>MassIndexerProgressMonitor</code>,
it expects an instance of <code>MassIndexingMonitor</code>,
which is largely the same except that all methods take <code>long</code> arguments instead of <code>int</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="massindexer-threadsforsubsequentfetching"><a class="anchor" href="#massindexer-threadsforsubsequentfetching"></a><code>MassIndexer.threadsForSubsequentFetching(&#8230;&#8203;)</code></h4>
<div class="paragraph">
<p>This method was deprecated in Hibernate Search 5 and didn&#8217;t do anything.</p>
</div>
<div class="paragraph">
<p>It is no longer available in Hibernate Search 6.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="jsr352"><a class="anchor" href="#jsr352"></a>Batch (JSR-352) integration</h3>
<div class="paragraph">
<p>The mass indexing Batch (JSR-352) job mostly stays the same in Hibernate Search 6,
but <code>MassIndexingJob</code> moved to a different package:
<code>org.hibernate.search.batch.jsr352.core.massindexing.MassIndexingJob</code>.</p>
</div>
<div class="paragraph">
<p>See <a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#mapper-orm-indexing-jsr352">this section of the documentation</a>
for more information about the JSR-352 integration.</p>
</div>
<div class="paragraph">
<p>See the table below for the exact equivalent of parameters that changed.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 1. Job Parameters in JSR 352 Integration that changed in Hibernate Search 6</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Hibernate Search 5</th>
<th class="tableblock halign-left valign-top">Hibernate Search 6</th>
<th class="tableblock halign-left valign-top">Comment</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>optimizeAfterPurge</code>, <code>optimizeAfterPurge(boolean)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>mergeSegmentsAfterPurge</code>, <code>mergeSegmentsAfterPurge(boolean)</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>optimizeOnFinish</code>, <code>optimizeOnFinish(boolean)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>mergeSegmentsOnFinish</code>, <code>mergeSegmentsOnFinish(boolean)</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>restrictedBy(Criterion)</code> (<code>MassIndexingJob</code> parameter builder only)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>customQueryHQL</code>, <code>restrictedBy(String)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Using Hibernate ORM criteria is no longer supported.
Use HQL / JPQL instead.</p>
<p class="tableblock">See <a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#jsr-352-indexing-mode">this section of the documentation</a> for more details and limitations.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="spi"><a class="anchor" href="#spi"></a>SPI changes</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Due to the extensive rewrites involved in Hibernate Search 6,
existing integrations relying on Hibernate Search 5 are likely to require a full rewrite.</p>
</div>
<div class="paragraph">
<p>We will be glad to help, so feel free to <a href="https://hibernate.org/community">contact us</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="behavior"><a class="anchor" href="#behavior"></a>Behavior changes</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="behavior-default-bridge-java-util-class"><a class="anchor" href="#behavior-default-bridge-java-util-class"></a><a id="_no_default_bridge_for_java_util_class"></a> No default bridge for <code>java.util.Class</code></h3>
<div class="paragraph">
<p>There is no longer a builtin, default bridge for <code>java.util.Class</code>.</p>
</div>
<div class="paragraph">
<p>If you need to index a <code>Class&lt;?&gt;</code>, you will need to implement a
<a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#mapper-orm-bridge-valuebridge">custom bridge</a>
(probably from <code>Class</code> to <code>String</code>).</p>
</div>
<div class="paragraph">
<p>Optionally, you can also register your custom bridge as a
<a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#mapper-orm-bridge-resolver">default bridge</a>
so that it is applied automatically and transparently to all fields defined on properties of type <code>Class</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="document-id-is-not-a-field"><a class="anchor" href="#document-id-is-not-a-field"></a>The document ID is not an index field</h3>
<div class="paragraph">
<p>Hibernate Search 5 used to create an index field for document IDs,
which could then be queried using the query DSL in particular:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="annotation">@Indexed</span>
<span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">MyEntity</span> {

    <span class="annotation">@Id</span> <span class="comment">// Implicitly creates a String field named &quot;id&quot;</span>
    <span class="directive">public</span> <span class="predefined-type">Integer</span> id;

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In Hibernate Search 6, this is no longer the case.
The identifier "field" is internal, and is not named after the entity property it originates from.</p>
</div>
<div class="paragraph">
<p>If you want to use the identifier as a field:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>For exact matches, consider the new <a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#search-dsl-predicate-id"><code>id</code> predicate</a></p>
</li>
<li>
<p>For any other reason (sorts, aggregations, non-exact matches, &#8230;&#8203;),
declare a field explicitly by annotating the identifier property with
<a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#mapper-orm-directfieldmapping"><code>@GenericField</code> or a similar annotation</a>.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="indexed-is-inherited"><a class="anchor" href="#indexed-is-inherited"></a><code>@Indexed</code> is inherited</h3>
<div class="paragraph">
<p>In Hibernate Search 5, <code>@Indexed</code> was not inherited by subclasses;
the following configuration would result in instances of <code>MyEntity</code> being indexed,
but not instances of <code>MySubClassEntity</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="annotation">@Indexed</span>
<span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">MyEntity</span> {
    <span class="comment">// ...</span>
}

<span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">MySubClassEntity</span> <span class="directive">extends</span> MyEntity {
    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In Hibernate Search 6, <code>@Indexed</code> <strong>is</strong> inherited by subclasses;
the configuration above would result in instances of both <code>MyEntity</code> and <code>MySubClassEntity</code> being indexed,
though in different indexes.
A search query on type <code>MyEntity</code> will return instances of both <code>MyEntity</code> and <code>MySubClassEntity</code>,
in accordance with the <a href="https://en.wikipedia.org/wiki/Liskov_substitution_principle">Liskov substitution principle</a>.</p>
</div>
<div class="paragraph">
<p>To prevent <code>MySubClassEntity</code> from being indexed, annotate it with <code>@Indexed(enabled = false)</code>;
this will restore the Hibernate Search 5 behavior:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="annotation">@Indexed</span>
<span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">MyEntity</span> {
    <span class="comment">// ...</span>
}

<span class="annotation">@Indexed</span>(enabled = <span class="predefined-constant">false</span>)
<span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">MySubClassEntity</span> <span class="directive">extends</span> MyEntity {
    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="index-exclusive"><a class="anchor" href="#index-exclusive"></a>One index &#8658; one type</h3>
<div class="paragraph">
<p>In Hibernate Search 5, it used to be possible to store multiple entity types in the same index.</p>
</div>
<div class="paragraph">
<p>In Hibernate Search 6, each type must have its own dedicated index.
Annotating two distinct types with <code>@Indexed(index = "my-index")</code> (the same index name)
will lead to a bootstrap failure.</p>
</div>
</div>
<div class="sect2">
<h3 id="index-name-defaults-to-entity-name"><a class="anchor" href="#index-name-defaults-to-entity-name"></a>The index name defaults to the entity name</h3>
<div class="paragraph">
<p>In Hibernate Search 5, the default name of the index for a given entity when <code>@Indexed.index</code> was not set
was the fully-qualified class name, so the following mapping resulted in an index named <code>com.mycompany.MyEntity1</code>
and another named <code>com.mycompany.MyEntity2</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="keyword">package</span> <span class="namespace">com.mycompany</span>;

<span class="annotation">@Indexed</span>
<span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">MyEntity1</span> {
    <span class="comment">// ...</span>
}

<span class="annotation">@Indexed</span>
<span class="annotation">@Entity</span>(name = <span class="string"><span class="delimiter">&quot;</span><span class="content">MyEntityTwo</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">MyEntity2</span> {
    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In Hibernate Search 6, the default name of the index in that case is the JPA entity name,
so the mapping above results in an index named simply <code>MyEntity1</code> and another named <code>MyEntityTwo</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="indexnullas-is-for-indexing"><a class="anchor" href="#indexnullas-is-for-indexing"></a><code>indexNullAs</code> is irrelevant when building predicates and when projecting</h3>
<div class="paragraph">
<p>In Hibernate Search 5, when a field was configured with <a href="#field-indexnullas"><code>indexNullAs</code></a>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>passing <code>null</code> as the value to match for a query created through the Search DSL
would automatically translate to the null token.</p>
</li>
<li>
<p>projecting on a field whose value is equal to the configured null token would return <code>null</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In Hibernate Search 6, this is no longer the case:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>passing <code>null</code> as the value to match for a predicate created through the Search DSL
will throw an exception (since <code>null</code> is not indexed, only the corresponding null token is).</p>
</li>
<li>
<p>projecting on a field whose value is equal to the configured null token
will return that null token
(since Hibernate Search can&#8217;t tell whether the indexed value was <code>null</code> or just happened to be equal to the null token).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If this behavior is not acceptable, consider dropping the <code>indexNullAs</code> option
and relying on the <a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#search-dsl-predicate-exists"><code>exists</code> predicate</a>
to search for documents that have or don&#8217;t have a value for a given field.</p>
</div>
</div>
<div class="sect2">
<h3 id="faceting-strings-are-normalized"><a class="anchor" href="#faceting-strings-are-normalized"></a>Faceting returns normalized strings</h3>
<div class="paragraph">
<p>In Hibernate Search 5, a terms aggregation on a field with a normalizer used to return raw (non-normalized) values.</p>
</div>
<div class="paragraph">
<p>In Hibernate Search 6, the same aggregation on this normalized field will return normalized values.</p>
</div>
</div>
<div class="sect2">
<h3 id="automatic-indexing-across-associations-by-default"><a class="anchor" href="#automatic-indexing-across-associations-by-default"></a><code>@IndexedEmbedded</code> on an association enables reindexing when the target entity changes by default</h3>
<div class="paragraph">
<p>In Hibernate Search 5, automatic reindexing was only triggered by changes to the indexed entity by default:
if you were to add <code>@IndexedEmbedded(includePaths = "name")</code> to an association from entity <code>A</code> to another entity <code>B</code>,
then calling <code>a.setB(&#8230;&#8203;)</code> would lead to reindexing of <code>a</code>,
but calling <code>a.getB().setName("a new name")</code> would not.
In order to make sure that changes to <code>B.name</code> automatically trigger reindexing of the associated <code>A</code>,
you had to mark the inverse side of the association, <code>B.a</code>, with the <code>@ContainedIn</code> annotation.</p>
</div>
<div class="paragraph">
<p>This behavior changed in Hibernate Search 6:
in the example above, Hibernate Search 6 would automatically trigger reindexing of <code>B.a</code> when <code>B.name</code> is modified,
<strong>without</strong> the need of applying a <a href="#containedin"><code>@ContainedIn</code></a> annotation.</p>
</div>
<div class="paragraph">
<p>This means that automatic indexing is "safe" by default: whenever you apply <code>@IndexedEmbedded</code> to an association,
Hibernate Search will automatically resolve the inverse side of that association
and will make sure that any change in "indexed-embedded" entities lead to reindexing of affected indexed entities.</p>
</div>
<div class="paragraph">
<p>This also means that Hibernate Search 6 needs to know the inverse side of associations annotated with <code>@IndexedEmbedded</code>.
If it can&#8217;t resolve it (for example when an <code>@IndexedEmbedded</code> association has no inverse side),
Hibernate Search 6 will raise errors at bootstrap, looking like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Unable to find the inverse side of the association on type 'A' at path '.b&lt;no value extractors&gt;'
Hibernate Search needs this information in order to reindex 'A' when 'B' is modified.
You can solve this error by defining the inverse side of this association,
either with annotations specific to your integration
(@OneToMany(mappedBy = ...) in Hibernate ORM)
or with the Hibernate Search @AssociationInverseSide annotation.
Alternatively, if you do not need to reindex 'A' when 'B' is modified,
you can disable automatic reindexing with
@IndexingDependency(reindexOnUpdate = ReindexOnUpdate.SHALLOW).</pre>
</div>
</div>
<div class="paragraph">
<p>The error message already explains the potential solutions,
but here is a perhaps clearer explanation of each solution
in the context of migrating Hibernate Search 5 applications:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Add an inverse side to the assocation in <code>B</code>: <code>@OneToMany(mappedBy = &#8230;&#8203;) List&lt;A&gt; a</code>
or <code>@OneToOne(mappedBy = &#8230;&#8203;) A a</code> or <code>@ManyToMany(mappedBy = &#8230;&#8203;) List&lt;A&gt; a</code>.
This is obviously only practical if <code>B.a</code> has a reasonably low cardinality
(a few dozens instances of <code>A</code> for a given <code>B</code>).</p>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Make sure to
<a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#mapper-orm-indexing-automatic-concepts-session-consistency">always update both sides of the association when you change it</a>!
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In some rare situations, the inverse side of the association cannot be expressed with <code>mappedBy</code>;
in this case, you can use <a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#mapper-orm-reindexing-associationinverseside"><code>@AssociationInverseSide</code></a>,
an annotation specific to Hibernate Search.</p>
</div>
</li>
<li>
<p>Annotate the <code>@IndexedEmbedded</code> association with <code>@IndexingDependency(reindexOnUpdate = ReindexOnUpdate.SHALLOW)</code>,
which will restore the behavior of Hibernate Search 5 when <code>@ContainedIn</code> was not used.
This is particularly useful when the association is massive and highly asymmetric
(e.g. hundreds or more instances of <code>A</code> for just a dozen instances of <code>B</code>)
and <code>B</code> is not expected to change (reference data, e.g. a <code>Country</code> entity).</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>For more information, refer to <a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#mapper-orm-reindexing">Tuning automatic reindexing</a>,
in particular <a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#mapper-orm-reindexing-reindexonupdate">this section for shallow reindexing</a>
and <a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#mapper-orm-reindexing-associationinverseside">this section for specifying the inverse side of an association</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="indexed-transient-requires-configuration"><a class="anchor" href="#indexed-transient-requires-configuration"></a>Indexed, <code>@Transient</code> properties require additional configuration</h3>
<div class="paragraph">
<p>In Hibernate Search 5, when a <code>@Transient</code> property was mapped to an index field,
Hibernate Search would switch to a "non-optimized" mode where reindexing was triggered for any change in the same entity,
assuming that the transient property value was computed from other properties of the same entity.
This would work fine in some cases, but could lead to unnecessary reindexing when unrelated properties were modified
and to out-of-sync indexes when the transient property was computed from data extracted from associated entities.</p>
</div>
<div class="paragraph">
<p>This behavior changed in Hibernate Search 6:
if a <code>@Transient</code> property is mapped to an index field,
Hibernate Search will trigger a bootstrap failure asking for additionnal configuration.</p>
</div>
<div class="paragraph">
<p>The "right" solution in that case is to put an annotation on the transient property,
to explain which properties are used to derive the value of the transient property:
<code>@IndexingDependency(derivedFrom = &#8230;&#8203;)</code>.
You can find more information in
<a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#mapper-orm-reindexing-derivedfrom">this section of the documentation</a>.</p>
</div>
<div class="paragraph">
<p>Alternatively, if you do not care about automatic reindexing when the transient property changes,
then you can just disable automatic reindexing for this property with <code>@IndexingDependency(reindexOnUpdate = ReindexOnUpdate.NO)</code>.
See <a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#mapper-orm-reindexing-reindexonupdate-no">this section of the documentation</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="implicit-container-extraction"><a class="anchor" href="#implicit-container-extraction"></a>Container extraction for <code>@*Field</code> is implied</h3>
<div class="paragraph">
<p>In Hibernate Search 6, when a <code>@*Field</code> annotation is applied on a property of a container type,
the field will work on container <strong>elements</strong> by default, not on the container itself.</p>
</div>
<div class="paragraph">
<p>For example, the following mapping will create a <code>String</code> field,
and Hibernate Search will index each element of the <code>List</code> in the <code>notes</code> index field:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="annotation">@FullTextField</span>
<span class="annotation">@ElementCollection</span>
<span class="directive">private</span> <span class="predefined-type">List</span>&lt;<span class="predefined-type">String</span>&gt; notes;</code></pre>
</div>
</div>
<div class="paragraph">
<p>This should be kept in mind when migrating custom bridges that work on container types.
For example, the following mapping likely won&#8217;t work, because <code>MyListBridge</code> expects values of type <code>List</code>, not <code>String</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="annotation">@GenericField</span>(valueBridge = <span class="annotation">@ValueBridgeRef</span>(type = MyListBridge.class)) <span class="comment">// Will not work</span>
<span class="annotation">@ElementCollection</span>
<span class="directive">private</span> <span class="predefined-type">List</span>&lt;<span class="predefined-type">String</span>&gt; notes;</code></pre>
</div>
</div>
<div class="paragraph">
<p>To disable the automatic extraction of container element (and get back to the Hibernate Search 5 behavior),
use <code>extraction = @ContainerExtraction(extract = ContainerExtract.NO)</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="annotation">@GenericField</span>(valueBridge = <span class="annotation">@ValueBridgeRef</span>(type = MyListBridge.class),
        extraction = <span class="annotation">@ContainerExtraction</span>(extract = ContainerExtract.NO)) <span class="comment">// Will work</span>
<span class="annotation">@ElementCollection</span>
<span class="directive">private</span> <span class="predefined-type">List</span>&lt;<span class="predefined-type">String</span>&gt; notes;</code></pre>
</div>
</div>
<div class="paragraph">
<p>See <a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#mapper-orm-containerextractor">this section of the documentation</a>
for more information.</p>
</div>
</div>
<div class="sect2">
<h3 id="more-numeric-by-default"><a class="anchor" href="#more-numeric-by-default"></a>More fields are numeric by default</h3>
<div class="paragraph">
<p>Fields of type <code>Boolean</code>, <code>boolean</code>, <code>Short</code>, <code>short</code>, <code>Byte</code> and <code>byte</code>
used to be indexed as string values by default in Hibernate Search 5,
but are indexed as numeric values by default in Hibernate Search 6.</p>
</div>
<div class="paragraph">
<p>Similarly, fields created to represent the embedded identifier when using <code>@IndexedEmbedded.includeEmbeddedObjectId</code>
used to be string fields, unless annotated with <code>@NumericField</code>.
The behavior changed in Hibernate Search 6:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If the embedded entity&#8217;s document identifier has a custom identifier bridge (<code>@DocumentId(identifierBridge = &#8230;&#8203;)</code>),
then the field representing the embedded identifier will be a string field.</p>
</li>
<li>
<p>Otherwise, the field representing the embedded identifier will be assigned a type by the default value bridge
for its type.
This means in particular that a <code>Long</code> embedded identifier will be represented by a <code>Long</code> embedded field,
an <code>Instant</code> embedded identifier will be represented by an <code>Instant</code> embedded field,
etc.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="scrolling-forward-only"><a class="anchor" href="#scrolling-forward-only"></a>Scrolling is forward-only</h3>
<div class="paragraph">
<p>When using a <code>Query</code> that is an <a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#search-dsl-query-object">adapter to a Hibernate Search query</a>,
the <code>ScrollableResults</code> returned by <code>Query.scroll()</code>/<code>Query.scroll(ScrollMode)</code>
is now always forward-only;
trying to move the cursor backward will lead to an exception being thrown.</p>
</div>
</div>
<div class="sect2">
<h3 id="scrolling-iterate-batch-loading"><a class="anchor" href="#scrolling-iterate-batch-loading"></a>Scrolling/<code>Query.iterate()</code> load entities eagerly in batches</h3>
<div class="paragraph">
<p>When using a <code>Query</code> that is an <a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#search-dsl-query-object">adapter to a Hibernate Search query</a>,
the <code>ScrollableResults</code> returned by <code>Query.scroll()</code>/<code>Query.scroll(ScrollMode)</code>,
as well as the <code>iterate()</code> method,
no longer load entities lazily as late as possible:
instead, entities are loaded in batches under the hood.</p>
</div>
<div class="paragraph">
<p>This is important in particular if you clear the session,
as you might clear an entity that was already loaded as part of the current batch,
which could result in a <code>LazyInitializationException</code> being thrown upon accessing that entity.</p>
</div>
<div class="paragraph">
<p>You can control the size of batches by
<a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#search-dsl-query-fetch-size">configuring the loading fetch size</a>
or <a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#search-dsl-query-fetching-results-scrolling">scrolling through Hibernate Search&#8217;s own APIs</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="sort-missing-values-last-by-default"><a class="anchor" href="#sort-missing-values-last-by-default"></a>When sorting by field value or distance, missing values are last by default</h3>
<div class="paragraph">
<p>In Hibernate Search 5, sorts involving missing values used to assume a default value depending on the field type,
e.g. <code>0</code> for numeric types.
As a result, a document whose field does not have a value could end up first,
or right in the middle of other documents after a sort.</p>
</div>
<div class="paragraph">
<p>In Hibernate Search 6, a document whose field does not have a value always ends up at the very end by default.
This behavior <a href="https://docs.jboss.org/hibernate/search/6.0/reference/en-US/html_single/#search-dsl-sort-common-missing">can be customized when defining the sort</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="query-logging-trace"><a class="anchor" href="#query-logging-trace"></a>Logger <code>org.hibernate.search.query</code> uses the <code>TRACE</code> level</h3>
<div class="paragraph">
<p>Hibernate Search logs all executed search queries to logger <code>org.hibernate.search.query</code>.</p>
</div>
<div class="paragraph">
<p>In Hibernate Search 5, these logs were at the <code>DEBUG</code> level.
In Hibernate Search 5, they are at the <code>TRACE</code> level.</p>
</div>
</div>
<div class="sect2">
<h3 id="default-similarity"><a class="anchor" href="#default-similarity"></a>The default similarity for Lucene is now BM25</h3>
<div class="paragraph">
<p>The default similarity for the Lucene backend is now <code>BM25Similarity</code>, instead of <code>ClassicSimilarity</code> in Hibernate Search 5.</p>
</div>
<div class="paragraph">
<p>If necessary, you can force the <code>ClassicSimilarity</code>
through an <a href="#analysis-definition-provider">analysis definition provider</a>.</p>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2022-08-23 13:21:23 UTC
</div>
</div>
<!-- HibernateDoc.OutdatedContent -->
<script src="//code.jquery.com/jquery-3.1.0.min.js" integrity="sha256-cCueBR6CsyA4/9szpPfrX3s49M9vUU5BgtiJj06wt/s=" crossorigin="anonymous"></script>
<script src="/hibernate/_outdated-content/outdated-content.js" type="text/javascript"></script>
<script type="text/javascript">var jQuery_3_1 = $.noConflict(true); jQuery_3_1(document).ready(function() { HibernateDoc.OutdatedContent.install('search'); });</script>
<!-- /HibernateDoc.OutdatedContent -->

<!-- Dynamic TOC -->
<!-- Source: https://github.com/asciidoctor/asciidoctor/issues/699#issuecomment-321066006 -->
<script src="script/tocbot-3.0.2/tocbot.min.js"></script>
<script>
    /* Tocbot dynamic TOC, works with tocbot 3.0.2 */
    /* Source: https://github.com/asciidoctor/asciidoctor/issues/699#issuecomment-321066006
     * Adapted to auto-detect the heading selector.
     */
    var oldtoc = document.getElementById('toctitle').nextElementSibling;

    var headingSelectorVal;
    if (oldtoc.querySelector('.sectlevel5')) {
        headingSelectorVal = 'h1, h2, h3, h4, h5, h6'
    }
    else if (oldtoc.querySelector('.sectlevel4')) {
        headingSelectorVal = 'h1, h2, h3, h4, h5'
    }
    else if (oldtoc.querySelector('.sectlevel3')) {
        headingSelectorVal = 'h1, h2, h3, h4'
    }
    else if (oldtoc.querySelector('.sectlevel2')) {
        headingSelectorVal = 'h1, h2, h3'
    }
    else if (oldtoc.querySelector('.sectlevel1')) {
        headingSelectorVal = 'h1, h2'
    }
    else {
        // In case something went wrong
        headingSelectorVal = 'h1, h2, h3, h4'
    }

    var newtoc = document.createElement('div');
    newtoc.setAttribute('id', 'tocbot');
    newtoc.setAttribute('class', 'js-toc');
    oldtoc.parentNode.replaceChild(newtoc, oldtoc);
    tocbot.init({ contentSelector: '#content',
        headingSelector: headingSelectorVal,
        smoothScroll: false });
    var handleTocOnResize = function() {
        var width = window.innerWidth
                    || document.documentElement.clientWidth
                    || document.body.clientWidth;
        if (width < 768) {
            tocbot.refresh({ contentSelector: '#content',
                headingSelector: headingSelectorVal,
                collapseDepth: 6,
                activeLinkClass: 'ignoreactive',
                throttleTimeout: 1000,
                smoothScroll: false });
        }
        else {
            tocbot.refresh({ contentSelector: '#content',
                headingSelector: headingSelectorVal,
                smoothScroll: false });
        }
    };
    window.addEventListener('resize', handleTocOnResize);
    handleTocOnResize();
</script>
<!-- /Dynamic TOC -->
</body>
</html>