<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.4">
<meta name="author" content="Hardy Ferentschik, Gunnar Morling">
<title>Hibernate Validator 5.4.3.Final - JSR 349 Reference Implementation: Reference Guide</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | http://asciidoctor.org */
/* Remove comment around @import statement below when using as a custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block}
audio,canvas,video{display:inline-block}
audio:not([controls]){display:none;height:0}
[hidden],template{display:none}
script{display:none!important}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
body{margin:0}
a{background:transparent}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
input[type="search"]{-webkit-appearance:textfield;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;box-sizing:content-box}
input[type="search"]::-webkit-search-cancel-button,input[type="search"]::-webkit-search-decoration{-webkit-appearance:none}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*:before,*:after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
body{-webkit-font-smoothing:antialiased}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.spread{width:100%}
p.lead,.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{font-size:1.21875em;line-height:1.6}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:none}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #ddddd8;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol,ul.no-bullet,ol.no-bullet{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ul.no-bullet{list-style:none}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite:before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media only screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7;font-weight:bold}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt,table tr:nth-of-type(even){background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
body{tab-size:4}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix:before,.clearfix:after,.float-group:before,.float-group:after{content:" ";display:table}
.clearfix:after,.float-group:after{clear:both}
*:not(pre)>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background-color:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre,pre>code{line-height:1.45;color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;text-rendering:optimizeSpeed}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background-color:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menu{color:rgba(0,0,0,.8)}
b.button:before,b.button:after{position:relative;top:-1px;font-weight:400}
b.button:before{content:"[";padding:0 3px 0 2px}
b.button:after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header:before,#header:after,#content:before,#content:after,#footnotes:before,#footnotes:after,#footer:before,#footer:after{content:" ";display:table}
#header:after,#content:after,#footnotes:after,#footer:after{clear:both}
#content{margin-top:1.25em}
#content:before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #ddddd8}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #ddddd8;padding-bottom:8px}
#header .details{border-bottom:1px solid #ddddd8;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span:before{content:"\00a0\2013\00a0"}
#header .details br+span.author:before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark:before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber:after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #ddddd8;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #efefed;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media only screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background-color:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #efefed;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #efefed;left:auto;right:0}}
@media only screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background-color:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
.sect1{padding-bottom:.625em}
@media only screen and (min-width:768px){.sect1{padding-bottom:1.25em}}
.sect1+.sect1{border-top:1px solid #efefed}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor:before,h2>a.anchor:before,h3>a.anchor:before,#toctitle>a.anchor:before,.sidebarblock>.content>.title>a.anchor:before,h4>a.anchor:before,h5>a.anchor:before,h6>a.anchor:before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock>caption.title{white-space:nowrap;overflow:visible;max-width:0}
.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>.paragraph:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #ddddd8;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock pre:not(.highlight),.listingblock pre[class="highlight"],.listingblock pre[class^="highlight "],.listingblock pre.CodeRay,.listingblock pre.prettyprint{background:#f7f7f8}
.sidebarblock .literalblock pre,.sidebarblock .listingblock pre:not(.highlight),.sidebarblock .listingblock pre[class="highlight"],.sidebarblock .listingblock pre[class^="highlight "],.sidebarblock .listingblock pre.CodeRay,.sidebarblock .listingblock pre.prettyprint{background:#f2f1f1}
.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;padding:1em;font-size:.8125em}
.literalblock pre.nowrap,.literalblock pre[class].nowrap,.listingblock pre.nowrap,.listingblock pre[class].nowrap{overflow-x:auto;white-space:pre;word-wrap:normal}
@media only screen and (min-width:768px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:.90625em}}
@media only screen and (min-width:1280px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:1em}}
.literalblock.output pre{color:#f7f7f8;background-color:rgba(0,0,0,.9)}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.listingblock>.content{position:relative}
.listingblock code[data-lang]:before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:#999}
.listingblock:hover code[data-lang]:before{display:block}
.listingblock.terminal pre .command:before{content:attr(data-prompt);padding-right:.5em;color:#999}
.listingblock.terminal pre .command:not([data-prompt]):before{content:"$"}
table.pyhltable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.pyhltable td{vertical-align:top;padding-top:0;padding-bottom:0;line-height:1.45}
table.pyhltable td.code{padding-left:.75em;padding-right:0}
pre.pygments .lineno,table.pyhltable td:not(.code){color:#999;padding-left:0;padding-right:.5em;border-right:1px solid #ddddd8}
pre.pygments .lineno{display:inline-block;margin-right:.25em}
table.pyhltable .linenodiv{background:none!important;padding-right:0!important}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock blockquote p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote:before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.5em;margin-right:.5ex;text-align:right}
.quoteblock .quoteblock{margin-left:0;margin-right:0;padding:.5em 0;border-left:3px solid rgba(0,0,0,.6)}
.quoteblock .quoteblock blockquote{padding:0 0 0 .75em}
.quoteblock .quoteblock blockquote:before{display:none}
.verseblock{margin:0 1em 1.25em 1em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract{margin:0 0 1.25em 0;display:block}
.quoteblock.abstract blockquote,.quoteblock.abstract blockquote p{text-align:left;word-spacing:0}
.quoteblock.abstract blockquote:before,.quoteblock.abstract blockquote p:first-of-type:before{display:none}
table.tableblock{max-width:100%;border-collapse:separate}
table.tableblock td>.paragraph:last-child p>p:last-child,table.tableblock th>p:last-child,table.tableblock td>p:last-child{margin-bottom:0}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all th.tableblock,table.grid-all td.tableblock{border-width:0 1px 1px 0}
table.grid-all tfoot>tr>th.tableblock,table.grid-all tfoot>tr>td.tableblock{border-width:1px 1px 0 0}
table.grid-cols th.tableblock,table.grid-cols td.tableblock{border-width:0 1px 0 0}
table.grid-all *>tr>.tableblock:last-child,table.grid-cols *>tr>.tableblock:last-child{border-right-width:0}
table.grid-rows th.tableblock,table.grid-rows td.tableblock{border-width:0 0 1px 0}
table.grid-all tbody>tr:last-child>th.tableblock,table.grid-all tbody>tr:last-child>td.tableblock,table.grid-all thead:last-child>tr>th.tableblock,table.grid-rows tbody>tr:last-child>th.tableblock,table.grid-rows tbody>tr:last-child>td.tableblock,table.grid-rows thead:last-child>tr>th.tableblock{border-bottom-width:0}
table.grid-rows tfoot>tr>th.tableblock,table.grid-rows tfoot>tr>td.tableblock{border-width:1px 0 0 0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot{border-width:1px 0}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
td>div.verse{white-space:pre}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.unstyled,ol.unnumbered,ul.checklist,ul.none{list-style-type:none}
ul.unstyled,ol.unnumbered,ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1em;font-size:.85em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{width:1em;position:relative;top:1px}
ul.inline{margin:0 auto .625em auto;margin-left:-1.375em;margin-right:0;padding:0;list-style:none;overflow:hidden}
ul.inline>li{list-style:none;float:left;margin-left:1.375em;display:block}
ul.inline>li>*{display:block}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist>table tr>td:first-of-type{padding:0 .75em;line-height:1}
.colist>table tr>td:last-of-type{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left,.imageblock[style*="float: left"]{margin:.25em .625em 1.25em 0}
.imageblock.right,.imageblock[style*="float: right"]{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em 0;border-width:1px 0 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;text-indent:-1.05em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background-color:#00fafa}
.black{color:#000}
.black-background{background-color:#000}
.blue{color:#0000bf}
.blue-background{background-color:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background-color:#fa00fa}
.gray{color:#606060}
.gray-background{background-color:#7d7d7d}
.green{color:#006000}
.green-background{background-color:#007d00}
.lime{color:#00bf00}
.lime-background{background-color:#00fa00}
.maroon{color:#600000}
.maroon-background{background-color:#7d0000}
.navy{color:#000060}
.navy-background{background-color:#00007d}
.olive{color:#606000}
.olive-background{background-color:#7d7d00}
.purple{color:#600060}
.purple-background{background-color:#7d007d}
.red{color:#bf0000}
.red-background{background-color:#fa0000}
.silver{color:#909090}
.silver-background{background-color:#bcbcbc}
.teal{color:#006060}
.teal-background{background-color:#007d7d}
.white{color:#bfbfbf}
.white-background{background-color:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background-color:#fafa00}
span.icon>.fa{cursor:default}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note:before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip:before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning:before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution:before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important:before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background-color:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]:after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background-color:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@media print{@page{margin:1.25cm .75cm}
*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare):after,a[href^="https:"]:not(.bare):after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]:after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #ddddd8!important;padding-bottom:0!important}
.sect1{padding-bottom:0!important}
.sect1+.sect1{border:0!important}
#header>h1:first-child{margin-top:1.25rem}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em 0}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span:before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]:before{display:block}
#footer{background:none!important;padding:0 .9375em}
#footer-text{color:rgba(0,0,0,.6)!important;font-size:.9em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
</style>
<link rel="stylesheet" href="css/font-awesome/css/font-awesome.min.css">
<!-- HibernateDoc.Meta -->
<meta name="description" content="Hibernate Validator, Annotation based constraints for your domain model - Reference Documentation" />
<meta name="keywords" content="hibernate, validator, hibernate validator, validation, bean validation" />
<link rel="canonical" href="https://docs.jboss.org/hibernate/stable/validator/reference/en-US/html_single/" />
<!-- /HibernateDoc.Meta -->

<link rel="stylesheet" href="css/hibernate.css" type="text/css" />
</head>
<body class="book toc2 toc-left">
<div id="header">
<h1>Hibernate Validator 5.4.3.Final - JSR 349 Reference Implementation: Reference Guide</h1>
<div class="details">
<span id="author" class="author">Hardy Ferentschik</span><br>
<span id="author2" class="author">Gunnar Morling</span><br>
<span id="revdate">2019-02-03</span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#preface">Preface</a></li>
<li><a href="#validator-gettingstarted">1. Getting started</a>
<ul class="sectlevel2">
<li><a href="#validator-gettingstarted-createproject">1.1. Project set up</a></li>
<li><a href="#validator-gettingstarted-createmodel">1.2. Applying constraints</a></li>
<li><a href="#_validating_constraints">1.3. Validating constraints</a></li>
<li><a href="#_java_8_support">1.4. Java 8 support</a></li>
<li><a href="#validator-gettingstarted-whatsnext">1.5. Where to go next?</a></li>
</ul>
</li>
<li><a href="#chapter-bean-constraints">2. Declaring and validating bean constraints</a>
<ul class="sectlevel2">
<li><a href="#section-declaring-bean-constraints">2.1. Declaring bean constraints</a></li>
<li><a href="#section-validating-bean-constraints">2.2. Validating bean constraints</a></li>
<li><a href="#section-builtin-constraints">2.3. Built-in constraints</a></li>
</ul>
</li>
<li><a href="#chapter-method-constraints">3. Declaring and validating method constraints</a>
<ul class="sectlevel2">
<li><a href="#section-declaring-method-constraints">3.1. Declaring method constraints</a></li>
<li><a href="#section-validating-executable-constraints">3.2. Validating method constraints</a></li>
<li><a href="#section-builtin-method-constraints">3.3. Built-in method constraints</a></li>
</ul>
</li>
<li><a href="#chapter-message-interpolation">4. Interpolating constraint error messages</a>
<ul class="sectlevel2">
<li><a href="#section-message-interpolation">4.1. Default message interpolation</a></li>
<li><a href="#section-custom-message-interpolation">4.2. Custom message interpolation</a></li>
</ul>
</li>
<li><a href="#chapter-groups">5. Grouping constraints</a>
<ul class="sectlevel2">
<li><a href="#_requesting_groups">5.1. Requesting groups</a></li>
<li><a href="#section-group-inheritance">5.2. Group inheritance</a></li>
<li><a href="#section-defining-group-sequences">5.3. Defining group sequences</a></li>
<li><a href="#section-default-group-class">5.4. Redefining the default group sequence</a></li>
<li><a href="#section-group-conversion">5.5. Group conversion</a></li>
</ul>
</li>
<li><a href="#validator-customconstraints">6. Creating custom constraints</a>
<ul class="sectlevel2">
<li><a href="#validator-customconstraints-simple">6.1. Creating a simple constraint</a></li>
<li><a href="#section-class-level-constraints">6.2. Class-level constraints</a></li>
<li><a href="#section-cross-parameter-constraints">6.3. Cross-parameter constraints</a></li>
<li><a href="#section-constraint-composition">6.4. Constraint composition</a></li>
</ul>
</li>
<li><a href="#chapter-xml-configuration">7. Configuring via XML</a>
<ul class="sectlevel2">
<li><a href="#section-configuration-validation-xml">7.1. Configuring the validator factory in <em>validation.xml</em></a></li>
<li><a href="#section-mapping-xml-constraints">7.2. Mapping constraints via <code>constraint-mappings</code></a></li>
</ul>
</li>
<li><a href="#chapter-bootstrapping">8. Bootstrapping</a>
<ul class="sectlevel2">
<li><a href="#section-retrieving-validator-factory-validator">8.1. Retrieving <code>ValidatorFactory</code> and <code>Validator</code></a></li>
<li><a href="#section-configuring-validator-factory">8.2. Configuring a <code>ValidatorFactory</code></a></li>
<li><a href="#section-configuring-validator">8.3. Configuring a Validator</a></li>
</ul>
</li>
<li><a href="#validator-metadata-api">9. Using constraint metadata</a>
<ul class="sectlevel2">
<li><a href="#__code_beandescriptor_code">9.1. <code>BeanDescriptor</code></a></li>
<li><a href="#section-property-descriptor">9.2. <code>PropertyDescriptor</code></a></li>
<li><a href="#__code_methoddescriptor_code_and_code_constructordescriptor_code">9.3. <code>MethodDescriptor</code> and <code>ConstructorDescriptor</code></a></li>
<li><a href="#validator-metadata-api-elementdescriptor">9.4. <code>ElementDescriptor</code></a></li>
<li><a href="#section-group-conversion-descriptor">9.5. <code>GroupConversionDescriptor</code></a></li>
<li><a href="#section-constraint-descriptor">9.6. <code>ConstraintDescriptor</code></a></li>
</ul>
</li>
<li><a href="#validator-integration">10. Integrating with other frameworks</a>
<ul class="sectlevel2">
<li><a href="#validator-checkconstraints-orm">10.1. ORM integration</a></li>
<li><a href="#section-presentation-layer">10.2. JSF &amp; Seam</a></li>
<li><a href="#section-integration-with-cdi">10.3. CDI</a></li>
<li><a href="#_java_ee">10.4. Java EE</a></li>
<li><a href="#_javafx">10.5. JavaFX</a></li>
</ul>
</li>
<li><a href="#validator-specifics">11. Hibernate Validator Specifics</a>
<ul class="sectlevel2">
<li><a href="#_public_api">11.1. Public API</a></li>
<li><a href="#section-fail-fast">11.2. Fail fast mode</a></li>
<li><a href="#section-method-validation-prerequisite-relaxation">11.3. Relaxation of requirements for method validation in class hierarchies</a></li>
<li><a href="#section-programmatic-api">11.4. Programmatic constraint definition and declaration</a></li>
<li><a href="#section-programmatic-api-contributor">11.5. Applying programmatic constraint declarations to the default validator factory</a></li>
<li><a href="#section-advanced-constraint-composition">11.6. Advanced constraint composition features</a></li>
<li><a href="#section-extensions-path-api">11.7. Extensions of the Path API</a></li>
<li><a href="#section-dynamic-payload">11.8. Dynamic payload as part of ConstraintViolation</a></li>
<li><a href="#non-el-message-interpolator">11.9. <code>ParameterMessageInterpolator</code></a></li>
<li><a href="#__code_resourcebundlelocator_code">11.10. <code>ResourceBundleLocator</code></a></li>
<li><a href="#_custom_contexts">11.11. Custom contexts</a></li>
<li><a href="#section-paranamer-parameternameprovider">11.12. ParaNamer based <code>ParameterNameProvider</code></a></li>
<li><a href="#section-value-handling">11.13. Unwrapping values</a></li>
<li><a href="#section-constraint-definition-contribution">11.14. Providing constraint definitions</a></li>
<li><a href="#section-constraint-customizing-class-loading">11.15. Customizing class-loading</a></li>
<li><a href="#section-time-provider">11.16. Time providers for @Future and @Past</a></li>
</ul>
</li>
<li><a href="#validator-annotation-processor">12. Annotation Processor</a>
<ul class="sectlevel2">
<li><a href="#validator-annotationprocessor-prerequisites">12.1. Prerequisites</a></li>
<li><a href="#validator-annotationprocessor-features">12.2. Features</a></li>
<li><a href="#validator-annotationprocessor-options">12.3. Options</a></li>
<li><a href="#validator-annotationprocessor-usage">12.4. Using the Annotation Processor</a></li>
<li><a href="#validator-annotationprocessor-known-issues">12.5. Known issues</a></li>
</ul>
</li>
<li><a href="#validator-further-reading">13. Further reading</a></li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="preface"><a class="anchor" href="#preface"></a>Preface</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Validating data is a common task that occurs throughout all application layers, from the
presentation to the persistence layer. Often the same validation logic is implemented in each layer
which is time consuming and error-prone. To avoid duplication of these validations, developers often
bundle validation logic directly into the domain model, cluttering domain classes with validation
code which is really metadata about the class itself.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/application-layers.png" alt="application layers">
</div>
</div>
<div class="paragraph">
<p>JSR 349 - Bean Validation 1.1 - defines a metadata model and API for entity and method validation.
The default metadata source are annotations, with the ability to override and extend the meta-data
through the use of XML. The API is not tied to a specific application tier nor programming model. It
is specifically not tied to either web or persistence tier, and is available for both server-side
application programming, as well as rich client Swing application developers.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/application-layers2.png" alt="application layers2">
</div>
</div>
<div class="paragraph">
<p>Hibernate Validator is the reference implementation of this JSR 349. The implementation itself as
well as the Bean Validation API and TCK are all provided and distributed under the
<a href="http://www.apache.org/licenses/LICENSE-2.0">Apache Software License 2.0</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="validator-gettingstarted"><a class="anchor" href="#validator-gettingstarted"></a>1. Getting started</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This chapter will show you how to get started with Hibernate Validator, the reference implementation (RI) of Bean Validation. For the following quick-start you need:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A JDK &gt;= 6</p>
</li>
<li>
<p><a href="http://maven.apache.org/">Apache Maven</a></p>
</li>
<li>
<p>An Internet connection (Maven has to download all required libraries)</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="validator-gettingstarted-createproject"><a class="anchor" href="#validator-gettingstarted-createproject"></a>1.1. Project set up</h3>
<div class="paragraph">
<p>In order to use Hibernate Validator within a Maven project, simply add the following dependency to
your <em>pom.xml</em>:</p>
</div>
<div class="exampleblock">
<div class="title">Example 1. Hibernate Validator Maven dependency</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-XML" data-lang="XML">&lt;dependency&gt;
    &lt;groupId&gt;org.hibernate&lt;/groupId&gt;
    &lt;artifactId&gt;hibernate-validator&lt;/artifactId&gt;
    &lt;version&gt;5.4.3.Final&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>This transitively pulls in the dependency to the Bean Validation API
(<code>javax.validation:validation-api:1.1.0.Final</code>).</p>
</div>
<div class="sect3">
<h4 id="validator-gettingstarted-uel"><a class="anchor" href="#validator-gettingstarted-uel"></a>1.1.1. Unified EL</h4>
<div class="paragraph">
<p>Hibernate Validator requires an implementation of the Unified Expression Language
(<a href="http://jcp.org/en/jsr/detail?id=341">JSR 341</a>) for evaluating dynamic expressions in constraint
violation messages (see <a href="#section-message-interpolation">Default message interpolation</a>). When your application runs in a Java EE
container such as JBoss AS, an EL implementation is already provided by the container. In a Java SE
environment, however, you have to add an implementation as dependency to your POM file. For instance
you can add the following two dependencies to use the JSR 341 <a href="http://uel.java.net/">reference
implementation</a>:</p>
</div>
<div class="exampleblock">
<div class="title">Example 2. Maven dependencies for Unified EL reference implementation</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-XML" data-lang="XML">&lt;dependency&gt;
    &lt;groupId&gt;org.glassfish&lt;/groupId&gt;
    &lt;artifactId&gt;javax.el&lt;/artifactId&gt;
    &lt;version&gt;3.0.1-b08&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>For environments where one cannot provide a EL implementation Hibernate Validator is offering a
<a href="#non-el-message-interpolator"><code>ParameterMessageInterpolator</code></a>. However, the use of this interpolator
is not Bean Validation specification compliant.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="section-getting-started-cdi"><a class="anchor" href="#section-getting-started-cdi"></a>1.1.2. CDI</h4>
<div class="paragraph">
<p>Bean Validation defines integration points with CDI (Contexts and Dependency Injection for Java <sup>TM</sup>
EE, <a href="http://jcp.org/en/jsr/detail?id=346">JSR 346</a>). If your application runs in an
environment which does not provide this integration out of the box, you may use the Hibernate
Validator CDI portable extension by adding the following Maven dependency to your POM:</p>
</div>
<div class="exampleblock">
<div class="title">Example 3. Hibernate Validator CDI portable extension Maven dependency</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-XML" data-lang="XML">&lt;dependency&gt;
    &lt;groupId&gt;org.hibernate&lt;/groupId&gt;
    &lt;artifactId&gt;hibernate-validator-cdi&lt;/artifactId&gt;
    &lt;version&gt;5.4.3.Final&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Note that adding this dependency is usually not required for applications running on a Java EE
application server. You can learn more about the integration of Bean Validation and CDI in
<a href="#section-integration-with-cdi">CDI</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="section-getting-started-security-manager"><a class="anchor" href="#section-getting-started-security-manager"></a>1.1.3. Running with a security manager</h4>
<div class="paragraph">
<p>Hibernate Validator supports running with a <a href="http://docs.oracle.com/javase/8/docs/technotes/guides/security/index.html">security manager</a> being enabled.
To do so, you must assign several permissions to the Hibernate Validator and the Bean Validation API code bases.
The following shows how to do this via a <a href="http://docs.oracle.com/javase/8/docs/technotes/guides/security/PolicyFiles.html">policy file</a> as processed by the Java default policy implementation:</p>
</div>
<div class="exampleblock">
<div class="title">Example 4. Policy file for using Hibernate Validator with a security manager</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-XML" data-lang="XML">grant codeBase "file:path/to/hibernate-validator-5.4.3.Final.jar" {
    permission java.lang.reflect.ReflectPermission "suppressAccessChecks";
    permission java.lang.RuntimePermission "accessDeclaredMembers";
    permission java.lang.RuntimePermission "setContextClassLoader";

    permission org.hibernate.validator.HibernateValidatorPermission "accessPrivateMembers";

    // Only needed when working with XML descriptors (validation.xml or XML constraint mappings)
    permission java.util.PropertyPermission "mapAnyUriToUri", "read";
};

grant codeBase "file:path/to/validation-api-1.1.0.Final.jar" {
    permission java.io.FilePermission "path/to/hibernate-validator-5.4.3.Final.jar", "read";
};</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>All API invocations requiring special permissions are done via privileged actions.
This means only Hibernate Validator and the Bean Validation API themselves need the listed permissions.
You don&#8217;t need to assign any permissions to other code bases calling Hibernate Validator.</p>
</div>
</div>
<div class="sect3">
<h4 id="_updating_hibernate_validator_in_wildfly"><a class="anchor" href="#_updating_hibernate_validator_in_wildfly"></a>1.1.4. Updating Hibernate Validator in WildFly</h4>
<div class="paragraph">
<p>The <a href="http://wildfly.org/">WildFly application server</a> contains Hibernate Validator out of the box.
In order to update the server modules for Bean Validation API and Hibernate Validator to the latest and greatest, the patch mechanism of WildFly can be used.</p>
</div>
<div class="paragraph">
<p>You can download the patch file from <a href="http://sourceforge.net/projects/hibernate/files/hibernate-validator">SourceForge</a> or from Maven Central using the following dependency:</p>
</div>
<div class="exampleblock">
<div class="title">Example 5. Maven dependency for WildFly 10.1.0.Final patch file</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-XML" data-lang="XML">&lt;dependency&gt;
    &lt;groupId&gt;org.hibernate&lt;/groupId&gt;
    &lt;artifactId&gt;hibernate-validator-modules&lt;/artifactId&gt;
    &lt;version&gt;5.4.3.Final&lt;/version&gt;
    &lt;classifier&gt;wildfly-10.1.0.Final-patch&lt;/classifier&gt;
    &lt;type&gt;zip&lt;/type&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Having downloaded the patch file, you can apply it to WildFly by running this command:</p>
</div>
<div class="exampleblock">
<div class="title">Example 6. Applying the WildFly patch</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code>$JBOSS_HOME/bin/jboss-cli.sh patch apply hibernate-validator-modules-5.4.3.Final-wildfly-10.1.0.Final-patch.zip</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>In case you want to undo the patch and go back to the version of Hibernate Validator originally coming with the server, run the following command:</p>
</div>
<div class="exampleblock">
<div class="title">Example 7. Rolling back the WildFly patch</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code>$JBOSS_HOME/bin/jboss-cli.sh patch rollback --reset-configuration=true</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>You can learn more about the WildFly patching infrastructure in general <a href="https://developer.jboss.org/wiki/SingleInstallationPatching/">here</a> and <a href="http://www.mastertheboss.com/jboss-server/jboss-configuration/managing-wildfly-and-eap-patches">here</a>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="validator-gettingstarted-createmodel"><a class="anchor" href="#validator-gettingstarted-createmodel"></a>1.2. Applying constraints</h3>
<div class="paragraph">
<p>Lets dive directly into an example to see how to apply constraints.</p>
</div>
<div id="example-class-car" class="exampleblock">
<div class="title">Example 8. Class Car annotated with constraints</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter01;

import javax.validation.constraints.Min;
import javax.validation.constraints.NotNull;
import javax.validation.constraints.Size;

public class Car {

    @NotNull
    private String manufacturer;

    @NotNull
    @Size(min = 2, max = 14)
    private String licensePlate;

    @Min(2)
    private int seatCount;

    public Car(String manufacturer, String licencePlate, int seatCount) {
        this.manufacturer = manufacturer;
        this.licensePlate = licencePlate;
        this.seatCount = seatCount;
    }

    //getters and setters ...
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The <code>@NotNull</code>, <code>@Size</code> and <code>@Min</code> annotations are used to declare the constraints which should be applied
to the fields of a Car instance:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>manufacturer</code> must never be <code>null</code></p>
</li>
<li>
<p><code>licensePlate</code> must never be <code>null</code> and must be between 2 and 14 characters long</p>
</li>
<li>
<p><code>seatCount</code> must be at least 2</p>
</li>
</ul>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>You can find the complete source code of all examples used in this reference guide in the Hibernate
Validator
<a href="https://github.com/hibernate/hibernate-validator/tree/master/documentation/src/test">source repository</a>
on GitHub.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_validating_constraints"><a class="anchor" href="#_validating_constraints"></a>1.3. Validating constraints</h3>
<div class="paragraph">
<p>To perform a validation of these constraints, you use a <code>Validator</code> instance. Let&#8217;s have a look at a
unit test for <code>Car</code>:</p>
</div>
<div class="exampleblock">
<div class="title">Example 9. Class CarTest showing validation examples</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter01;

import java.util.Set;
import javax.validation.ConstraintViolation;
import javax.validation.Validation;
import javax.validation.Validator;
import javax.validation.ValidatorFactory;

import org.junit.BeforeClass;
import org.junit.Test;

import static org.junit.Assert.assertEquals;

public class CarTest {

    private static Validator validator;

    @BeforeClass
    public static void setUpValidator() {
        ValidatorFactory factory = Validation.buildDefaultValidatorFactory();
        validator = factory.getValidator();
    }

    @Test
    public void manufacturerIsNull() {
        Car car = new Car( null, "DD-AB-123", 4 );

        Set&lt;ConstraintViolation&lt;Car&gt;&gt; constraintViolations =
                validator.validate( car );

        assertEquals( 1, constraintViolations.size() );
        assertEquals( "may not be null", constraintViolations.iterator().next().getMessage() );
    }

    @Test
    public void licensePlateTooShort() {
        Car car = new Car( "Morris", "D", 4 );

        Set&lt;ConstraintViolation&lt;Car&gt;&gt; constraintViolations =
                validator.validate( car );

        assertEquals( 1, constraintViolations.size() );
        assertEquals(
                "size must be between 2 and 14",
                constraintViolations.iterator().next().getMessage()
        );
    }

    @Test
    public void seatCountTooLow() {
        Car car = new Car( "Morris", "DD-AB-123", 1 );

        Set&lt;ConstraintViolation&lt;Car&gt;&gt; constraintViolations =
                validator.validate( car );

        assertEquals( 1, constraintViolations.size() );
        assertEquals(
                "must be greater than or equal to 2",
                constraintViolations.iterator().next().getMessage()
        );
    }

    @Test
    public void carIsValid() {
        Car car = new Car( "Morris", "DD-AB-123", 2 );

        Set&lt;ConstraintViolation&lt;Car&gt;&gt; constraintViolations =
                validator.validate( car );

        assertEquals( 0, constraintViolations.size() );
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>In the <code>setUp()</code> method a <code>Validator</code> object is retrieved from the <code>ValidatorFactory</code>. A <code>Validator</code>
instance is thread-safe and may be reused multiple times. It thus can safely be stored in a static
field and be used in the test methods to validate the different <code>Car</code> instances.</p>
</div>
<div class="paragraph">
<p>The <code>validate()</code> method returns a set of <code>ConstraintViolation</code> instances, which you can iterate over in
order to see which validation errors occurred. The first three test methods show some expected
constraint violations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <code>@NotNull</code> constraint on <code>manufacturer</code> is violated in <code>manufacturerIsNull()</code></p>
</li>
<li>
<p>The <code>@Size</code> constraint on <code>licensePlate</code> is violated in <code>licensePlateTooShort()</code></p>
</li>
<li>
<p>The <code>@Min</code> constraint on <code>seatCount</code> is violated in <code>seatCountTooLow()</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If the object validates successfully, <code>validate()</code> returns an empty set as you can see in <code>carIsValid()</code>.</p>
</div>
<div class="paragraph">
<p>Note that only classes from the package <code>javax.validation</code> are used. These are provided from the Bean
Validation API. No classes from Hibernate Validator are directly referenced, resulting in portable
code.</p>
</div>
</div>
<div class="sect2">
<h3 id="_java_8_support"><a class="anchor" href="#_java_8_support"></a>1.4. Java 8 support</h3>
<div class="paragraph">
<p>Java 8 introduces several enhancements which are valuable from a Hibernate Validator point of view.
This section briefly introduces the Hibernate Validator features based on Java 8.
They are only available in Hibernate Validator 5.2 and later.</p>
</div>
<div class="sect3">
<h4 id="_type_arguments_constraints"><a class="anchor" href="#_type_arguments_constraints"></a>1.4.1. Type arguments constraints</h4>
<div class="paragraph">
<p>In Java 8 it is possible to use annotations in any location a type is used. This includes type
arguments. Hibernate Validator supports the validation of constraints defined on type arguments
of collections, maps, and custom parameterized types. The <a href="#type-arguments-constraints">Type argument constraints</a> chapter
provides further information on how to apply and use type argument constraints.</p>
</div>
</div>
<div class="sect3">
<h4 id="_actual_parameter_names"><a class="anchor" href="#_actual_parameter_names"></a>1.4.2. Actual parameter names</h4>
<div class="paragraph">
<p>The Java 8 Reflection API can now retrieve the actual parameter names of a method or constructor.
Hibernate Validator uses this ability to report the actual parameter names instead of <code>arg0</code>,
<code>arg1</code>, etc. The <a href="#section-parameter-name-provider"><code>ParameterNameProvider</code></a> chapter explains how to use the new reflection
based parameter name provider.</p>
</div>
</div>
<div class="sect3">
<h4 id="_new_date_time_api"><a class="anchor" href="#_new_date_time_api"></a>1.4.3. New date/time API</h4>
<div class="paragraph">
<p>Java 8 introduces a new date/time API. Hibernate Validator provides full support for the new API
where <code>@Future</code> and <code>@Past</code> constraints can be applied on the new types.
The complete list of types supported for <code>@Future</code> and <code>@Past</code> can be found in <a href="#validator-defineconstraints-spec">Bean Validation constraints</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_optional_type"><a class="anchor" href="#_optional_type"></a>1.4.4. Optional type</h4>
<div class="paragraph">
<p>Hibernate Validator provides also support for Java 8 <code>Optional</code> type, by unwrapping the <code>Optional</code>
instance and validating the internal value. <a href="#section-optional-unwrapper">Optional unwrapper</a> provides examples and a
further discussion.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="validator-gettingstarted-whatsnext"><a class="anchor" href="#validator-gettingstarted-whatsnext"></a>1.5. Where to go next?</h3>
<div class="paragraph">
<p>That concludes the 5 minute tour through the world of Hibernate Validator and Bean Validation.
Continue exploring the code examples or look at further examples referenced in
<a href="#validator-further-reading">Further reading</a>.</p>
</div>
<div class="paragraph">
<p>To learn more about the validation of beans and properties, just continue reading
<a href="#chapter-bean-constraints">Declaring and validating bean constraints</a>. If you are interested in using Bean Validation for the validation of
method pre- and postcondition refer to <a href="#chapter-method-constraints">Declaring and validating method constraints</a>. In case your application has
specific validation requirements have a look at <a href="#validator-customconstraints">Creating custom constraints</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="chapter-bean-constraints"><a class="anchor" href="#chapter-bean-constraints"></a>2. Declaring and validating bean constraints</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In this chapter you will learn how to declare (see <a href="#section-declaring-bean-constraints">Declaring bean constraints</a>) and
validate (see <a href="#section-validating-bean-constraints">Validating bean constraints</a>) bean constraints.
<a href="#section-builtin-constraints">Built-in constraints</a> provides an overview of all built-in constraints coming with
Hibernate Validator.</p>
</div>
<div class="paragraph">
<p>If you are interested in applying constraints to method parameters and return values, refer to
<a href="#chapter-method-constraints">Declaring and validating method constraints</a>.</p>
</div>
<div class="sect2">
<h3 id="section-declaring-bean-constraints"><a class="anchor" href="#section-declaring-bean-constraints"></a>2.1. Declaring bean constraints</h3>
<div class="paragraph">
<p>Constraints in Bean Validation are expressed via Java annotations. In this section you will learn
how to enhance an object model with these annotations. There are the following three types of bean
constraints:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>field constraints</p>
</li>
<li>
<p>property constraints</p>
</li>
<li>
<p>class constraints</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Not all constraints can be placed on all of these levels. In fact, none of the default constraints
defined by Bean Validation can be placed at class level. The <code>java.lang.annotation.Target</code> annotation
in the constraint annotation itself determines on which elements a constraint can be placed. See
<a href="#validator-customconstraints">Creating custom constraints</a> for more information.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_field_level_constraints"><a class="anchor" href="#_field_level_constraints"></a>2.1.1. Field-level constraints</h4>
<div class="paragraph">
<p>Constraints can be expressed by annotating a field of a class. <a href="#example-field-level">Field-level constraints</a> shows a field
level configuration example:</p>
</div>
<div id="example-field-level" class="exampleblock">
<div class="title">Example 10. Field-level constraints</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter02.fieldlevel;

public class Car {

    @NotNull
    private String manufacturer;

    @AssertTrue
    private boolean isRegistered;

    public Car(String manufacturer, boolean isRegistered) {
        this.manufacturer = manufacturer;
        this.isRegistered = isRegistered;
    }

    //getters and setters...
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>When using field-level constraints field access strategy is used to access the value to be
validated. This means the validation engine directly accesses the instance variable and does not
invoke the property accessor method even if such an accessor exists.</p>
</div>
<div class="paragraph">
<p>Constraints can be applied to fields of any access type (public, private etc.). Constraints on
static fields are not supported, though.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When validating byte code enhanced objects property level constraints should be used, because the
byte code enhancing library won&#8217;t be able to determine a field access via reflection.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_property_level_constraints"><a class="anchor" href="#_property_level_constraints"></a>2.1.2. Property-level constraints</h4>
<div class="paragraph">
<p>If your model class adheres to the
<a href="http://www.oracle.com/technetwork/articles/javaee/spec-136004.html">JavaBeans</a> standard, it
is also possible to annotate the properties of a bean class instead of its fields.
<a href="#example-property-level">Property-level constraints</a> uses the same entity as in <a href="#example-field-level">Field-level constraints</a>, however, property level
constraints are used.</p>
</div>
<div id="example-property-level" class="exampleblock">
<div class="title">Example 11. Property-level constraints</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter02.propertylevel;

public class Car {

    private String manufacturer;

    private boolean isRegistered;

    public Car(String manufacturer, boolean isRegistered) {
        this.manufacturer = manufacturer;
        this.isRegistered = isRegistered;
    }

    @NotNull
    public String getManufacturer() {
        return manufacturer;
    }

    public void setManufacturer(String manufacturer) {
        this.manufacturer = manufacturer;
    }

    @AssertTrue
    public boolean isRegistered() {
        return isRegistered;
    }

    public void setRegistered(boolean isRegistered) {
        this.isRegistered = isRegistered;
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The property&#8217;s getter method has to be annotated, not its setter. That way also read-only properties
can be constrained which have no setter method.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When using property level constraints property access strategy is used to access the value to be
validated, i.e. the validation engine accesses the state via the property accessor method.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>It is recommended to stick either to field <em>or</em> property annotations within one class. It is not
recommended to annotate a field <em>and</em> the accompanying getter method as this would cause the field
to be validated twice.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="type-arguments-constraints"><a class="anchor" href="#type-arguments-constraints"></a>2.1.3. Type argument constraints</h4>
<div class="paragraph">
<p>Starting from Java 8, it is possible to specify constraints directly on the type argument of a
parameterized type. However, this requires that <code>ElementType.TYPE_USE</code> is specified via <code>@Target</code>
in the constraint definition. To maintain backwards compatibility, built-in Bean Validation as well as
Hibernate Validator specific constraints do not yet specify <code>ElementType.TYPE_USE</code>. To make use of
type argument constraints, custom constraints must be used (see <a href="#validator-customconstraints">Creating custom constraints</a>).</p>
</div>
<div class="paragraph">
<p>Hibernate Validator validates type arguments constraints specified on collections, map values,
<code>java.util.Optional</code>, and custom parameterized types.</p>
</div>
<div class="sect4">
<h5 id="_with_code_iterable_code"><a class="anchor" href="#_with_code_iterable_code"></a>With <code>Iterable</code></h5>
<div class="paragraph">
<p>When applying constraints on an <code>Iterable</code> type argument, Hibernate Validator will validate each
element. <a href="#example-type-arguments-constraints-collections">Type argument constraint on <code>List</code></a> shows an example of a
<code>List</code> with a type argument constraint.</p>
</div>
<div class="paragraph">
<p>In this example, <code>@ValidPart</code> is a custom constraint allowed to be used in the <code>TYPE_USE</code> context.</p>
</div>
<div id="example-type-arguments-constraints-collections" class="exampleblock">
<div class="title">Example 12. Type argument constraint on <code>List</code></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter02.typeargument.list;

public class Car {

    @Valid
    private List&lt;@ValidPart String&gt; parts = new ArrayList&lt;&gt;();

    public void addPart(String part) {
        parts.add( part );
    }

    //...

}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">Car car = new Car();
car.addPart( "Wheel" );
car.addPart( null );

Set&lt;ConstraintViolation&lt;Car&gt;&gt; constraintViolations = validator.validate( car );

assertEquals( 1, constraintViolations.size() );
assertEquals(
        "'null' is not a valid car part.",
        constraintViolations.iterator().next().getMessage()
);
assertEquals( "parts[1].&lt;collection element&gt;",
        constraintViolations.iterator().next().getPropertyPath().toString() );</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_with_code_map_code"><a class="anchor" href="#_with_code_map_code"></a>With <code>Map</code></h5>
<div class="paragraph">
<p>Type argument constraints are also validated for map values. Constraints on the key are ignored.
<a href="#example-type-arguments-constraints-map">Type argument constraint on maps</a> shows an example of a <code>Map</code> value with a type
argument constraint.</p>
</div>
<div id="example-type-arguments-constraints-map" class="exampleblock">
<div class="title">Example 13. Type argument constraint on maps</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter02.typeargument.map;

public class Car {

    public enum FuelConsumption {
        CITY,
        HIGHWAY
    }

    @Valid
    private EnumMap&lt;FuelConsumption, @MaxAllowedFuelConsumption Integer&gt; fuelConsumption = new EnumMap&lt;&gt;( FuelConsumption.class );

    public void setFuelConsumption(FuelConsumption consumption, int value) {
        fuelConsumption.put( consumption, value );
    }

    //...

}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">Car car = new Car();
car.setFuelConsumption( Car.FuelConsumption.HIGHWAY, 20 );

Set&lt;ConstraintViolation&lt;Car&gt;&gt; constraintViolations = validator.validate( car );

assertEquals( 1, constraintViolations.size() );
assertEquals( "20 is outside the max fuel consumption.", constraintViolations.iterator().next().getMessage() );</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_with_code_java_util_optional_code"><a class="anchor" href="#_with_code_java_util_optional_code"></a>With <code>java.util.Optional</code></h5>
<div class="paragraph">
<p>When applying a constraint on the type argument of <code>Optional</code>, Hibernate Validator will automatically
unwrap the type and validate the internal value. <a href="#example-type-arguments-constraints-optional">Type argument constraint on Optional</a> shows
an example of an <code>Optional</code> with a type argument constraint.</p>
</div>
<div id="example-type-arguments-constraints-optional" class="exampleblock">
<div class="title">Example 14. Type argument constraint on Optional</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter02.typeargument.optional;

public class Car {

    private Optional&lt;@MinTowingCapacity(1000) Integer&gt; towingCapacity = Optional.empty();

    public void setTowingCapacity(Integer alias) {
        towingCapacity = Optional.of( alias );
    }

    //...

}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">Car car = new Car();
car.setTowingCapacity( 100 );

Set&lt;ConstraintViolation&lt;Car&gt;&gt; constraintViolations = validator.validate( car );

assertEquals( 1, constraintViolations.size() );
assertEquals( "Not enough towing capacity.",
        constraintViolations.iterator().next().getMessage() );
assertEquals( "towingCapacity",
        constraintViolations.iterator().next().getPropertyPath().toString() );</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_with_custom_parameterized_types"><a class="anchor" href="#_with_custom_parameterized_types"></a>With custom parameterized types</h5>
<div class="paragraph">
<p>Type arguments constraints can with two restrictions also be used with custom types. First, a
<code>ValidatedValueUnwrapper</code> must be registered for the custom type allowing to retrieve
the value to validate (see <a href="#section-value-handling">Unwrapping values</a>). Second, only types with one type arguments
are supported. Parameterized types with two or more type arguments are not checked for type argument
constraints. This limitation might change in future versions.</p>
</div>
<div class="paragraph">
<p><a href="#example-type-arguments-constraints-custom-parameterized-type">Type argument constraint on custom parameterized type</a> shows an example of a custom
parameterized type with a type argument constraint.</p>
</div>
<div id="example-type-arguments-constraints-custom-parameterized-type" class="exampleblock">
<div class="title">Example 15. Type argument constraint on custom parameterized type</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter02.typeargument.custom;

public class Car {

    private GearBox&lt;@MinTorque(100) Gear&gt; gearBox;

    public void setGearBox(GearBox&lt;Gear&gt; gearBox) {
        this.gearBox = gearBox;
    }

    //...

}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter02.typeargument.custom;

public class GearBox&lt;T extends Gear&gt; {

    private final T gear;

    public GearBox(T gear) {
        this.gear = gear;
    }

    public Gear getGear() {
        return this.gear;
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter02.typeargument.custom;

public class Gear {
    private final Integer torque;

    public Gear(Integer torque) {
        this.torque = torque;
    }

    public Integer getTorque() {
        return torque;
    }

    public static class AcmeGear extends Gear {
        public AcmeGear() {
            super( 100 );
        }
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter02.typeargument.custom;

public class GearBoxUnwrapper extends ValidatedValueUnwrapper&lt;GearBox&gt; {
    @Override
    public Object handleValidatedValue(GearBox gearBox) {
        return gearBox == null ? null : gearBox.getGear();
    }

    @Override
    public Type getValidatedValueType(Type valueType) {
        return Gear.class;
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">Car car = new Car();
car.setGearBox( new GearBox&lt;&gt;( new Gear.AcmeGear() ) );

Set&lt;ConstraintViolation&lt;Car&gt;&gt; constraintViolations = validator.validate( car );
assertEquals( 1, constraintViolations.size() );
assertEquals( "Gear is not providing enough torque.", constraintViolations.iterator().next().getMessage() );
assertEquals( "gearBox", constraintViolations.iterator().next().getPropertyPath().toString() );</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="validator-usingvalidator-classlevel"><a class="anchor" href="#validator-usingvalidator-classlevel"></a>2.1.4. Class-level constraints</h4>
<div class="paragraph">
<p>Last but not least, a constraint can also be placed on the class level. In this case not a single
property is subject of the validation but the complete object. Class-level constraints are useful if
the validation depends on a correlation between several properties of an object.</p>
</div>
<div class="paragraph">
<p>The Car class in <a href="#example-class-level">Class-level constraint</a> has the two attributes <code>seatCount</code> and <code>passengers</code> and it
should be ensured that the list of passengers has not more entries than seats are available. For
that purpose the <code>@ValidPassengerCount</code> constraint is added on the class level. The validator of that
constraint has access to the complete <code>Car</code> object, allowing to compare the numbers of seats and
passengers.</p>
</div>
<div class="paragraph">
<p>Refer to <a href="#section-class-level-constraints">Class-level constraints</a> to learn in detail how to implement this custom
constraint.</p>
</div>
<div id="example-class-level" class="exampleblock">
<div class="title">Example 16. Class-level constraint</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter02.classlevel;

@ValidPassengerCount
public class Car {

    private int seatCount;

    private List&lt;Person&gt; passengers;

    //...
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="section-constraint-inheritance"><a class="anchor" href="#section-constraint-inheritance"></a>2.1.5. Constraint inheritance</h4>
<div class="paragraph">
<p>When a class implements an interface or extends another class, all constraint annotations declared
on the super-type apply in the same manner as the constraints specified on the class itself. To make
things clearer let&#8217;s have a look at the following example:</p>
</div>
<div class="exampleblock">
<div class="title">Example 17. Constraint inheritance</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter02.inheritance;

public class Car {

    private String manufacturer;

    @NotNull
    public String getManufacturer() {
        return manufacturer;
    }

    //...
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter02.inheritance;

public class RentalCar extends Car {

    private String rentalStation;

    @NotNull
    public String getRentalStation() {
        return rentalStation;
    }

    //...
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Here the class <code>RentalCar</code> is a subclass of <code>Car</code> and adds the property <code>rentalStation</code>. If an instance of
<code>RentalCar</code> is validated, not only the <code>@NotNull</code> constraint on <code>rentalStation</code> is evaluated, but also the
constraint on <code>manufacturer</code> from the parent class.</p>
</div>
<div class="paragraph">
<p>The same would be true, if <code>Car</code> was not a superclass but an interface implemented by <code>RentalCar</code>.</p>
</div>
<div class="paragraph">
<p>Constraint annotations are aggregated if methods are overridden. So if <code>RentalCar</code> overrode the
<code>getManufacturer()</code> method from <code>Car</code>, any constraints annotated at the overriding method would be
evaluated in addition to the <code>@NotNull</code> constraint from the superclass.</p>
</div>
</div>
<div class="sect3">
<h4 id="section-object-graph-validation"><a class="anchor" href="#section-object-graph-validation"></a>2.1.6. Object graphs</h4>
<div class="paragraph">
<p>The Bean Validation API does not only allow to validate single class instances but also complete
object graphs (cascaded validation). To do so, just annotate a field or property representing a
reference to another object with <code>@Valid</code> as demonstrated in <a href="#example-cascaded-validation">Cascaded validation</a>.</p>
</div>
<div id="example-cascaded-validation" class="exampleblock">
<div class="title">Example 18. Cascaded validation</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter02.objectgraph;

public class Car {

    @NotNull
    @Valid
    private Person driver;

    //...
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter02.objectgraph;

public class Person {

    @NotNull
    private String name;

    //...
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>If an instance of <code>Car</code> is validated, the referenced <code>Person</code> object will be validated as well, as the
<code>driver</code> field is annotated with <code>@Valid</code>. Therefore the validation of a <code>Car</code> will fail if the <code>name</code> field
of the referenced <code>Person</code> instance is <code>null</code>.</p>
</div>
<div class="paragraph">
<p>The validation of object graphs is recursive, i.e. if a reference marked for cascaded validation
points to an object which itself has properties annotated with <code>@Valid</code>, these references will be
followed up by the validation engine as well. The validation engine will ensure that no infinite
loops occur during cascaded validation, for example if two objects hold references to each other.</p>
</div>
<div class="paragraph">
<p>Note that <code>null</code> values are getting ignored during cascaded validation.</p>
</div>
<div class="paragraph">
<p>Object graph validation also works for collection-typed fields. That means any attributes that</p>
</div>
<div class="ulist">
<ul>
<li>
<p>are arrays</p>
</li>
<li>
<p>implement <code>java.lang.Iterable</code> (especially <code>Collection</code>, <code>List</code> and <code>Set</code>)</p>
</li>
<li>
<p>implement <code>java.util.Map</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>can be annotated with <code>@Valid</code>, which will cause each contained element to be validated, when the
parent object is validated.</p>
</div>
<div id="example-cascaded-validation-list" class="exampleblock">
<div class="title">Example 19. Cascaded validation of a collection</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter02.objectgraph.list;

public class Car {

    @NotNull
    @Valid
    private List&lt;Person&gt; passengers = new ArrayList&lt;Person&gt;();

    //...
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>So when validating an instance of the <code>Car</code> class shown in <a href="#example-cascaded-validation-list">Cascaded validation of a collection</a>, a
<code>ConstraintViolation</code> will be created, if any of the <code>Person</code> objects contained in the passengers list
has a <code>null</code> name.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="section-validating-bean-constraints"><a class="anchor" href="#section-validating-bean-constraints"></a>2.2. Validating bean constraints</h3>
<div class="paragraph">
<p>The <code>Validator</code> interface is the most important object in Bean Validation. The next section shows how
to obtain an <code>Validator</code> instance. Afterwards you&#8217;ll learn how to use the different methods of the
<code>Validator</code> interface.</p>
</div>
<div class="sect3">
<h4 id="section-obtaining-validator"><a class="anchor" href="#section-obtaining-validator"></a>2.2.1. Obtaining a <code>Validator</code> instance</h4>
<div class="paragraph">
<p>The first step towards validating an entity instance is to get hold of a <code>Validator</code> instance. The
road to this instance leads via the <code>Validation</code> class and a <code>ValidatorFactory</code>. The easiest way is to
use the static method <code>Validation#buildDefaultValidatorFactory()</code>:</p>
</div>
<div class="exampleblock">
<div class="title">Example 20. <code>Validation#buildDefaultValidatorFactory()</code></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">ValidatorFactory factory = Validation.buildDefaultValidatorFactory();
validator = factory.getValidator();</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>This bootstraps a validator in the default configuration. Refer to <a href="#chapter-bootstrapping">Bootstrapping</a> to
learn more about the different bootstrapping methods and how to obtain a specifically configured
<code>Validator</code> instance.</p>
</div>
</div>
<div class="sect3">
<h4 id="_validator_methods"><a class="anchor" href="#_validator_methods"></a>2.2.2. Validator methods</h4>
<div class="paragraph">
<p>The <code>Validator</code> interface contains three methods that can be used to either validate entire entities
or just single properties of the entity.</p>
</div>
<div class="paragraph">
<p>All three methods return a <code>Set&lt;ConstraintViolation&gt;</code>. The set is empty, if the validation succeeds.
Otherwise a <code>ConstraintViolation</code> instance is added for each violated constraint.</p>
</div>
<div class="paragraph">
<p>All the validation methods have a var-args parameter which can be used to specify, which validation
groups shall be considered when performing the validation. If the parameter is not specified the
default validation group (<code>javax.validation.groups.Default</code>) is used. The topic of validation groups
is discussed in detail in <a href="#chapter-groups">Grouping constraints</a>.</p>
</div>
<div class="sect4">
<h5 id="__code_validator_validate_code"><a class="anchor" href="#__code_validator_validate_code"></a><code>Validator#validate()</code></h5>
<div class="paragraph">
<p>Use the <code>validate()</code> method to perform validation of all constraints of a given bean.
<a href="#example-validator-validate">Using <code>Validator#validate()</code></a> shows the validation of an instance of the <code>Car</code> class from
<a href="#example-property-level">Property-level constraints</a> which fails to satisfy the <code>@NotNull</code> constraint on the <code>manufacturer</code>
property. The validation call therefore returns one <code>ConstraintViolation</code> object.</p>
</div>
<div id="example-validator-validate" class="exampleblock">
<div class="title">Example 21. Using <code>Validator#validate()</code></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">Car car = new Car( null, true );

Set&lt;ConstraintViolation&lt;Car&gt;&gt; constraintViolations = validator.validate( car );

assertEquals( 1, constraintViolations.size() );
assertEquals( "may not be null", constraintViolations.iterator().next().getMessage() );</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="__code_validator_validateproperty_code"><a class="anchor" href="#__code_validator_validateproperty_code"></a><code>Validator#validateProperty()</code></h5>
<div class="paragraph">
<p>With help of the <code>validateProperty()</code> you can validate a single named property of a given object. The
property name is the JavaBeans property name.</p>
</div>
<div class="exampleblock">
<div class="title">Example 22. Using <code>Validator#validateProperty()</code></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">Car car = new Car( null, true );

Set&lt;ConstraintViolation&lt;Car&gt;&gt; constraintViolations = validator.validateProperty(
        car,
        "manufacturer"
);

assertEquals( 1, constraintViolations.size() );
assertEquals( "may not be null", constraintViolations.iterator().next().getMessage() );</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="__code_validator_validatevalue_code"><a class="anchor" href="#__code_validator_validatevalue_code"></a><code>Validator#validateValue()</code></h5>
<div class="paragraph">
<p>By using the <code>validateValue()</code> method you can check whether a single property of a given class can be
validated successfully, if the property had the specified value:</p>
</div>
<div class="exampleblock">
<div class="title">Example 23. Using <code>Validator#validateValue()</code></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">Set&lt;ConstraintViolation&lt;Car&gt;&gt; constraintViolations = validator.validateValue(
        Car.class,
        "manufacturer",
        null
);

assertEquals( 1, constraintViolations.size() );
assertEquals( "may not be null", constraintViolations.iterator().next().getMessage() );</code></pre>
</div>
</div>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p><code>@Valid</code> is not honored by <code>validateProperty()</code> or <code>validateValue()</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>Validator#validateProperty()</code> is for example used in the integration of Bean Validation into JSF 2
(see <a href="#section-presentation-layer">JSF &amp; Seam</a>) to perform a validation of the values entered into a form
before they are propagated to the model.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="section-constraint-violation-methods"><a class="anchor" href="#section-constraint-violation-methods"></a>2.2.3. <code>ConstraintViolation</code> methods</h4>
<div class="paragraph">
<p>Now it is time to have a closer look at what a <code>ConstraintViolation</code> is.
Using the different methods of <code>ConstraintViolation</code> a lot of useful information about the cause of the validation failure can be determined.
The following gives an overview of these methods.
The values under "Example" column refer to <a href="#example-validator-validate">Using <code>Validator#validate()</code></a>.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>getMessage()</code></dt>
<dd>
<p>The interpolated error message</p>
<div class="dlist">
<dl>
<dt class="hdlist1">Example</dt>
<dd>
<p>"may not be null"</p>
</dd>
</dl>
</div>
</dd>
<dt class="hdlist1"><code>getMessageTemplate()</code></dt>
<dd>
<p>The non-interpolated error message</p>
<div class="dlist">
<dl>
<dt class="hdlist1">Example</dt>
<dd>
<p>"{&#8230;&#8203; NotNull.message}"</p>
</dd>
</dl>
</div>
</dd>
<dt class="hdlist1"><code>getRootBean()</code></dt>
<dd>
<p>The root bean being validated</p>
<div class="dlist">
<dl>
<dt class="hdlist1">Example</dt>
<dd>
<p>car</p>
</dd>
</dl>
</div>
</dd>
<dt class="hdlist1"><code>getRootBeanClass()</code></dt>
<dd>
<p>The class of the root bean being validated</p>
<div class="dlist">
<dl>
<dt class="hdlist1">Example</dt>
<dd>
<p><code>Car.class</code></p>
</dd>
</dl>
</div>
</dd>
<dt class="hdlist1"><code>getLeafBean()</code></dt>
<dd>
<p>If a bean constraint, the bean instance the constraint is
applied on; if a property constraint, the bean instance hosting
the property the constraint is applied on</p>
<div class="dlist">
<dl>
<dt class="hdlist1">Example</dt>
<dd>
<p><code>car</code></p>
</dd>
</dl>
</div>
</dd>
<dt class="hdlist1"><code>getPropertyPath()</code></dt>
<dd>
<p>The property path to the validated value from root bean</p>
<div class="dlist">
<dl>
<dt class="hdlist1">Example</dt>
<dd>
<p>contains one node with kind <code>PROPERTY</code> and name "manufacturer"</p>
</dd>
</dl>
</div>
</dd>
<dt class="hdlist1"><code>getInvalidValue()</code></dt>
<dd>
<p>The value failing to pass the constraint</p>
<div class="dlist">
<dl>
<dt class="hdlist1">Example</dt>
<dd>
<p><code>null</code></p>
</dd>
</dl>
</div>
</dd>
<dt class="hdlist1"><code>getConstraintDescriptor()</code></dt>
<dd>
<p>Constraint metadata reported to fail</p>
<div class="dlist">
<dl>
<dt class="hdlist1">Example</dt>
<dd>
<p>descriptor for <code>@NotNull</code></p>
</dd>
</dl>
</div>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect2">
<h3 id="section-builtin-constraints"><a class="anchor" href="#section-builtin-constraints"></a>2.3. Built-in constraints</h3>
<div class="paragraph">
<p>Hibernate Validator comprises a basic set of commonly used constraints. These are foremost the
constraints defined by the Bean Validation specification (see <a href="#validator-defineconstraints-spec">Bean Validation constraints</a>).
Additionally, Hibernate Validator provides useful custom constraints (see
<a href="#validator-defineconstraints-hv-constraints">Additional constraints</a>).</p>
</div>
<div class="sect3">
<h4 id="validator-defineconstraints-spec"><a class="anchor" href="#validator-defineconstraints-spec"></a>2.3.1. Bean Validation constraints</h4>
<div class="paragraph">
<p>Below you can find a list of all constraints specified in the Bean Validation API.
All these constraints apply to the field/property level, there are no class-level constraints defined in the Bean Validation specification.
If you are using the Hibernate object-relational mapper, some of the constraints are taken into account when creating the DDL for your model (see "Hibernate metadata impact").</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Hibernate Validator allows some constraints to be applied to more data types than required by the
Bean Validation specification (e.g. <code>@Max</code> can be applied to strings). Relying on this feature can
impact portability of your application between Bean Validation providers.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>@AssertFalse</code></dt>
<dd>
<p>Checks that the annotated element is false</p>
<div class="dlist">
<dl>
<dt class="hdlist1">Supported data types</dt>
<dd>
<p><code>Boolean</code>, <code>boolean</code></p>
</dd>
<dt class="hdlist1">Hibernate metadata impact</dt>
<dd>
<p>None</p>
</dd>
</dl>
</div>
</dd>
<dt class="hdlist1"><code>@AssertTrue</code></dt>
<dd>
<p>Checks that the annotated element is true</p>
<div class="dlist">
<dl>
<dt class="hdlist1">Supported data types</dt>
<dd>
<p><code>Boolean</code>, <code>boolean</code></p>
</dd>
<dt class="hdlist1">Hibernate metadata impact</dt>
<dd>
<p>None</p>
</dd>
</dl>
</div>
</dd>
<dt class="hdlist1"><code>@DecimalMax(value=, inclusive=)</code></dt>
<dd>
<p>Checks whether the annotated value is less than the specified maximum, when <code>inclusive</code>=false. Otherwise whether the value is less than or equal to the specified maximum. The parameter value is the string representation of the max value according to the <code>BigDecimal</code> string representation.</p>
<div class="dlist">
<dl>
<dt class="hdlist1">Supported data types</dt>
<dd>
<p><code>BigDecimal</code>, <code>BigInteger</code>, <code>CharSequence</code>, <code>byte</code>, <code>short</code>, <code>int</code>, <code>long</code> and the respective wrappers of the primitive types; additionally supported by HV: any sub-type of <code>Number</code> and <code>javax.money.MonetaryAmount</code> (if the <a href="https://jcp.org/en/jsr/detail?id=354">JSR 354 API</a> and an implementation is on the class path)</p>
</dd>
<dt class="hdlist1">Hibernate metadata impact</dt>
<dd>
<p>None</p>
</dd>
</dl>
</div>
</dd>
<dt class="hdlist1"><code>@DecimalMin(value=, inclusive=)</code></dt>
<dd>
<p>Checks whether the annotated value is larger than the specified minimum, when <code>inclusive</code>=false. Otherwise whether the value is larger than or equal to the specified minimum. The parameter value is the string representation of the min value according to the <code>BigDecimal</code> string representation.</p>
<div class="dlist">
<dl>
<dt class="hdlist1">Supported data types</dt>
<dd>
<p><code>BigDecimal</code>, <code>BigInteger</code>, <code>CharSequence</code>, <code>byte</code>, <code>short</code>, <code>int</code>, <code>long</code> and the respective wrappers of the primitive types; additionally supported by HV: any sub-type of <code>Number</code> and <code>javax.money.MonetaryAmount</code></p>
</dd>
<dt class="hdlist1">Hibernate metadata impact</dt>
<dd>
<p>None</p>
</dd>
</dl>
</div>
</dd>
<dt class="hdlist1"><code>@Digits(integer=, fraction=)</code></dt>
<dd>
<p>Checks whether the annotated value is a number having up to <code>integer</code> digits and <code>fraction</code> fractional digits</p>
<div class="dlist">
<dl>
<dt class="hdlist1">Supported data types</dt>
<dd>
<p>BigDecimal, <code>BigInteger</code>, <code>CharSequence</code>, <code>byte</code>, <code>short</code>, <code>int</code>, <code>long</code> and the respective wrappers of the primitive types; additionally supported by HV: any sub-type of <code>Number</code></p>
</dd>
<dt class="hdlist1">Hibernate metadata impact</dt>
<dd>
<p>Defines column precision and scale</p>
</dd>
</dl>
</div>
</dd>
<dt class="hdlist1"><code>@Future</code></dt>
<dd>
<p>Checks whether the annotated date is in the future</p>
<div class="dlist">
<dl>
<dt class="hdlist1">Supported data types</dt>
<dd>
<p><code>java.util.Date</code>, <code>java.util.Calendar</code>, <code>java.time.chrono.ChronoZonedDateTime</code>, <code>java.time.Instant</code>, <code>java.time.OffsetDateTime</code>; additionally supported by HV, if the <a href="http://www.joda.org/joda-time/">Joda Time</a> date/time API is on the classpath: any implementations of <code>ReadablePartial</code> and <code>ReadableInstant</code></p>
</dd>
<dt class="hdlist1">Hibernate metadata impact</dt>
<dd>
<p>None</p>
</dd>
</dl>
</div>
</dd>
<dt class="hdlist1"><code>@Max(value=)</code></dt>
<dd>
<p>Checks whether the annotated value is less than or equal to the specified maximum</p>
<div class="dlist">
<dl>
<dt class="hdlist1">Supported data types</dt>
<dd>
<p><code>BigDecimal</code>, <code>BigInteger</code>, <code>byte</code>, <code>short</code>, <code>int</code>, <code>long</code> and the respective wrappers of the primitive types; additionally supported by HV: any sub-type of <code>CharSequence</code> (the numeric value represented by the character sequence is evaluated), any sub-type of <code>Number</code> and <code>javax.money.MonetaryAmount</code></p>
</dd>
<dt class="hdlist1">Hibernate metadata impact</dt>
<dd>
<p>Adds a check constraint on the column</p>
</dd>
</dl>
</div>
</dd>
<dt class="hdlist1"><code>@Min(value=)</code></dt>
<dd>
<p>Checks whether the annotated value is higher than or equal to the specified minimum</p>
<div class="dlist">
<dl>
<dt class="hdlist1">Supported data types</dt>
<dd>
<p><code>BigDecimal</code>, <code>BigInteger</code>, <code>byte</code>, <code>short</code>, <code>int</code>, <code>long</code> and the respective wrappers of the primitive types; additionally supported by HV: any sub-type of <code>CharSequence</code> (the numeric value represented by the character sequence is evaluated), any sub-type of <code>Number</code> and <code>javax.money.MonetaryAmount</code></p>
</dd>
<dt class="hdlist1">Hibernate metadata impact</dt>
<dd>
<p>Adds a check constraint on the column</p>
</dd>
</dl>
</div>
</dd>
<dt class="hdlist1"><code>@NotNull</code></dt>
<dd>
<p>Checks that the annotated value is not <code>null</code></p>
<div class="dlist">
<dl>
<dt class="hdlist1">Supported data types</dt>
<dd>
<p>Any type</p>
</dd>
<dt class="hdlist1">Hibernate metadata impact</dt>
<dd>
<p>Column(s) are not nullable</p>
</dd>
</dl>
</div>
</dd>
<dt class="hdlist1"><code>@Null</code></dt>
<dd>
<p>Checks that the annotated value is <code>null</code></p>
<div class="dlist">
<dl>
<dt class="hdlist1">Supported data types</dt>
<dd>
<p>Any type</p>
</dd>
<dt class="hdlist1">Hibernate metadata impact</dt>
<dd>
<p>None</p>
</dd>
</dl>
</div>
</dd>
<dt class="hdlist1"><code>@Past</code></dt>
<dd>
<p>Checks whether the annotated date is in the past</p>
<div class="dlist">
<dl>
<dt class="hdlist1">Supported data types</dt>
<dd>
<p><code>java.util.Date</code>, <code>java.util.Calendar</code>, <code>java.time.chrono.ChronoZonedDateTime</code>, <code>java.time.Instant</code>, <code>java.time.OffsetDateTime</code>; Additionally supported by HV, if the <a href="http://www.joda.org/joda-time/">Joda Time</a> date/time API is on the classpath: any implementations of <code>ReadablePartial</code> and <code>ReadableInstant</code></p>
</dd>
<dt class="hdlist1">Hibernate metadata impact</dt>
<dd>
<p>None</p>
</dd>
</dl>
</div>
</dd>
<dt class="hdlist1"><code>@Pattern(regex=, flags=)</code></dt>
<dd>
<p>Checks if the annotated string matches the regular expression <code>regex</code> considering the given flag <code>match</code></p>
<div class="dlist">
<dl>
<dt class="hdlist1">Supported data types</dt>
<dd>
<p><code>CharSequence</code></p>
</dd>
<dt class="hdlist1">Hibernate metadata impact</dt>
<dd>
<p>None</p>
</dd>
</dl>
</div>
</dd>
<dt class="hdlist1"><code>@Size(min=, max=)</code></dt>
<dd>
<p>Checks if the annotated element&#8217;s size is between <code>min</code> and <code>max</code> (inclusive)</p>
<div class="dlist">
<dl>
<dt class="hdlist1">Supported data types</dt>
<dd>
<p><code>CharSequence</code>, <code>Collection</code>, <code>Map</code> and arrays</p>
</dd>
<dt class="hdlist1">Hibernate metadata impact</dt>
<dd>
<p>Column length will be set to <code>max</code></p>
</dd>
</dl>
</div>
</dd>
<dt class="hdlist1"><code>@Valid</code></dt>
<dd>
<p>Performs validation recursively on the associated object. If the object is a collection or an array, the elements are validated recursively. If the object is a map, the value elements are validated recursively.</p>
<div class="dlist">
<dl>
<dt class="hdlist1">Supported data types</dt>
<dd>
<p>Any non-primitive type</p>
</dd>
<dt class="hdlist1">Hibernate metadata impact</dt>
<dd>
<p>None</p>
</dd>
</dl>
</div>
</dd>
</dl>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>On top of the parameters listed above each constraint has the parameters
message, groups and payload. This is a requirement of the Bean Validation specification.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="validator-defineconstraints-hv-constraints"><a class="anchor" href="#validator-defineconstraints-hv-constraints"></a>2.3.2. Additional constraints</h4>
<div class="paragraph">
<p>In addition to the constraints defined by the Bean Validation API Hibernate Validator provides several useful custom constraints which are listed below.
With one exception also these constraints apply to the field/property level, only <code>@ScriptAssert</code> is a class-level constraint.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>@CreditCardNumber(ignoreNonDigitCharacters=)</code></dt>
<dd>
<p>Checks that the annotated character sequence passes the Luhn checksum test. Note, this validation aims to check for user mistakes, not credit card validity! See also <a href="http://www.merriampark.com/anatomycc.htm">Anatomy of Credit Card Numbers</a>. <code>ignoreNonDigitCharacters</code> allows to ignore non digit characters. The default is <code>false</code>.</p>
<div class="dlist">
<dl>
<dt class="hdlist1">Supported data types</dt>
<dd>
<p><code>CharSequence</code></p>
</dd>
<dt class="hdlist1">Hibernate metadata impact</dt>
<dd>
<p>None</p>
</dd>
</dl>
</div>
</dd>
<dt class="hdlist1"><code>@Currency(value=)</code></dt>
<dd>
<p>Checks that the currency unit of the annotated <code>javax.money.MonetaryAmount</code> is part of the specified currency units.</p>
<div class="dlist">
<dl>
<dt class="hdlist1">Supported data types</dt>
<dd>
<p>any sub-type of <code>javax.money.MonetaryAmount</code> (if the <a href="https://jcp.org/en/jsr/detail?id=354">JSR 354 API</a> and an implementation is on the class path)</p>
</dd>
<dt class="hdlist1">Hibernate metadata impact</dt>
<dd>
<p>None</p>
</dd>
</dl>
</div>
</dd>
<dt class="hdlist1"><code>@EAN</code></dt>
<dd>
<p>Checks that the annotated character sequence is a valid <a href="http://en.wikipedia.org/wiki/International_Article_Number_%28EAN%29">EAN</a> barcode. type determines the type of barcode. The default is EAN-13.</p>
<div class="dlist">
<dl>
<dt class="hdlist1">Supported data types</dt>
<dd>
<p><code>CharSequence</code></p>
</dd>
<dt class="hdlist1">Hibernate metadata impact</dt>
<dd>
<p>None</p>
</dd>
</dl>
</div>
</dd>
<dt class="hdlist1"><code>@Email</code></dt>
<dd>
<p>Checks whether the specified character sequence is a valid email address. The optional parameters <code>regexp</code> and <code>flags</code> allow to specify an additional regular expression (including regular expression flags) which the email must match.</p>
<div class="dlist">
<dl>
<dt class="hdlist1">Supported data types</dt>
<dd>
<p><code>CharSequence</code></p>
</dd>
<dt class="hdlist1">Hibernate metadata impact</dt>
<dd>
<p>None</p>
</dd>
</dl>
</div>
</dd>
<dt class="hdlist1"><code>@Length(min=, max=)</code></dt>
<dd>
<p>Validates that the annotated character sequence is between <code>min</code> and <code>max</code> included</p>
<div class="dlist">
<dl>
<dt class="hdlist1">Supported data types</dt>
<dd>
<p><code>CharSequence</code></p>
</dd>
<dt class="hdlist1">Hibernate metadata impact</dt>
<dd>
<p>Column length will be set to max</p>
</dd>
</dl>
</div>
</dd>
<dt class="hdlist1"><code>@LuhnCheck(startIndex= , endIndex=, checkDigitIndex=, ignoreNonDigitCharacters=)</code></dt>
<dd>
<p>Checks that the digits within the annotated character sequence pass the Luhn checksum algorithm (see also <a href="http://en.wikipedia.org/wiki/Luhn_algorithm">Luhn algorithm</a>). <code>startIndex</code> and <code>endIndex</code> allow to only run the algorithm on the specified sub-string. <code>checkDigitIndex</code> allows to use an arbitrary digit within the character sequence as the check digit. If not specified it is assumed that the check digit is part of the specified range. Last but not least, <code>ignoreNonDigitCharacters</code> allows to ignore non digit characters.</p>
<div class="dlist">
<dl>
<dt class="hdlist1">Supported data types</dt>
<dd>
<p><code>CharSequence</code></p>
</dd>
<dt class="hdlist1">Hibernate metadata impact</dt>
<dd>
<p>None</p>
</dd>
</dl>
</div>
</dd>
<dt class="hdlist1"><code>@Mod10Check(multiplier=, weight=, startIndex=, endIndex=, checkDigitIndex=, ignoreNonDigitCharacters=)</code></dt>
<dd>
<p>Checks that the digits within the annotated character sequence pass the generic mod 10 checksum algorithm. <code>multiplier</code> determines the multiplier for odd numbers (defaults to 3), <code>weight</code> the weight for even numbers (defaults to 1). <code>startIndex</code> and <code>endIndex</code> allow to only run the algorithm on the specified sub-string. <code>checkDigitIndex</code> allows to use an arbitrary digit within the character sequence as the check digit. If not specified it is assumed that the check digit is part of the specified range. Last but not least, <code>ignoreNonDigitCharacters</code> allows to ignore non digit characters.</p>
<div class="dlist">
<dl>
<dt class="hdlist1">Supported data types</dt>
<dd>
<p><code>CharSequence</code></p>
</dd>
<dt class="hdlist1">Hibernate metadata impact</dt>
<dd>
<p>None</p>
</dd>
</dl>
</div>
</dd>
<dt class="hdlist1"><code>@Mod11Check(threshold=, startIndex=, endIndex=, checkDigitIndex=, ignoreNonDigitCharacters=, treatCheck10As=, treatCheck11As=)</code></dt>
<dd>
<p>Checks that the digits within the annotated character sequence pass the mod 11 checksum algorithm. <code>threshold</code> specifies the threshold for the mod11 multiplier growth; if no value is specified the multiplier will grow indefinitely. <code>treatCheck10As</code> and <code>treatCheck11As</code> specify the check digits to be used when the mod 11 checksum equals 10 or 11, respectively. Default to X and 0, respectively. <code>startIndex</code>, <code>endIndex</code> <code>checkDigitIndex</code> and <code>ignoreNonDigitCharacters</code> carry the same semantics as in <code>@Mod10Check</code>.</p>
<div class="dlist">
<dl>
<dt class="hdlist1">Supported data types</dt>
<dd>
<p><code>CharSequence</code></p>
</dd>
<dt class="hdlist1">Hibernate metadata impact</dt>
<dd>
<p>None</p>
</dd>
</dl>
</div>
</dd>
<dt class="hdlist1"><code>@NotBlank</code></dt>
<dd>
<p>Checks that the annotated character sequence is not null and the trimmed length is greater than 0. The difference to <code>@NotEmpty</code> is that this constraint can only be applied on strings and that trailing white-spaces are ignored.</p>
<div class="dlist">
<dl>
<dt class="hdlist1">Supported data types</dt>
<dd>
<p><code>CharSequence</code></p>
</dd>
<dt class="hdlist1">Hibernate metadata impact</dt>
<dd>
<p>None</p>
</dd>
</dl>
</div>
</dd>
<dt class="hdlist1"><code>@NotEmpty</code></dt>
<dd>
<p>Checks whether the annotated element is not null nor empty</p>
<div class="dlist">
<dl>
<dt class="hdlist1">Supported data types</dt>
<dd>
<p><code>CharSequence</code>, <code>Collection</code>, <code>Map</code> and arrays</p>
</dd>
<dt class="hdlist1">Hibernate metadata impact</dt>
<dd>
<p>None</p>
</dd>
</dl>
</div>
</dd>
<dt class="hdlist1"><code>@Range(min=, max=)</code></dt>
<dd>
<p>Checks whether the annotated value lies between (inclusive) the specified minimum and maximum</p>
<div class="dlist">
<dl>
<dt class="hdlist1">Supported data types</dt>
<dd>
<p><code>BigDecimal</code>, <code>BigInteger</code>, <code>CharSequence</code>, <code>byte</code>, <code>short</code>, <code>int</code>, <code>long</code> and the respective wrappers of the primitive types</p>
</dd>
<dt class="hdlist1">Hibernate metadata impact</dt>
<dd>
<p>None</p>
</dd>
</dl>
</div>
</dd>
<dt class="hdlist1"><code>@SafeHtml(whitelistType= , additionalTags=, additionalTagsWithAttributes=)</code></dt>
<dd>
<p>Checks whether the annotated value contains potentially malicious fragments such as <code>&lt;script/&gt;</code>. In order to use this constraint, the <a href="http://jsoup.org/">jsoup</a> library must be part of the class path. With the <code>whitelistType</code> attribute a predefined whitelist type can be chosen which can be refined via <code>additionalTags</code> or <code>additionalTagsWithAttributes</code>. The former allows to add tags without any attributes, whereas the latter allows to specify tags and optionally allowed attributes using the annotation <code>@SafeHtml.Tag</code>.</p>
<div class="dlist">
<dl>
<dt class="hdlist1">Supported data types</dt>
<dd>
<p><code>CharSequence</code></p>
</dd>
<dt class="hdlist1">Hibernate metadata impact</dt>
<dd>
<p>None</p>
</dd>
</dl>
</div>
</dd>
<dt class="hdlist1"><code>@ScriptAssert(lang=, script=, alias=, reportOn=)</code></dt>
<dd>
<p>Checks whether the given script can successfully be evaluated against the annotated element. In order to use this constraint, an implementation of the Java Scripting API as defined by JSR 223 ("Scripting for the Java<sup>TM</sup> Platform") must be a part of the class path. The expressions to be evaluated can be written in any scripting or expression language, for which a JSR 223 compatible engine can be found in the class path. Even though this is a class-level constraint, one can use the <code>reportOn</code> attribute to report a constraint violation on a specific property rather than the whole object.</p>
<div class="dlist">
<dl>
<dt class="hdlist1">Supported data types</dt>
<dd>
<p>Any type</p>
</dd>
<dt class="hdlist1">Hibernate metadata impact</dt>
<dd>
<p>None</p>
</dd>
</dl>
</div>
</dd>
<dt class="hdlist1"><code>@URL(protocol=, host=, port=, regexp=, flags=)</code></dt>
<dd>
<p>Checks if the annotated character sequence is a valid URL according to RFC2396. If any of the optional parameters <code>protocol</code>, <code>host</code> or <code>port</code> are specified, the corresponding URL fragments must match the specified values. The optional parameters <code>regexp</code> and <code>flags</code> allow to specify an additional regular expression (including regular expression flags) which the URL must match. Per default this constraint used the <code>java.net.URL</code> constructor to verify whether a given string represents a valid URL. A regular expression based version is also available - <code>RegexpURLValidator</code> - which can be configured via XML (see <a href="#section-mapping-xml-constraints">Mapping constraints via <code>constraint-mappings</code></a>) or the programmatic API (see <a href="#section-programmatic-constraint-definition">Adding constraint definitions programmatically</a>).</p>
<div class="dlist">
<dl>
<dt class="hdlist1">Supported data types</dt>
<dd>
<p><code>CharSequence</code></p>
</dd>
<dt class="hdlist1">Hibernate metadata impact</dt>
<dd>
<p>None</p>
</dd>
</dl>
</div>
</dd>
</dl>
</div>
<div class="sect4">
<h5 id="_country_specific_constraints"><a class="anchor" href="#_country_specific_constraints"></a>Country specific constraints</h5>
<div class="paragraph">
<p>Hibernate Validator offers also some country specific constraints, e.g. for the validation of social
security numbers.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If you have to implement a country specific constraint, consider making it a contribution to
Hibernate Validator!</p>
</div>
</td>
</tr>
</table>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>@CNPJ</code></dt>
<dd>
<p>Checks that the annotated character sequence represents a Brazilian corporate tax payer registry number (Cadastro de Pessoa Juríeddica)</p>
<div class="dlist">
<dl>
<dt class="hdlist1">Supported data types</dt>
<dd>
<p><code>CharSequence</code></p>
</dd>
<dt class="hdlist1">Hibernate metadata impact</dt>
<dd>
<p>None</p>
</dd>
<dt class="hdlist1">Country</dt>
<dd>
<p>Brazil</p>
</dd>
</dl>
</div>
</dd>
<dt class="hdlist1"><code>@CPF</code></dt>
<dd>
<p>Checks that the annotated character sequence represents a Brazilian individual taxpayer registry number (Cadastro de Pessoa Fídsica)</p>
<div class="dlist">
<dl>
<dt class="hdlist1">Supported data types</dt>
<dd>
<p><code>CharSequence</code></p>
</dd>
<dt class="hdlist1">Hibernate metadata impact</dt>
<dd>
<p>None</p>
</dd>
<dt class="hdlist1">Country</dt>
<dd>
<p>Brazil</p>
</dd>
</dl>
</div>
</dd>
<dt class="hdlist1"><code>@TituloEleitoral</code></dt>
<dd>
<p>Checks that the annotated character sequence represents a Brazilian voter ID card number (<a href="http://www.exceldoseujeito.com.br/2008/12/19/validar-cpf-cnpj-e-titulo-de-eleitor-parte-ii/">Título Eleitoral</a>)</p>
<div class="dlist">
<dl>
<dt class="hdlist1">Supported data types</dt>
<dd>
<p><code>CharSequence</code></p>
</dd>
<dt class="hdlist1">Hibernate metadata impact</dt>
<dd>
<p>None</p>
</dd>
<dt class="hdlist1">Country</dt>
<dd>
<p>Brazil</p>
</dd>
</dl>
</div>
</dd>
<dt class="hdlist1"><code>@NIP</code></dt>
<dd>
<p>Checks that the annotated character sequence represents a Polish VAT identification number (<a href="https://pl.wikipedia.org/wiki/NIP">NIP</a>)</p>
<div class="dlist">
<dl>
<dt class="hdlist1">Supported data types</dt>
<dd>
<p><code>CharSequence</code></p>
</dd>
<dt class="hdlist1">Hibernate metadata impact</dt>
<dd>
<p>None</p>
</dd>
<dt class="hdlist1">Country</dt>
<dd>
<p>Poland</p>
</dd>
</dl>
</div>
</dd>
<dt class="hdlist1"><code>@PESEL</code></dt>
<dd>
<p>Checks that the annotated character sequence represents a Polish national identification number (<a href="https://pl.wikipedia.org/wiki/PESEL">PESEL</a>)</p>
<div class="dlist">
<dl>
<dt class="hdlist1">Supported data types</dt>
<dd>
<p><code>CharSequence</code></p>
</dd>
<dt class="hdlist1">Hibernate metadata impact</dt>
<dd>
<p>None</p>
</dd>
<dt class="hdlist1">Country</dt>
<dd>
<p>Poland</p>
</dd>
</dl>
</div>
</dd>
<dt class="hdlist1"><code>@REGON</code></dt>
<dd>
<p>Checks that the annotated character sequence represents a Polish taxpayer identification number (<a href="https://pl.wikipedia.org/wiki/REGON">REGON</a>). Can be applied to both 9 and 14 digits versions of REGON</p>
<div class="dlist">
<dl>
<dt class="hdlist1">Supported data types</dt>
<dd>
<p><code>CharSequence</code></p>
</dd>
<dt class="hdlist1">Hibernate metadata impact</dt>
<dd>
<p>None</p>
</dd>
<dt class="hdlist1">Country</dt>
<dd>
<p>Poland</p>
</dd>
</dl>
</div>
</dd>
</dl>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>In some cases neither the Bean Validation constraints nor the custom constraints provided by
Hibernate Validator will fulfill your requirements. In this case you can easily write your own
constraint. You can find more information in <a href="#validator-customconstraints">Creating custom constraints</a>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="chapter-method-constraints"><a class="anchor" href="#chapter-method-constraints"></a>3. Declaring and validating method constraints</h2>
<div class="sectionbody">
<div class="paragraph">
<p>As of Bean Validation 1.1, constraints can not only be applied to JavaBeans and their properties,
but also to the parameters and return values of the methods and constructors of any Java type. That
way Bean Validation constraints can be used to specify</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the preconditions that must be satisfied by the caller before a method or constructor may be
invoked (by applying constraints to the parameters of an executable)</p>
</li>
<li>
<p>the postconditions that are guaranteed to the caller after a method or constructor invocation
returns (by applying constraints to the return value of an executable)</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>For the purpose of this reference guide, the term <em>method constraint</em> refers to both, method and
constructor constraints, if not stated otherwise. Occasionally, the term <em>executable</em> is used when
referring to methods and constructors.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This approach has several advantages over traditional ways of checking the correctness of parameters
and return values:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the checks don&#8217;t have to be performed manually (e.g. by throwing <code>IllegalArgumentException</code> or
similar), resulting in less code to write and maintain</p>
</li>
<li>
<p>an executable&#8217;s pre- and postconditions don&#8217;t have to be expressed again in its documentation,
since the constraint annotations will automatically be included in the generated JavaDoc. This
avoids redundancies and reduces the chance of inconsistencies between implementation and
documentation</p>
</li>
</ul>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>In order to make annotations show up in the JavaDoc of annotated elements, the annotation types
themselves must be annotated with the meta annotation @Documented. This is the case for all built-in
constraints and is considered a best practice for any custom constraints.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In the remainder of this chapter you will learn how to declare parameter and return value
constraints and how to validate them using the <code>ExecutableValidator</code> API.</p>
</div>
<div class="sect2">
<h3 id="section-declaring-method-constraints"><a class="anchor" href="#section-declaring-method-constraints"></a>3.1. Declaring method constraints</h3>
<div class="sect3">
<h4 id="_parameter_constraints"><a class="anchor" href="#_parameter_constraints"></a>3.1.1. Parameter constraints</h4>
<div class="paragraph">
<p>You specify the preconditions of a method or constructor by adding constraint annotations to its
parameters as demonstrated in <a href="#example-declaring-parameter-constraints">Declaring method and constructor parameter constraints</a>.</p>
</div>
<div id="example-declaring-parameter-constraints" class="exampleblock">
<div class="title">Example 24. Declaring method and constructor parameter constraints</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter03.parameter;

public class RentalStation {

    public RentalStation(@NotNull String name) {
        //...
    }

    public void rentCar(
            @NotNull Customer customer,
            @NotNull @Future Date startDate,
            @Min(1) int durationInDays) {
        //...
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The following preconditions are declared here:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <code>name</code> passed to the <code>RentalCar</code> constructor must not be <code>null</code></p>
</li>
<li>
<p>When invoking the <code>rentCar()</code> method, the given <code>customer</code> must not be <code>null</code>, the rental&#8217;s start
date must not be <code>null</code> as well as be in the future and finally the rental duration must be at least
one day</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Note that declaring method or constructor constraints itself does not automatically cause their
validation upon invocation of the executable. Instead, the <code>ExecutableValidator</code> API (see
<a href="#section-validating-executable-constraints">Validating method constraints</a>) must be used to perform the validation, which is
often done using a method interception facility such as AOP, proxy objects etc.</p>
</div>
<div class="paragraph">
<p>Constraints may only be applied to instance methods, i.e. declaring constraints on static methods is
not supported. Depending on the interception facility you use for triggering method validation,
additional restrictions may apply, e.g. with respect to the visibility of methods supported as
target of interception. Refer to the documentation of the interception technology to find out
whether any such limitations exist.</p>
</div>
<div class="sect4">
<h5 id="_cross_parameter_constraints"><a class="anchor" href="#_cross_parameter_constraints"></a>Cross-parameter constraints</h5>
<div class="paragraph">
<p>Sometimes validation does not only depend on a single parameter but on several or even all
parameters of a method or constructor. This kind of requirement can be fulfilled with help of a
cross-parameter constraint.</p>
</div>
<div class="paragraph">
<p>Cross-parameter constraints can be considered as the method validation equivalent to class-level
constraints. Both can be used to implement validation requirements which are based on several
elements. While class-level constraints apply to several properties of a bean, cross-parameter
constraints apply to several parameters of an executable.</p>
</div>
<div class="paragraph">
<p>In contrast to single-parameter constraints, cross-parameter constraints are declared on the method
or constructor as you can see in <a href="#example-using-cross-parameter-constraint">Declaring a cross-parameter constraint</a>. Here the cross-
parameter constraint <code>@LuggageCountMatchesPassengerCount</code> declared on the <code>load()</code> method is used to
ensure that no passenger has more than two pieces of luggage.</p>
</div>
<div id="example-using-cross-parameter-constraint" class="exampleblock">
<div class="title">Example 25. Declaring a cross-parameter constraint</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter03.crossparameter;

public class Car {

    @LuggageCountMatchesPassengerCount(piecesOfLuggagePerPassenger = 2)
    public void load(List&lt;Person&gt; passengers, List&lt;PieceOfLuggage&gt; luggage) {
        //...
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>As you will learn in the next section, return value constraints are also declared on the method
level. In order to distinguish cross-parameter constraints from return value constraints, the
constraint target is configured in the <code>ConstraintValidator</code> implementation using the
<code>@SupportedValidationTarget</code> annotation. You can find out about the details in
<a href="#section-cross-parameter-constraints">Cross-parameter constraints</a> which shows how to implement your own cross-parameter constraint.</p>
</div>
<div class="paragraph">
<p>In some cases a constraint can be applied to an executable&#8217;s parameters (i.e. it is a cross-
parameter constraint), but also to the return value. One example for this are custom constraints
which allow to specify validation rules using expression or script languages.</p>
</div>
<div class="paragraph">
<p>Such constraints must define a member <code>validationAppliesTo()</code> which can be used at declaration time to
specify the constraint target. As shown in <a href="#example-specifying-constraint-target">Specifying a constraint&#8217;s target</a> you apply the
constraint to an executable&#8217;s parameters by specifying
<code>validationAppliesTo = ConstraintTarget.PARAMETERS</code>, while <code>ConstraintTarget.RETURN_VALUE</code> is used
to apply the constraint to the executable return value.</p>
</div>
<div id="example-specifying-constraint-target" class="exampleblock">
<div class="title">Example 26. Specifying a constraint&#8217;s target</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter03.crossparameter.constrainttarget;

public class Garage {

    @ELAssert(expression = "...", validationAppliesTo = ConstraintTarget.PARAMETERS)
    public Car buildCar(List&lt;Part&gt; parts) {
        //...
        return null;
    }

    @ELAssert(expression = "...", validationAppliesTo = ConstraintTarget.RETURN_VALUE)
    public Car paintCar(int color) {
        //...
        return null;
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Although such a constraint is applicable to the parameters and return value of an executable, the
target can often be inferred automatically. This is the case, if the constraint is declared on</p>
</div>
<div class="ulist">
<ul>
<li>
<p>a void method with parameters (the constraint applies to the parameters)</p>
</li>
<li>
<p>an executable with return value but no parameters (the constraint applies to the return value)</p>
</li>
<li>
<p>neither a method nor a constructor, but a field, parameter etc. (the constraint applies to the
annotated element)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In these situations you don&#8217;t have to specify the constraint target. It is still recommended to do
so if it increases readability of the source code. If the constraint target is not specified in
situations where it can&#8217;t be determined automatically, a ConstraintDeclarationException is raised.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_return_value_constraints"><a class="anchor" href="#_return_value_constraints"></a>3.1.2. Return value constraints</h4>
<div class="paragraph">
<p>The postconditions of a method or constructor are declared by adding constraint annotations to the
executable as shown in <a href="#example-declaring-return-value-constraints">Declaring method and constructor return value constraints</a>.</p>
</div>
<div id="example-declaring-return-value-constraints" class="exampleblock">
<div class="title">Example 27. Declaring method and constructor return value constraints</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter03.returnvalue;

public class RentalStation {

    @ValidRentalStation
    public RentalStation() {
        //...
    }

    @NotNull
    @Size(min = 1)
    public List&lt;Customer&gt; getCustomers() {
        //...
        return null;
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The following constraints apply to the executables of RentalStation:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Any newly created <code>RentalStation</code> object must satisfy the <code>@ValidRentalStation</code> constraint</p>
</li>
<li>
<p>The customer list returned by <code>getCustomers()</code> must not be <code>null</code> and must contain at least on element</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_cascaded_validation"><a class="anchor" href="#_cascaded_validation"></a>3.1.3. Cascaded validation</h4>
<div class="paragraph">
<p>Similar to the cascaded validation of JavaBeans properties (see
<a href="#section-object-graph-validation">Object graphs</a>), the <code>@Valid</code> annotation can be used to mark executable
parameters and return values for cascaded validation. When validating a parameter or return value
annotated with <code>@Valid</code>, the constraints declared on the parameter or return value object are
validated as well.</p>
</div>
<div class="paragraph">
<p>In <a href="#example-cascaded-executable-validation">Marking executable parameters and return values for cascaded validation</a>, the <code>car</code> parameter of the method <code>Garage#checkCar()</code> as
well as the return value of the <code>Garage</code> constructor are marked for cascaded validation.</p>
</div>
<div id="example-cascaded-executable-validation" class="exampleblock">
<div class="title">Example 28. Marking executable parameters and return values for cascaded validation</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter03.cascaded;

public class Garage {

    @NotNull
    private String name;

    @Valid
    public Garage(String name) {
        this.name = name;
    }

    public boolean checkCar(@Valid @NotNull Car car) {
        //...
        return false;
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter03.cascaded;

public class Car {

    @NotNull
    private String manufacturer;

    @NotNull
    @Size(min = 2, max = 14)
    private String licensePlate;

    public Car(String manufacturer, String licencePlate) {
        this.manufacturer = manufacturer;
        this.licensePlate = licencePlate;
    }

    //getters and setters ...
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>When validating the arguments of the <code>checkCar()</code> method, the constraints on the properties of the
passed <code>Car</code> object are evaluated as well. Similarly, the <code>@NotNull</code> constraint on the name field of
<code>Garage</code> is checked when validating the return value of the <code>Garage</code> constructor.</p>
</div>
<div class="paragraph">
<p>Generally, the cascaded validation works for executables in exactly the same way as it does for
JavaBeans properties.</p>
</div>
<div class="paragraph">
<p>In particular, <code>null</code> values are ignored during cascaded validation (naturally this can&#8217;t happen
during constructor return value validation) and cascaded validation is performed recursively, i.e.
if a parameter or return value object which is marked for cascaded validation itself has properties
marked with <code>@Valid</code>, the constraints declared on the referenced elements will be validated as well.</p>
</div>
<div class="paragraph">
<p>Cascaded validation can not only be applied to simple object references but also to collection-typed
parameters and return values. This means when putting the <code>@Valid</code> annotation to a parameter or return
value which</p>
</div>
<div class="ulist">
<ul>
<li>
<p>is an array</p>
</li>
<li>
<p>implements <code>java.lang.Iterable</code></p>
</li>
<li>
<p>or implements <code>java.util.Map</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>each contained element gets validated. So when validating the arguments of the <code>checkCars()</code> method in
<a href="#example-cascaded-executable-validation-listtyped">List-typed method parameter marked for cascaded validation</a>, each element instance of the passed list will
be validated and a <code>ConstraintViolation</code> created when any of the contained <code>Car</code> instances is invalid.</p>
</div>
<div id="example-cascaded-executable-validation-listtyped" class="exampleblock">
<div class="title">Example 29. List-typed method parameter marked for cascaded validation</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter03.cascaded.collection;

public class Garage {

    public boolean checkCars(@Valid @NotNull List&lt;Car&gt; cars) {
        //...
        return false;
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="section-method-constraints-inheritance-hierarchies"><a class="anchor" href="#section-method-constraints-inheritance-hierarchies"></a>3.1.4. Method constraints in inheritance hierarchies</h4>
<div class="paragraph">
<p>When declaring method constraints in inheritance hierarchies, it is important to be aware of the
following rules:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The preconditions to be satisfied by the caller of a method may not be strengthened in subtypes</p>
</li>
<li>
<p>The postconditions guaranteed to the caller of a method may not be weakened in subtypes</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These rules are motivated by the concept of <em>behavioral subtyping</em> which requires that wherever a
type <code>T</code> is used, also a subtype <code>S</code> of <code>T</code> may be used without altering the program&#8217;s behavior.</p>
</div>
<div class="paragraph">
<p>As an example, consider a class invoking a method on an object with the static type <code>T</code>. If the
runtime type of that object was <code>S</code> and <code>S</code> imposed additional preconditions, the client class might
fail to satisfy these preconditions as is not aware of them. The rules of behavioral subtyping are
also known as the <a href="http://en.wikipedia.org/wiki/Liskov_substitution_principle">Liskov
substitution principle</a>.</p>
</div>
<div class="paragraph">
<p>The Bean Validation specification implements the first rule by disallowing parameter constraints on
methods which override or implement a method declared in a supertype (superclass or interface).
<a href="#example-illegal-parameter-constraints">Illegal method parameter constraint in subtype</a> shows a violation of this rule.</p>
</div>
<div id="example-illegal-parameter-constraints" class="exampleblock">
<div class="title">Example 30. Illegal method parameter constraint in subtype</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter03.inheritance.parameter;

public interface Vehicle {

    void drive(@Max(75) int speedInMph);
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter03.inheritance.parameter;

public class Car implements Vehicle {

    @Override
    public void drive(@Max(55) int speedInMph) {
        //...
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The <code>@Max</code> constraint on <code>Car#drive()</code> is illegal since this method implements the interface method
<code>Vehicle#drive()</code>. Note that parameter constraints on overriding methods are also disallowed, if the
supertype method itself doesn&#8217;t declare any parameter constraints.</p>
</div>
<div class="paragraph">
<p>Furthermore, if a method overrides or implements a method declared in several parallel supertypes
(e.g. two interfaces not extending each other or a class and an interface not implemented by that
class), no parameter constraints may be specified for the method in any of the involved types. The
types in <a href="#example-illegal-parameter-constraints-parallel-types">Illegal method parameter constraint in parallel types of a hierarchy</a> demonstrate a violation of that
rule. The method <code>RacingCar#drive()</code> overrides <code>Vehicle#drive()</code> as well as <code>Car#drive()</code>.
Therefore the constraint on <code>Vehicle#drive()</code> is illegal.</p>
</div>
<div id="example-illegal-parameter-constraints-parallel-types" class="exampleblock">
<div class="title">Example 31. Illegal method parameter constraint in parallel types of a hierarchy</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter03.inheritance.parallel;

public interface Vehicle {

    void drive(@Max(75) int speedInMph);
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter03.inheritance.parallel;

public interface Car {

    void drive(int speedInMph);
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter03.inheritance.parallel;

public class RacingCar implements Car, Vehicle {

    @Override
    public void drive(int speedInMph) {
        //...
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The previously described restrictions only apply to parameter constraints. In contrast, return value
constraints may be added in methods overriding or implementing any supertype methods.</p>
</div>
<div class="paragraph">
<p>In this case, all the method&#8217;s return value constraints apply for the subtype method, i.e. the
constraints declared on the subtype method itself as well as any return value constraints on
overridden/implemented supertype methods. This is legal as putting additional return value
constraints in place may never represent a weakening of the postconditions guaranteed to the caller
of a method.</p>
</div>
<div class="paragraph">
<p>So when validating the return value of the method <code>Car#getPassengers()</code> shown in
<a href="#example-return-value-constraints-in-hierarchy">Return value constraints on supertype and subtype method</a>, the <code>@Size</code> constraint on the method itself as well
as the <code>@NotNull</code> constraint on the implemented interface method <code>Vehicle#getPassengers()</code> apply.</p>
</div>
<div id="example-return-value-constraints-in-hierarchy" class="exampleblock">
<div class="title">Example 32. Return value constraints on supertype and subtype method</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter03.inheritance.returnvalue;

public interface Vehicle {

    @NotNull
    List&lt;Person&gt; getPassengers();
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter03.inheritance.returnvalue;

public class Car implements Vehicle {

    @Override
    @Size(min = 1)
    public List&lt;Person&gt; getPassengers() {
        //...
        return null;
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>If the validation engine detects a violation of any of the aforementioned rules, a
<code>ConstraintDeclarationException</code> will be raised.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The rules described in this section only apply to methods but not constructors. By definition,
constructors never override supertype constructors. Therefore, when validating the parameters or the
return value of a constructor invocation only the constraints declared on the constructor itself
apply, but never any constraints declared on supertype constructors.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Enforcement of these rules may be relaxed by setting the configuration parameters contained in
the <code>MethodValidationConfiguration</code> property of the <code>HibernateValidatorConfiguration</code> before creating
the <code>Validator</code> instance. See also <a href="#section-method-validation-prerequisite-relaxation">Relaxation of requirements for method validation in class hierarchies</a>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="section-validating-executable-constraints"><a class="anchor" href="#section-validating-executable-constraints"></a>3.2. Validating method constraints</h3>
<div class="paragraph">
<p>The validation of method constraints is done using the <code>ExecutableValidator</code> interface.</p>
</div>
<div class="paragraph">
<p>In <a href="#section-obtaining-executable-validator">Obtaining an <code>ExecutableValidator</code> instance</a> you will learn how to obtain an <code>ExecutableValidator</code>
instance while <a href="#section-executable-validator-methods"><code>ExecutableValidator</code> methods</a> shows how to use the different methods
offered by this interface.</p>
</div>
<div class="paragraph">
<p>Instead of calling the <code>ExecutableValidator</code> methods directly from within application code, they are
usually invoked via a method interception technology such as AOP, proxy objects, etc. This causes
executable constraints to be validated automatically and transparently upon method or constructor
invocation. Typically a <code>ConstraintViolationException</code> is raised by the integration layer in case any
of the constraints is violated.</p>
</div>
<div class="sect3">
<h4 id="section-obtaining-executable-validator"><a class="anchor" href="#section-obtaining-executable-validator"></a>3.2.1. Obtaining an <code>ExecutableValidator</code> instance</h4>
<div class="paragraph">
<p>You can retrieve an <code>ExecutableValidator</code> instance via <code>Validator#forExecutables()</code> as shown in
<a href="#example-obtaining-executable-validator">Obtaining an <code>ExecutableValidator</code> instance</a>.</p>
</div>
<div id="example-obtaining-executable-validator" class="exampleblock">
<div class="title">Example 33. Obtaining an <code>ExecutableValidator</code> instance</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">ValidatorFactory factory = Validation.buildDefaultValidatorFactory();
executableValidator = factory.getValidator().forExecutables();</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>In the example the executable validator is retrieved from the default validator factory, but if
required you could also bootstrap a specifically configured factory as described in
<a href="#chapter-bootstrapping">Bootstrapping</a>, for instance in order to use a specific parameter name provider
(see <a href="#section-parameter-name-provider"><code>ParameterNameProvider</code></a>).</p>
</div>
</div>
<div class="sect3">
<h4 id="section-executable-validator-methods"><a class="anchor" href="#section-executable-validator-methods"></a>3.2.2. <code>ExecutableValidator</code> methods</h4>
<div class="paragraph">
<p>The <code>ExecutableValidator</code> interface offers altogether four methods:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>validateParameters()</code> and <code>validateReturnValue()</code> for method validation</p>
</li>
<li>
<p><code>validateConstructorParameters()</code> and <code>validateConstructorReturnValue()</code> for constructor validation</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Just as the methods on <code>Validator</code>, all these methods return a <code>Set&lt;ConstraintViolation&gt;</code> which contains
a <code>ConstraintViolation</code> instance for each violated constraint and which is empty if the validation
succeeds. Also all the methods have a var-args groups parameter by which you can pass the validation
groups to be considered for validation.</p>
</div>
<div class="paragraph">
<p>The examples in the following sections are based on the methods on constructors of the <code>Car</code> class
shown in <a href="#example-executable-validator-class-car">Class <code>Car</code> with constrained methods and constructors</a>.</p>
</div>
<div id="example-executable-validator-class-car" class="exampleblock">
<div class="title">Example 34. Class <code>Car</code> with constrained methods and constructors</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter03.validation;

public class Car {

    public Car(@NotNull String manufacturer) {
        //...
    }

    @ValidRacingCar
    public Car(String manufacturer, String team) {
        //...
    }

    public void drive(@Max(75) int speedInMph) {
        //...
    }

    @Size(min = 1)
    public List&lt;Passenger&gt; getPassengers() {
        //...
        return Collections.emptyList();
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="__code_executablevalidator_validateparameters_code"><a class="anchor" href="#__code_executablevalidator_validateparameters_code"></a><code>ExecutableValidator#validateParameters()</code></h5>
<div class="paragraph">
<p>The method <code>validateParameters()</code> is used to validate the arguments of a method invocation.
<a href="#example-executable-validator-validate-parameters">Using <code>ExecutableValidator#validateParameters()</code></a> shows an example. The validation results in a
violation of the <code>@Max</code> constraint on the parameter of the <code>drive()</code> method.</p>
</div>
<div id="example-executable-validator-validate-parameters" class="exampleblock">
<div class="title">Example 35. Using <code>ExecutableValidator#validateParameters()</code></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">Car object = new Car( "Morris" );
Method method = Car.class.getMethod( "drive", int.class );
Object[] parameterValues = { 80 };
Set&lt;ConstraintViolation&lt;Car&gt;&gt; violations = executableValidator.validateParameters(
        object,
        method,
        parameterValues
);

assertEquals( 1, violations.size() );
Class&lt;? extends Annotation&gt; constraintType = violations.iterator()
        .next()
        .getConstraintDescriptor()
        .getAnnotation()
        .annotationType();
assertEquals( Max.class, constraintType );</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Note that <code>validateParameters()</code> validates all the parameter constraints of a method, i.e. constraints
on individual parameters as well as cross-parameter constraints.</p>
</div>
</div>
<div class="sect4">
<h5 id="__code_executablevalidator_validatereturnvalue_code"><a class="anchor" href="#__code_executablevalidator_validatereturnvalue_code"></a><code>ExecutableValidator#validateReturnValue()</code></h5>
<div class="paragraph">
<p>Using <code>validateReturnValue()</code> the return value of a method can can be validated. The validation in
<a href="#example-executable-validator-validate-return-value">Using <code>ExecutableValidator#validateReturnValue()</code></a> yields one constraint violation since the
<code>getPassengers()</code> method is expect to return at least one <code>Passenger</code> instance.</p>
</div>
<div id="example-executable-validator-validate-return-value" class="exampleblock">
<div class="title">Example 36. Using <code>ExecutableValidator#validateReturnValue()</code></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">Car object = new Car( "Morris" );
Method method = Car.class.getMethod( "getPassengers" );
Object returnValue = Collections.&lt;Passenger&gt;emptyList();
Set&lt;ConstraintViolation&lt;Car&gt;&gt; violations = executableValidator.validateReturnValue(
        object,
        method,
        returnValue
);

assertEquals( 1, violations.size() );
Class&lt;? extends Annotation&gt; constraintType = violations.iterator()
        .next()
        .getConstraintDescriptor()
        .getAnnotation()
        .annotationType();
assertEquals( Size.class, constraintType );</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="__code_executablevalidator_validateconstructorparameters_code"><a class="anchor" href="#__code_executablevalidator_validateconstructorparameters_code"></a><code>ExecutableValidator#validateConstructorParameters()</code></h5>
<div class="paragraph">
<p>The arguments of constructor invocations can be validated with <code>validateConstructorParameters()</code> as
shown in method <a href="#example-executable-validator-validate-constructor-parameters">Using <code>ExecutableValidator#validateConstructorParameters()</code></a>. Due to the
<code>@NotNull</code> constraint on the manufacturer parameter, the validation call returns one constraint
violation.</p>
</div>
<div id="example-executable-validator-validate-constructor-parameters" class="exampleblock">
<div class="title">Example 37. Using <code>ExecutableValidator#validateConstructorParameters()</code></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">Constructor&lt;Car&gt; constructor = Car.class.getConstructor( String.class );
Object[] parameterValues = { null };
Set&lt;ConstraintViolation&lt;Car&gt;&gt; violations = executableValidator.validateConstructorParameters(
        constructor,
        parameterValues
);

assertEquals( 1, violations.size() );
Class&lt;? extends Annotation&gt; constraintType = violations.iterator()
        .next()
        .getConstraintDescriptor()
        .getAnnotation()
        .annotationType();
assertEquals( NotNull.class, constraintType );</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="__code_executablevalidator_validateconstructorreturnvalue_code"><a class="anchor" href="#__code_executablevalidator_validateconstructorreturnvalue_code"></a><code>ExecutableValidator#validateConstructorReturnValue()</code></h5>
<div class="paragraph">
<p>Finally, by using <code>validateConstructorReturnValue()</code> you can validate a constructor&#8217;s return value. In
<a href="#example-executable-validator-validate-constructor-return-value">Using <code>ExecutableValidator#validateConstructorReturnValue()</code></a>, <code>validateConstructorReturnValue()</code>
returns one constraint violation, since the <code>Car</code> instance returned by the constructor doesn&#8217;t satisfy
the <code>@ValidRacingCar</code> constraint (not shown).</p>
</div>
<div id="example-executable-validator-validate-constructor-return-value" class="exampleblock">
<div class="title">Example 38. Using <code>ExecutableValidator#validateConstructorReturnValue()</code></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">//constructor for creating racing cars
Constructor&lt;Car&gt; constructor = Car.class.getConstructor( String.class, String.class );
Car createdObject = new Car( "Morris", null );
Set&lt;ConstraintViolation&lt;Car&gt;&gt; violations = executableValidator.validateConstructorReturnValue(
        constructor,
        createdObject
);

assertEquals( 1, violations.size() );
Class&lt;? extends Annotation&gt; constraintType = violations.iterator()
        .next()
        .getConstraintDescriptor()
        .getAnnotation()
        .annotationType();
assertEquals( ValidRacingCar.class, constraintType );</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="__code_constraintviolation_code_methods_for_method_validation"><a class="anchor" href="#__code_constraintviolation_code_methods_for_method_validation"></a>3.2.3. <code>ConstraintViolation</code> methods for method validation</h4>
<div class="paragraph">
<p>In addition to the methods introduced in <a href="#section-constraint-violation-methods"><code>ConstraintViolation</code> methods</a>,
<code>ConstraintViolation</code> provides two more methods specific to the validation of executable parameters
and return values.</p>
</div>
<div class="paragraph">
<p><code>ConstraintViolation#getExecutableParameters()</code> returns the validated parameter array in case of
method or constructor parameter validation, while <code>ConstraintViolation#getExecutableReturnValue()</code>
provides access to the validated object in case of return value validation.</p>
</div>
<div class="paragraph">
<p>All the other <code>ConstraintViolation</code> methods generally work for method validation in the same way as
for validation of beans. Refer to the <a href="http://docs.jboss.org/hibernate/beanvalidation/spec/1.1
/api/index.html?javax/validation/metadata/BeanDescriptor.html">JavaDoc</a> to learn more about the
behavior of the individual methods and their return values during bean and method validation.</p>
</div>
<div class="paragraph">
<p>Note that <code>getPropertyPath()</code> can be very useful in order to obtain detailed information about the
validated parameter or return value, e.g. for logging purposes. In particular, you can retrieve name
and argument types of the concerned method as well as the index of the concerned parameter from the
path nodes. How this can be done is shown in <a href="#example-executable-validation-property-path">Retrieving method and parameter information</a>.</p>
</div>
<div id="example-executable-validation-property-path" class="exampleblock">
<div class="title">Example 39. Retrieving method and parameter information</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">Car object = new Car( "Morris" );
Method method = Car.class.getMethod( "drive", int.class );
Object[] parameterValues = { 80 };
Set&lt;ConstraintViolation&lt;Car&gt;&gt; violations = executableValidator.validateParameters(
        object,
        method,
        parameterValues
);

assertEquals( 1, violations.size() );
Iterator&lt;Node&gt; propertyPath = violations.iterator()
        .next()
        .getPropertyPath()
        .iterator();

MethodNode methodNode = propertyPath.next().as( MethodNode.class );
assertEquals( "drive", methodNode.getName() );
assertEquals( Arrays.&lt;Class&lt;?&gt;&gt;asList( int.class ), methodNode.getParameterTypes() );

ParameterNode parameterNode = propertyPath.next().as( ParameterNode.class );
assertEquals( "arg0", parameterNode.getName() );
assertEquals( 0, parameterNode.getParameterIndex() );</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The parameter name is determined using the current <code>ParameterNameProvider</code> (see
<a href="#section-parameter-name-provider"><code>ParameterNameProvider</code></a>) and defaults to <code>arg0</code>, <code>arg1</code> etc.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="section-builtin-method-constraints"><a class="anchor" href="#section-builtin-method-constraints"></a>3.3. Built-in method constraints</h3>
<div class="paragraph">
<p>In addition to the built-in bean and property-level constraints discussed in
<a href="#section-builtin-constraints">Built-in constraints</a>, Hibernate Validator currently provides one method-level constraint,
<code>@ParameterScriptAssert</code>. This is a generic cross-parameter constraint which allows to implement
validation routines using any JSR 223 compatible ("Scripting for the Java<sup>TM</sup> Platform") scripting
language, provided an engine for this language is available on the classpath.</p>
</div>
<div class="paragraph">
<p>To refer to the executable&#8217;s parameters from within the expression, use their name as obtained from
the active parameter name provider (see <a href="#section-parameter-name-provider"><code>ParameterNameProvider</code></a>).
<a href="#example-parameterscriptassert">Using <code>@ParameterScriptAssert</code></a> shows how the validation logic of the <code>@LuggageCountMatchesPassengerCount</code>
constraint from <a href="#example-using-cross-parameter-constraint">Declaring a cross-parameter constraint</a> could be expressed with the help of
<code>@ParameterScriptAssert</code>.</p>
</div>
<div id="example-parameterscriptassert" class="exampleblock">
<div class="title">Example 40. Using <code>@ParameterScriptAssert</code></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter03.parameterscriptassert;

public class Car {

    @ParameterScriptAssert(lang = "javascript", script = "arg1.size() &lt;= arg0.size() * 2")
    public void load(List&lt;Person&gt; passengers, List&lt;PieceOfLuggage&gt; luggage) {
        //...
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="chapter-message-interpolation"><a class="anchor" href="#chapter-message-interpolation"></a>4. Interpolating constraint error messages</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Message interpolation is the process of creating error messages for violated Bean Validation
constraints. In this chapter you will learn how such messages are defined and resolved and how you
can plug in custom message interpolators in case the default algorithm is not sufficient for your
requirements.</p>
</div>
<div class="sect2">
<h3 id="section-message-interpolation"><a class="anchor" href="#section-message-interpolation"></a>4.1. Default message interpolation</h3>
<div class="paragraph">
<p>Constraint violation messages are retrieved from so called message descriptors. Each constraint
defines its default message descriptor using the message attribute. At declaration time, the default
descriptor can be overridden with a specific value as shown in <a href="#example-overriding-message">Specifying a message descriptor using the message attribute</a>.</p>
</div>
<div id="example-overriding-message" class="exampleblock">
<div class="title">Example 41. Specifying a message descriptor using the message attribute</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter04;

public class Car {

    @NotNull(message = "The manufacturer name must not be null")
    private String manufacturer;

    //constructor, getters and setters ...
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>If a constraint is violated, its descriptor will be interpolated by the validation engine using the
currently configured <code>MessageInterpolator</code>. The interpolated error message can then be retrieved from
the resulting constraint violation by calling <code>ConstraintViolation#getMessage()</code>.</p>
</div>
<div class="paragraph">
<p>Message descriptors can contain <em>message parameters</em> as well as <em>message expressions</em> which will be
resolved during interpolation. Message parameters are string literals enclosed in <code>{}</code>, while
message expressions are string literals enclosed in <code>${}</code>. The following algorithm is applied during
method interpolation:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Resolve any message parameters by using them as key for the resource bundle <em>ValidationMessages</em>. If
this bundle contains an entry for a given message parameter, that parameter will be replaced in the
message with the corresponding value from the bundle. This step will be executed recursively in case
the replaced value again contains message parameters. The resource bundle is expected to be provided
by the application developer, e.g. by adding a file named <em>ValidationMessages.properties</em> to the
classpath. You can also create localized error messages by providing locale specific variations of
this bundle, such as <em>ValidationMessages_en_US.properties</em>. By default, the JVM&#8217;s default locale
(<code>Locale#getDefault()</code>) will be used when looking up messages in the bundle.</p>
</li>
<li>
<p>Resolve any message parameters by using them as key for a resource bundle containing the standard
error messages for the built-in constraints as defined in Appendix B of the Bean Validation
specification. In the case of Hibernate Validator, this bundle is named
<code>org.hibernate.validator.ValidationMessages</code>. If this step triggers a replacement, step 1 is executed
again, otherwise step 3 is applied.</p>
</li>
<li>
<p>Resolve any message parameters by replacing them with the value of the constraint annotation member
of the same name. This allows to refer to attribute values of the constraint (e.g. <code>Size#min()</code>) in
the error message (e.g. "must be at least ${min}").</p>
</li>
<li>
<p>Resolve any message expressions by evaluating them as expressions of the Unified Expression
Language. See <a href="#section-interpolation-with-message-expressions">Interpolation with message expressions</a> to learn more about the usage of
Unified EL in error messages.</p>
</li>
</ol>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>You can find the formal definition of the interpolation algorithm in section
<a href="http://beanvalidation.org/1.1/spec/#default-resolution-algorithm">5.3.1.1</a> of the Bean
Validation specification.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="section-special-characters"><a class="anchor" href="#section-special-characters"></a>4.1.1. Special characters</h4>
<div class="paragraph">
<p>Since the characters <code>{</code>, <code>}</code> and <code>$</code> have a special meaning in message descriptors they need to be escaped if you want to use them literally. The following rules apply:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>\{</code> is considered as the literal <code>{</code></p>
</li>
<li>
<p><code>\}</code> is considered as the literal <code>}</code></p>
</li>
<li>
<p><code>\$</code> is considered as the literal <code>$</code></p>
</li>
<li>
<p><code>\\</code> is considered as the literal <code>\</code></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="section-interpolation-with-message-expressions"><a class="anchor" href="#section-interpolation-with-message-expressions"></a>4.1.2. Interpolation with message expressions</h4>
<div class="paragraph">
<p>As of Hibernate Validator 5 (Bean Validation 1.1) it is possible to use the Unified Expression
Language (as defined by <a href="http://jcp.org/en/jsr/detail?id=341">JSR 341</a>) in constraint
violation messages. This allows to define error messages based on conditional logic and also enables
advanced formatting options. The validation engine makes the following objects available in the EL
context:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the attribute values of the constraint mapped to the attribute names</p>
</li>
<li>
<p>the currently validated value (property, bean, method parameter etc.) under the name <em>validatedValue</em></p>
</li>
<li>
<p>a bean mapped to the name formatter exposing the var-arg method
<code>format(String format, Object&#8230;&#8203; args)</code> which behaves like
<code>java.util.Formatter.format(String format, Object&#8230;&#8203; args)</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following section provides several examples for using EL expressions in error messages.</p>
</div>
</div>
<div class="sect3">
<h4 id="_examples"><a class="anchor" href="#_examples"></a>4.1.3. Examples</h4>
<div class="paragraph">
<p><a href="#example-message-descriptors">Specifying message descriptors</a> shows how to make use of the different options for specifying
message descriptors.</p>
</div>
<div id="example-message-descriptors" class="exampleblock">
<div class="title">Example 42. Specifying message descriptors</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter04.complete;

public class Car {

    @NotNull
    private String manufacturer;

    @Size(
            min = 2,
            max = 14,
            message = "The license plate '${validatedValue}' must be between {min} and {max} characters long"
    )
    private String licensePlate;

    @Min(
            value = 2,
            message = "There must be at least {value} seat${value &gt; 1 ? 's' : ''}"
    )
    private int seatCount;

    @DecimalMax(
            value = "350",
            message = "The top speed ${formatter.format('%1$.2f', validatedValue)} is higher " +
                    "than {value}"
    )
    private double topSpeed;

    @DecimalMax(value = "100000", message = "Price must not be higher than ${value}")
    private BigDecimal price;

    public Car(
            String manufacturer,
            String licensePlate,
            int seatCount,
            double topSpeed,
            BigDecimal price) {
        this.manufacturer = manufacturer;
        this.licensePlate = licensePlate;
        this.seatCount = seatCount;
        this.topSpeed = topSpeed;
        this.price = price;
    }

    //getters and setters ...
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Validating an invalid <code>Car</code> instance yields constraint violations with the messages shown by the
assertions in <a href="#example-expected-error-messages">Expected error messages</a>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the <code>@NotNull</code> constraint on the <code>manufacturer</code> field causes the error message "may not be null", as
this is the default message defined by the Bean Validation specification and no specific descriptor
is given in the message attribute</p>
</li>
<li>
<p>the <code>@Size</code> constraint on the <code>licensePlate</code> field shows the interpolation of message parameters
(<code>{min}</code>, <code>{max}</code>) and how to add the validated value to the error message using the EL
expression <code>${validatedValue}</code></p>
</li>
<li>
<p>the <code>@Min</code> constraint on <code>seatCount</code> demonstrates how use an EL expression with a ternery expression to
dynamically chose singular or plural form, depending on an attribute of the constraint ("There must
be at least 1 seat" vs. "There must be at least 2 seats")</p>
</li>
<li>
<p>the message for the <code>@DecimalMax</code> constraint on <code>topSpeed</code> shows how to format the validated
value using the formatter instance</p>
</li>
<li>
<p>finally, the <code>@DecimalMax</code> constraint on price shows that parameter interpolation has precedence over
expression evaluation, causing the <code>$</code> sign to show up in front of the maximum price</p>
</li>
</ul>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Only actual constraint attributes can be interpolated using message parameters in the form
<code>{attributeName}</code>. When referring to the validated value or custom expression variables added to the
interpolation context (see <a href="#section-hibernateconstraintvalidatorcontext"><code>HibernateConstraintValidatorContext</code></a>), an EL expression in the
form <code>${attributeName}</code> must be used.</p>
</div>
</td>
</tr>
</table>
</div>
<div id="example-expected-error-messages" class="exampleblock">
<div class="title">Example 43. Expected error messages</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">Car car = new Car( null, "A", 1, 400.123456, BigDecimal.valueOf( 200000 ) );

String message = validator.validateProperty( car, "manufacturer" )
        .iterator()
        .next()
        .getMessage();
assertEquals( "may not be null", message );

message = validator.validateProperty( car, "licensePlate" )
        .iterator()
        .next()
        .getMessage();
assertEquals(
        "The license plate 'A' must be between 2 and 14 characters long",
        message
);

message = validator.validateProperty( car, "seatCount" ).iterator().next().getMessage();
assertEquals( "There must be at least 2 seats", message );

message = validator.validateProperty( car, "topSpeed" ).iterator().next().getMessage();
assertEquals( "The top speed 400.12 is higher than 350", message );

message = validator.validateProperty( car, "price" ).iterator().next().getMessage();
assertEquals( "Price must not be higher than $100000", message );</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="section-custom-message-interpolation"><a class="anchor" href="#section-custom-message-interpolation"></a>4.2. Custom message interpolation</h3>
<div class="paragraph">
<p>If the default message interpolation algorithm does not fit your requirements it is also possible to
plug in a custom <code>MessageInterpolator</code> implementation.</p>
</div>
<div class="paragraph">
<p>Custom interpolators must implement the interface <code>javax.validation.MessageInterpolator</code>. Note that
implementations must be thread-safe. It is recommended that custom message interpolators delegate
final implementation to the default interpolator, which can be obtained via
<code>Configuration#getDefaultMessageInterpolator()</code>.</p>
</div>
<div class="paragraph">
<p>In order to use a custom message interpolator it must be registered either by configuring it in the
Bean Validation XML descriptor <em>META-INF/validation.xml</em> (see
<a href="#section-configuration-validation-xml">Configuring the validator factory in <em>validation.xml</em></a>) or by passing it when bootstrapping a <code>ValidatorFactory</code> or
<code>Validator</code> (see <a href="#section-validator-factory-message-interpolator"><code>MessageInterpolator</code></a> and
<a href="#section-configuring-validator">Configuring a Validator</a>, respectively).</p>
</div>
<div class="sect3">
<h4 id="section-resource-bundle-locator"><a class="anchor" href="#section-resource-bundle-locator"></a>4.2.1. <code>ResourceBundleLocator</code></h4>
<div class="paragraph">
<p>In some use cases you want to use the message interpolation algorithm as defined by the Bean
Validation specification, but retrieve error messages from other resource bundles than
<em>ValidationMessages</em>. In this situation Hibernate Validator&#8217;s <code>ResourceBundleLocator</code> SPI can help.</p>
</div>
<div class="paragraph">
<p>The default message interpolator in Hibernate Validator, <code>ResourceBundleMessageInterpolator</code>,
delegates retrieval of resource bundles to that SPI. Using an alternative bundle only requires
passing an instance of <code>PlatformResourceBundleLocator</code> with the bundle name when bootstrapping the
<code>ValidatorFactory</code> as shown in <a href="#example-using-specific-resource-bundle-locator">Using a specific resource bundle</a>.</p>
</div>
<div id="example-using-specific-resource-bundle-locator" class="exampleblock">
<div class="title">Example 44. Using a specific resource bundle</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">Validator validator = Validation.byDefaultProvider()
        .configure()
        .messageInterpolator(
                new ResourceBundleMessageInterpolator(
                        new PlatformResourceBundleLocator( "MyMessages" )
                )
        )
        .buildValidatorFactory()
        .getValidator();</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Of course you also could implement a completely different <code>ResourceBundleLocator</code>, which for instance
returns bundles backed by records in a database. In this case you can obtain the default locator via
<code>HibernateValidatorConfiguration#getDefaultResourceBundleLocator()</code>, which you e.g. could use as
fall-back for your custom locator.</p>
</div>
<div class="paragraph">
<p>Besides <code>PlatformResourceBundleLocator</code>, Hibernate Validator provides another resource bundle locator
implementation out of the box, namely <code>AggregateResourceBundleLocator</code>, which allows to retrieve error
messages from more than one resource bundle. You could for instance use this implementation in a
multi-module application where you want to have one message bundle per module.
<a href="#example-using-aggregate-resource-bundle-locator">Using <code>AggregateResourceBundleLocator</code></a> shows how to use <code>AggregateResourceBundleLocator</code>.</p>
</div>
<div id="example-using-aggregate-resource-bundle-locator" class="exampleblock">
<div class="title">Example 45. Using <code>AggregateResourceBundleLocator</code></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">Validator validator = Validation.byDefaultProvider()
        .configure()
        .messageInterpolator(
                new ResourceBundleMessageInterpolator(
                        new AggregateResourceBundleLocator(
                                Arrays.asList(
                                        "MyMessages",
                                        "MyOtherMessages"
                                )
                        )
                )
        )
        .buildValidatorFactory()
        .getValidator();</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Note that the bundles are processed in the order as passed to the constructor. That means if several
bundles contain an entry for a given message key, the value will be taken from the first bundle in
the list containing the key.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="chapter-groups"><a class="anchor" href="#chapter-groups"></a>5. Grouping constraints</h2>
<div class="sectionbody">
<div class="paragraph">
<p>All validation methods on <code>Validator</code> and <code>ExecutableValidator</code> discussed in earlier chapters also take
a var-arg argument groups. So far we have been ignoring this parameter, but it is time to have a
closer look.</p>
</div>
<div class="sect2">
<h3 id="_requesting_groups"><a class="anchor" href="#_requesting_groups"></a>5.1. Requesting groups</h3>
<div class="paragraph">
<p>Groups allow you to restrict the set of constraints applied during validation. One use case for
validation groups are UI wizards where in each step only a specified subset of constraints should
get validated. The groups targeted are passed as var-arg parameters to the appropriate validate
method.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s have a look at an example. The class <code>Person</code> in <a href="#example-person">Example class <code>Person</code></a> has a <code>@NotNull</code>
constraint on <code>name</code>. Since no group is specified for this annotation the default group
<code>javax.validation.groups.Default</code> is assumed.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When more than one group is requested, the order in which the groups are evaluated is not
deterministic. If no group is specified the default group <code>javax.validation.groups.Default</code> is
assumed.</p>
</div>
</td>
</tr>
</table>
</div>
<div id="example-person" class="exampleblock">
<div class="title">Example 46. Example class <code>Person</code></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter05;

public class Person {

    @NotNull
    private String name;

    public Person(String name) {
        this.name = name;
    }

    // getters and setters ...
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The class <code>Driver</code> in <a href="#example-driver">Driver</a> extends <code>Person</code> and adds the properties <code>age</code> and
<code>hasDrivingLicense</code>. Drivers must be at least 18 years old (<code>@Min(18)</code>) and have a driving license
(<code>@AssertTrue</code>). Both constraints defined on these properties belong to the group <code>DriverChecks</code> which
is just a simple tagging interface.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Using interfaces makes the usage of groups type-safe and allows for easy refactoring. It also means
that groups can inherit from each other via class inheritance. See <a href="#section-group-inheritance">Group inheritance</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div id="example-driver" class="exampleblock">
<div class="title">Example 47. Driver</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter05;

public class Driver extends Person {

    @Min(
            value = 18,
            message = "You have to be 18 to drive a car",
            groups = DriverChecks.class
    )
    public int age;

    @AssertTrue(
            message = "You first have to pass the driving test",
            groups = DriverChecks.class
    )
    public boolean hasDrivingLicense;

    public Driver(String name) {
        super( name );
    }

    public void passedDrivingTest(boolean b) {
        hasDrivingLicense = b;
    }

    public int getAge() {
        return age;
    }

    public void setAge(int age) {
        this.age = age;
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter05;

public interface DriverChecks {
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Finally the class <code>Car</code> (<a href="#example-car">Car</a>) has some constraints which are part of the default group as
well as <code>@AssertTrue</code> in the group <code>CarChecks</code> on the property <code>passedVehicleInspection</code> which indicates
whether a car passed the road worthy tests.</p>
</div>
<div id="example-car" class="exampleblock">
<div class="title">Example 48. Car</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter05;

public class Car {
    @NotNull
    private String manufacturer;

    @NotNull
    @Size(min = 2, max = 14)
    private String licensePlate;

    @Min(2)
    private int seatCount;

    @AssertTrue(
            message = "The car has to pass the vehicle inspection first",
            groups = CarChecks.class
    )
    private boolean passedVehicleInspection;

    @Valid
    private Driver driver;

    public Car(String manufacturer, String licencePlate, int seatCount) {
        this.manufacturer = manufacturer;
        this.licensePlate = licencePlate;
        this.seatCount = seatCount;
    }

    public boolean isPassedVehicleInspection() {
        return passedVehicleInspection;
    }

    public void setPassedVehicleInspection(boolean passedVehicleInspection) {
        this.passedVehicleInspection = passedVehicleInspection;
    }

    public Driver getDriver() {
        return driver;
    }

    public void setDriver(Driver driver) {
        this.driver = driver;
    }

    // getters and setters ...
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter05;

public interface CarChecks {
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Overall three different groups are used in the example:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The constraints on <code>Person.name</code>, <code>Car.manufacturer</code>, <code>Car.licensePlate</code> and <code>Car.seatCount</code>
all belong to the <code>Default</code> group</p>
</li>
<li>
<p>The constraints on <code>Driver.age</code> and <code>Driver.hasDrivingLicense</code> belong to <code>DriverChecks</code></p>
</li>
<li>
<p>The constraint on <code>Car.passedVehicleInspection</code> belongs to the group <code>CarChecks</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><a href="#example-drive-away">Using validation groups</a> shows how passing different group combinations to the <code>Validator#validate()</code>
method results in different validation results.</p>
</div>
<div id="example-drive-away" class="exampleblock">
<div class="title">Example 49. Using validation groups</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">// create a car and check that everything is ok with it.
Car car = new Car( "Morris", "DD-AB-123", 2 );
Set&lt;ConstraintViolation&lt;Car&gt;&gt; constraintViolations = validator.validate( car );
assertEquals( 0, constraintViolations.size() );

// but has it passed the vehicle inspection?
constraintViolations = validator.validate( car, CarChecks.class );
assertEquals( 1, constraintViolations.size() );
assertEquals(
        "The car has to pass the vehicle inspection first",
        constraintViolations.iterator().next().getMessage()
);

// let's go to the vehicle inspection
car.setPassedVehicleInspection( true );
assertEquals( 0, validator.validate( car, CarChecks.class ).size() );

// now let's add a driver. He is 18, but has not passed the driving test yet
Driver john = new Driver( "John Doe" );
john.setAge( 18 );
car.setDriver( john );
constraintViolations = validator.validate( car, DriverChecks.class );
assertEquals( 1, constraintViolations.size() );
assertEquals(
        "You first have to pass the driving test",
        constraintViolations.iterator().next().getMessage()
);

// ok, John passes the test
john.passedDrivingTest( true );
assertEquals( 0, validator.validate( car, DriverChecks.class ).size() );

// just checking that everything is in order now
assertEquals( 0,
        validator.validate(
                car,
                Default.class,
                CarChecks.class,
                DriverChecks.class
        ).size()
);</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The first <code>validate()</code> call in <a href="#example-drive-away">Using validation groups</a> is done using no explicit group. There are no
validation errors, even though the property <code>passedVehicleInspection</code> is per default <code>false</code>. However,
the constraint defined on this property does not belong to the default group.</p>
</div>
<div class="paragraph">
<p>The next validation using the <code>CarChecks</code> group fails until the car passes the vehicle inspection.
Adding a driver to the car and validating against <code>DriverChecks</code> again yields one constraint violation
due to the fact that the driver has not yet passed the driving test. Only after setting
<code>passedDrivingTest</code> to <code>true</code> the validation against <code>DriverChecks</code> passes.</p>
</div>
<div class="paragraph">
<p>The last <code>validate()</code> call finally shows that all constraints are passing by validating against all
defined groups.</p>
</div>
</div>
<div class="sect2">
<h3 id="section-group-inheritance"><a class="anchor" href="#section-group-inheritance"></a>5.2. Group inheritance</h3>
<div class="paragraph">
<p>In <a href="#example-drive-away">Using validation groups</a>, we need to call <code>validate()</code> for each validation group, or specify all of
them one by one.</p>
</div>
<div class="paragraph">
<p>In some situations, you may want to define a group of constraints which includes another group.
You can do that using group inheritance.</p>
</div>
<div class="paragraph">
<p>In <a href="#example-supercar">SuperCar</a>, we define a <code>SuperCar</code> and a group <code>RaceCarChecks</code> that extends the <code>Default</code> group.
A <code>SuperCar</code> must have safety belts to be allowed to run in races.</p>
</div>
<div id="example-supercar" class="exampleblock">
<div class="title">Example 50. SuperCar</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter05.groupinheritance;

public class SuperCar extends Car {

    @AssertTrue(
            message = "Race car must have a safety belt",
            groups = RaceCarChecks.class
    )
    private boolean safetyBelt;

    // getters and setters ...

}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter05.groupinheritance;

import javax.validation.groups.Default;

public interface RaceCarChecks extends Default {
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>In the example below, we will check if a <code>SuperCar</code> with one seat and no security belts is a valid car
and if it is a valid race-car.</p>
</div>
<div id="example-group-inheritance" class="exampleblock">
<div class="title">Example 51. Using group inheritance</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">// create a supercar and check that it's valid as a generic Car
SuperCar superCar = new SuperCar( "Morris", "DD-AB-123", 1  );
assertEquals( "must be greater than or equal to 2", validator.validate( superCar ).iterator().next().getMessage() );

// check that this supercar is valid as generic car and also as race car
Set&lt;ConstraintViolation&lt;SuperCar&gt;&gt; constraintViolations = validator.validate( superCar, RaceCarChecks.class );

assertThat( constraintViolations ).extracting( "message" ).containsOnly(
        "Race car must have a safety belt",
        "must be greater than or equal to 2"
);</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>On the first call to <code>validate()</code>, we do not specify a group. There is one validation error because a
car must have at least one seat. It is the constraint from the <code>Default</code> group.</p>
</div>
<div class="paragraph">
<p>On the second call, we specify only the group <code>RaceCarChecks</code>. There are two validation errors: one
about the missing seat from the <code>Default</code> group, another one about the fact that there is no safety
belts coming from the <code>RaceCarChecks</code> group.</p>
</div>
</div>
<div class="sect2">
<h3 id="section-defining-group-sequences"><a class="anchor" href="#section-defining-group-sequences"></a>5.3. Defining group sequences</h3>
<div class="paragraph">
<p>By default, constraints are evaluated in no particular order, regardless of which groups they belong
to. In some situations, however, it is useful to control the order constraints are evaluated.</p>
</div>
<div class="paragraph">
<p>In the example from <a href="#example-drive-away">Using validation groups</a> it could for instance be required that first all default
car constraints are passing before checking the road worthiness of the car. Finally, before driving
away, the actual driver constraints should be checked.</p>
</div>
<div class="paragraph">
<p>In order to implement such a validation order you just need to define an interface and annotate it
with <code>@GroupSequence</code>, defining the order in which the groups have to be validated (see
<a href="#example-defining-group-sequence">Defining a group sequence</a>). If at least one constraint fails in a sequenced group none of the
constraints of the following groups in the sequence get validated.</p>
</div>
<div id="example-defining-group-sequence" class="exampleblock">
<div class="title">Example 52. Defining a group sequence</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter05;

import javax.validation.GroupSequence;
import javax.validation.groups.Default;

@GroupSequence({ Default.class, CarChecks.class, DriverChecks.class })
public interface OrderedChecks {
}</code></pre>
</div>
</div>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Groups defining a sequence and groups composing a sequence must not be involved in a cyclic
dependency either directly or indirectly, either through cascaded sequence definition or group
inheritance. If a group containing such a circularity is evaluated, a <code>GroupDefinitionException</code> is
raised.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You then can use the new sequence as shown in in <a href="#example-group-sequence">Using a group sequence</a>.</p>
</div>
<div id="example-group-sequence" class="exampleblock">
<div class="title">Example 53. Using a group sequence</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">Car car = new Car( "Morris", "DD-AB-123", 2 );
car.setPassedVehicleInspection( true );

Driver john = new Driver( "John Doe" );
john.setAge( 18 );
john.passedDrivingTest( true );
car.setDriver( john );

assertEquals( 0, validator.validate( car, OrderedChecks.class ).size() );</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="section-default-group-class"><a class="anchor" href="#section-default-group-class"></a>5.4. Redefining the default group sequence</h3>
<div class="sect3">
<h4 id="__code_groupsequence_code"><a class="anchor" href="#__code_groupsequence_code"></a>5.4.1. <code>@GroupSequence</code></h4>
<div class="paragraph">
<p>Besides defining group sequences, the <code>@GroupSequence</code> annotation also allows to redefine the default
group for a given class. To do so, just add the <code>@GroupSequence</code> annotation to the class and specify
the sequence of groups which substitute Default for this class within the annotation.</p>
</div>
<div class="paragraph">
<p><a href="#example-rental-car">Class <code>RentalCar</code> with redefined default group</a> introduces a new class <code>RentalCar</code> with a redefined default group.</p>
</div>
<div id="example-rental-car" class="exampleblock">
<div class="title">Example 54. Class <code>RentalCar</code> with redefined default group</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter05;

@GroupSequence({ RentalChecks.class, CarChecks.class, RentalCar.class })
public class RentalCar extends Car {
    @AssertFalse(message = "The car is currently rented out", groups = RentalChecks.class)
    private boolean rented;

    public RentalCar(String manufacturer, String licencePlate, int seatCount) {
        super( manufacturer, licencePlate, seatCount );
    }

    public boolean isRented() {
        return rented;
    }

    public void setRented(boolean rented) {
        this.rented = rented;
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter05;

public interface RentalChecks {
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>With this definition you can evaluate the constraints belonging to <code>RentalChecks</code>, <code>CarChecks</code> and
<code>RentalCar</code> by just requesting the <code>Default</code> group as seen in <a href="#example-testCarIsRented">Validating an object with redefined default group</a>.</p>
</div>
<div id="example-testCarIsRented" class="exampleblock">
<div class="title">Example 55. Validating an object with redefined default group</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">RentalCar rentalCar = new RentalCar( "Morris", "DD-AB-123", 2 );
rentalCar.setPassedVehicleInspection( true );
rentalCar.setRented( true );

Set&lt;ConstraintViolation&lt;RentalCar&gt;&gt; constraintViolations = validator.validate( rentalCar );

assertEquals( 1, constraintViolations.size() );
assertEquals(
        "Wrong message",
        "The car is currently rented out",
        constraintViolations.iterator().next().getMessage()
);

rentalCar.setRented( false );
constraintViolations = validator.validate( rentalCar );

assertEquals( 0, constraintViolations.size() );</code></pre>
</div>
</div>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Since there must no cyclic dependency in the group and group sequence definitions one cannot just
add <code>Default</code> to the sequence redefining <code>Default</code> for a class. Instead the class itself has to be
added!</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The <code>Default</code> group sequence overriding is local to the class it is defined on and is not propagated
to associated objects. For the example this means that adding <code>DriverChecks</code> to the default group
sequence of <code>RentalCar</code> would not have any effects. Only the group <code>Default</code> will be propagated to the
driver association.</p>
</div>
<div class="paragraph">
<p>Note that you can control the propagated group(s) by declaring a group conversion rule (see
<a href="#section-group-conversion">Group conversion</a>).</p>
</div>
</div>
<div class="sect3">
<h4 id="__code_groupsequenceprovider_code"><a class="anchor" href="#__code_groupsequenceprovider_code"></a>5.4.2. <code>@GroupSequenceProvider</code></h4>
<div class="paragraph">
<p>In addition to statically redefining default group sequences via <code>@GroupSequence</code>, Hibernate Validator
also provides an SPI for the dynamic redefinition of default group sequences depending on the object
state.</p>
</div>
<div class="paragraph">
<p>For that purpose you need to implement the interface <code>DefaultGroupSequenceProvider</code> and register this
implementation with the target class via the <code>@GroupSequenceProvider</code> annotation. In the rental car
scenario you could for instance dynamically add the <code>CarChecks</code> as seen in
<a href="#example-implementing-using-default-group-sequence-provider">Implementing and using a default group sequence provider</a>.</p>
</div>
<div id="example-implementing-using-default-group-sequence-provider" class="exampleblock">
<div class="title">Example 56. Implementing and using a default group sequence provider</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter05.groupsequenceprovider;

public class RentalCarGroupSequenceProvider
        implements DefaultGroupSequenceProvider&lt;RentalCar&gt; {

    @Override
    public List&lt;Class&lt;?&gt;&gt; getValidationGroups(RentalCar car) {
        List&lt;Class&lt;?&gt;&gt; defaultGroupSequence = new ArrayList&lt;Class&lt;?&gt;&gt;();
        defaultGroupSequence.add( RentalCar.class );

        if ( car != null &amp;&amp; !car.isRented() ) {
            defaultGroupSequence.add( CarChecks.class );
        }

        return defaultGroupSequence;
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter05.groupsequenceprovider;

@GroupSequenceProvider(RentalCarGroupSequenceProvider.class)
public class RentalCar extends Car {

    @AssertFalse(message = "The car is currently rented out", groups = RentalChecks.class)
    private boolean rented;

    public RentalCar(String manufacturer, String licencePlate, int seatCount) {
        super( manufacturer, licencePlate, seatCount );
    }

    public boolean isRented() {
        return rented;
    }

    public void setRented(boolean rented) {
        this.rented = rented;
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="section-group-conversion"><a class="anchor" href="#section-group-conversion"></a>5.5. Group conversion</h3>
<div class="paragraph">
<p>What if you wanted to validate the car related checks together with the driver checks? Of course you
could pass the required groups to the validate call explicitly, but what if you wanted to make these
validations occur as part of the <code>Default</code> group validation? Here <code>@ConvertGroup</code> comes into play which
allows you during cascaded validation to use a different group than the originally requested one.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s have a look at <a href="#example-group-conversion-dedault-to-driver-checks"><code>@ConvertGroup</code> usage</a>. Here <code>@GroupSequence({
CarChecks.class, Car.class })</code> is used to combine the car related constraints under the <code>Default</code> group
(see <a href="#section-default-group-class">Redefining the default group sequence</a>). There is also a <code>@ConvertGroup(from = Default.class, to =
DriverChecks.class)</code> which ensures the <code>Default</code> group gets converted to the <code>DriverChecks</code> group during
cascaded validation of the driver association.</p>
</div>
<div id="example-group-conversion-dedault-to-driver-checks" class="exampleblock">
<div class="title">Example 57. <code>@ConvertGroup</code> usage</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter05.groupconversion;

public class Driver {

    @NotNull
    private String name;

    @Min(
            value = 18,
            message = "You have to be 18 to drive a car",
            groups = DriverChecks.class
    )
    public int age;

    @AssertTrue(
            message = "You first have to pass the driving test",
            groups = DriverChecks.class
    )
    public boolean hasDrivingLicense;

    public Driver(String name) {
        this.name = name;
    }

    public void passedDrivingTest(boolean b) {
        hasDrivingLicense = b;
    }

    public int getAge() {
        return age;
    }

    public void setAge(int age) {
        this.age = age;
    }

    // getters and setters ...
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter05.groupconversion;

@GroupSequence({ CarChecks.class, Car.class })
public class Car {

    @NotNull
    private String manufacturer;

    @NotNull
    @Size(min = 2, max = 14)
    private String licensePlate;

    @Min(2)
    private int seatCount;

    @AssertTrue(
            message = "The car has to pass the vehicle inspection first",
            groups = CarChecks.class
    )
    private boolean passedVehicleInspection;

    @Valid
    @ConvertGroup(from = Default.class, to = DriverChecks.class)
    private Driver driver;

    public Car(String manufacturer, String licencePlate, int seatCount) {
        this.manufacturer = manufacturer;
        this.licensePlate = licencePlate;
        this.seatCount = seatCount;
    }

    public boolean isPassedVehicleInspection() {
        return passedVehicleInspection;
    }

    public void setPassedVehicleInspection(boolean passedVehicleInspection) {
        this.passedVehicleInspection = passedVehicleInspection;
    }

    public Driver getDriver() {
        return driver;
    }

    public void setDriver(Driver driver) {
        this.driver = driver;
    }

    // getters and setters ...
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>As a result the validation in <a href="#example-group-conversion-test">Test case for <code>@ConvertGroup</code></a> succeeds, even though the constraint
on <code>hasDrivingLicense</code> belongs to the <code>DriverChecks</code> group and only the <code>Default</code> group is requested in
the <code>validate()</code> call.</p>
</div>
<div id="example-group-conversion-test" class="exampleblock">
<div class="title">Example 58. Test case for <code>@ConvertGroup</code></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">// create a car and validate. The Driver is still null and does not get validated
Car car = new Car( "VW", "USD-123", 4 );
car.setPassedVehicleInspection( true );
Set&lt;ConstraintViolation&lt;Car&gt;&gt; constraintViolations = validator.validate( car );
assertEquals( 0, constraintViolations.size() );

// create a driver who has not passed the driving test
Driver john = new Driver( "John Doe" );
john.setAge( 18 );

// now let's add a driver to the car
car.setDriver( john );
constraintViolations = validator.validate( car );
assertEquals( 1, constraintViolations.size() );
assertEquals(
        "The driver constraint should also be validated as part of the default group",
        constraintViolations.iterator().next().getMessage(),
        "You first have to pass the driving test"
);</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>You can define group conversions wherever <code>@Valid</code> can be used, namely associations as well as method
and constructor parameters and return values. Multiple conversions can be specified using
<code>@ConvertGroup.List</code>.</p>
</div>
<div class="paragraph">
<p>However, the following restrictions apply:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>@ConvertGroup</code> must only be used in combination with <code>@Valid</code>. If used without, a
<code>ConstraintDeclarationException</code> is thrown.</p>
</li>
<li>
<p>It is not legal to have multiple conversion rules on the same element with the same from value.
In this case, a <code>ConstraintDeclarationException</code> is raised.</p>
</li>
<li>
<p>The from attribute must not refer to a group sequence. A <code>ConstraintDeclarationException</code> is
raised in this situation.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Rules are not executed recursively. The first matching conversion rule is used and subsequent rules
are ignored. For example if a set of <code>@ConvertGroup</code> declarations chains group <code>A</code> to <code>B</code> and
<code>B</code> to <code>C</code>, the group <code>A</code> will be converted to <code>B</code> and not to <code>C</code>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="validator-customconstraints"><a class="anchor" href="#validator-customconstraints"></a>6. Creating custom constraints</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The Bean Validation API defines a whole set of standard constraint annotations such as <code>@NotNull</code>,
<code>@Size</code> etc. In cases where these built-in constraints are not sufficient, you can easily create
custom constraints tailored to your specific validation requirements.</p>
</div>
<div class="sect2">
<h3 id="validator-customconstraints-simple"><a class="anchor" href="#validator-customconstraints-simple"></a>6.1. Creating a simple constraint</h3>
<div class="paragraph">
<p>To create a custom constraint, the following three steps are required:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Create a constraint annotation</p>
</li>
<li>
<p>Implement a validator</p>
</li>
<li>
<p>Define a default error message</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="validator-customconstraints-constraintannotation"><a class="anchor" href="#validator-customconstraints-constraintannotation"></a>6.1.1. The constraint annotation</h4>
<div class="paragraph">
<p>This section shows how to write a constraint annotation which can be used to ensure that a given
string is either completely upper case or lower case. Later on this constraint will be applied to
the <code>licensePlate</code> field of the <code>Car</code> class from <a href="#validator-gettingstarted">Getting started</a> to ensure, that
the field is always an upper-case string.</p>
</div>
<div class="paragraph">
<p>The first thing needed is a way to express the two case modes. While you could use <code>String</code> constants,
a better approach is using a Java 5 enum for that purpose:</p>
</div>
<div class="exampleblock">
<div class="title">Example 59. Enum <code>CaseMode</code> to express upper vs. lower case</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter06;

public enum CaseMode {
    UPPER,
    LOWER;
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The next step is to define the actual constraint annotation. If you&#8217;ve never designed an annotation
before, this may look a bit scary, but actually it&#8217;s not that hard:</p>
</div>
<div id="example-defining-custom-constraint" class="exampleblock">
<div class="title">Example 60. Defining the <code>@CheckCase</code> constraint annotation</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter06;

@Target({ FIELD, METHOD, PARAMETER, ANNOTATION_TYPE })
@Retention(RUNTIME)
@Constraint(validatedBy = CheckCaseValidator.class)
@Documented
public @interface CheckCase {

    String message() default "{org.hibernate.validator.referenceguide.chapter06.CheckCase." +
            "message}";

    Class&lt;?&gt;[] groups() default { };

    Class&lt;? extends Payload&gt;[] payload() default { };

    CaseMode value();

    @Target({ FIELD, METHOD, PARAMETER, ANNOTATION_TYPE })
    @Retention(RUNTIME)
    @Documented
    @interface List {
        CheckCase[] value();
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>An annotation type is defined using the <code>@interface</code> keyword. All attributes of an annotation type are
declared in a method-like manner. The specification of the Bean Validation API demands, that any
constraint annotation defines</p>
</div>
<div class="ulist">
<ul>
<li>
<p>an attribute <code>message</code> that returns the default key for creating error messages in case the
constraint is violated</p>
</li>
<li>
<p>an attribute <code>groups</code> that allows the specification of validation groups, to which this constraint
belongs (see <a href="#chapter-groups">Grouping constraints</a>). This must default to an empty array of type Class&lt;?&gt;.</p>
</li>
<li>
<p>an attribute <code>payload</code> that can be used by clients of the Bean Validation API to assign custom
payload objects to a constraint. This attribute is not used by the API itself. An example for a
custom payload could be the definition of a severity:</p>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">public class Severity {
    public interface Info extends Payload {
    }

    public interface Error extends Payload {
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">public class ContactDetails {
    @NotNull(message = "Name is mandatory", payload = Severity.Error.class)
    private String name;

    @NotNull(message = "Phone number not specified, but not mandatory",
            payload = Severity.Info.class)
    private String phoneNumber;

    // ...
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Now a client can after the validation of a <code>ContactDetails</code> instance access the severity of a
constraint using <code>ConstraintViolation.getConstraintDescriptor().getPayload()</code> and adjust its behavior
depending on the severity.</p>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Besides these three mandatory attributes there is another one, <code>value</code>, allowing for the required case
mode to be specified. The name <code>value</code> is a special one, which can be omitted when using the
annotation, if it is the only attribute specified, as e.g. in <code>@CheckCase(CaseMode.UPPER)</code>.</p>
</div>
<div class="paragraph">
<p>In addition, the constraint annotation is decorated with a couple of meta annotations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>@Target({ FIELD, METHOD, PARAMETER, ANNOTATION_TYPE})</code>: Defines the supported target element types
for the constraint. <code>@CheckCase</code> may be used on fields (element type <code>FIELD</code>), JavaBeans properties as
well as method return values (<code>METHOD</code>) and method/constructor parameters (<code>PARAMETER</code>). The element
type <code>ANNOTATION_TYPE</code> allows for the creation of composed constraints
(see <a href="#section-constraint-composition">Constraint composition</a>) based on <code>@CheckCase</code>.</p>
<div class="paragraph">
<p>When creating a class-level constraint (see <a href="#validator-usingvalidator-classlevel">Class-level constraints</a>), the element
type <code>TYPE</code> would have to be used. Constraints targeting the return value of a constructor need to
support the element type <code>CONSTRUCTOR</code>. Cross-parameter constraints (see
<a href="#section-cross-parameter-constraints">Cross-parameter constraints</a>) which are used to validate all the parameters of a method
or constructor together, must support <code>METHOD</code> or <code>CONSTRUCTOR</code>, respectively.</p>
</div>
</li>
<li>
<p><code>@Retention(RUNTIME)</code>: Specifies, that annotations of this type will be available at runtime by the
means of reflection</p>
</li>
<li>
<p><code>@Constraint(validatedBy = CheckCaseValidator.class)</code>: Marks the annotation type as constraint
annotation and specifies the validator to be used to validate elements annotated with <code>@CheckCase</code>.
If a constraint may be used on several data types, several validators may be specified, one for
each data type.</p>
</li>
<li>
<p><code>@Documented</code>: Says, that the use of <code>@CheckCase</code> will be contained in the JavaDoc of elements
annotated with it</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Finally, there is an inner annotation type named <code>List</code>. This annotation allows to specify several
<code>@CheckCase</code> annotations on the same element, e.g. with different validation groups and messages.
While also another name could be used, the Bean Validation specification recommends to use the name
<code>List</code> and make the annotation an inner annotation of the corresponding constraint type.</p>
</div>
</div>
<div class="sect3">
<h4 id="section-constraint-validator"><a class="anchor" href="#section-constraint-validator"></a>6.1.2. The constraint validator</h4>
<div class="paragraph">
<p>Having defined the annotation, you need to create a constraint validator, which is able to validate
elements with a <code>@CheckCase</code> annotation. To do so, implement the interface <code>ConstraintValidator</code> as
shown below:</p>
</div>
<div id="example-constraint-validator" class="exampleblock">
<div class="title">Example 61. Implementing a constraint validator for the constraint <code>@CheckCase</code></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter06;

public class CheckCaseValidator implements ConstraintValidator&lt;CheckCase, String&gt; {

    private CaseMode caseMode;

    @Override
    public void initialize(CheckCase constraintAnnotation) {
        this.caseMode = constraintAnnotation.value();
    }

    @Override
    public boolean isValid(String object, ConstraintValidatorContext constraintContext) {
        if ( object == null ) {
            return true;
        }

        if ( caseMode == CaseMode.UPPER ) {
            return object.equals( object.toUpperCase() );
        }
        else {
            return object.equals( object.toLowerCase() );
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The <code>ConstraintValidator</code> interface defines two type parameters which are set in the implementation.
The first one specifies the annotation type to be validated (<code>CheckCase</code>), the second one the type of
elements, which the validator can handle (<code>String</code>). In case a constraint supports several data types,
a <code>ConstraintValidator</code> for each allowed type has to be implemented and registered at the constraint
annotation as shown above.</p>
</div>
<div class="paragraph">
<p>The implementation of the validator is straightforward. The <code>initialize()</code> method gives you access to
the attribute values of the validated constraint and allows you to store them in a field of the
validator as shown in the example.</p>
</div>
<div class="paragraph">
<p>The <code>isValid()</code> method contains the actual validation logic. For <code>@CheckCase</code> this is the check whether
a given string is either completely lower case or upper case, depending on the case mode retrieved
in <code>initialize()</code>. Note that the Bean Validation specification recommends to consider null values as
being valid. If <code>null</code> is not a valid value for an element, it should be annotated with <code>@NotNull</code>
explicitly.</p>
</div>
<div class="sect4">
<h5 id="_the_code_constraintvalidatorcontext_code"><a class="anchor" href="#_the_code_constraintvalidatorcontext_code"></a>The <code>ConstraintValidatorContext</code></h5>
<div class="paragraph">
<p><a href="#example-constraint-validator">Implementing a constraint validator for the constraint <code>@CheckCase</code></a>
relies on the default error message generation by just returning <code>true</code> or <code>false</code> from the <code>isValid()</code>
method. Using the passed <code>ConstraintValidatorContext</code> object it is possible to either add additional
error messages or completely disable the default error message generation and solely define custom
error messages. The <code>ConstraintValidatorContext</code> API is modeled as fluent interface and is best
demonstrated with an example:</p>
</div>
<div id="example-constraint-validator-context" class="exampleblock">
<div class="title">Example 62. Using <code>ConstraintValidatorContext</code> to define custom error messages</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter06.constraintvalidatorcontext;

public class CheckCaseValidator implements ConstraintValidator&lt;CheckCase, String&gt; {

    private CaseMode caseMode;

    @Override
    public void initialize(CheckCase constraintAnnotation) {
        this.caseMode = constraintAnnotation.value();
    }

    @Override
    public boolean isValid(String object, ConstraintValidatorContext constraintContext) {
        if ( object == null ) {
            return true;
        }

        boolean isValid;
        if ( caseMode == CaseMode.UPPER ) {
            isValid = object.equals( object.toUpperCase() );
        }
        else {
            isValid = object.equals( object.toLowerCase() );
        }

        if ( !isValid ) {
            constraintContext.disableDefaultConstraintViolation();
            constraintContext.buildConstraintViolationWithTemplate(
                    "{org.hibernate.validator.referenceguide.chapter06." +
                    "constraintvalidatorcontext.CheckCase.message}"
            )
            .addConstraintViolation();
        }

        return isValid;
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p><a href="#example-constraint-validator-context">Using <code>ConstraintValidatorContext</code> to define custom error messages</a>
shows how you can disable the default error message generation and add a custom error message using
a specified message template. In this example the use of the <code>ConstraintValidatorContext</code> results in
the same error message as the default error message generation.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>It is important to add each configured constraint violation by calling <code>addConstraintViolation()</code>.
Only after that the new constraint violation will be created.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Refer to <a href="#section-custom-property-paths">Custom property paths</a> to learn how to use the <code>ConstraintValidatorContext</code> API to
control the property path of constraint violations for class-level constraints.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="validator-customconstraints-errormessage"><a class="anchor" href="#validator-customconstraints-errormessage"></a>6.1.3. The error message</h4>
<div class="paragraph">
<p>The last missing building block is an error message which should be used in case a <code>@CheckCase</code>
constraint is violated. To define this, create a file <em>ValidationMessages.properties</em> with the
following contents (see also <a href="#section-message-interpolation">Default message interpolation</a>):</p>
</div>
<div class="exampleblock">
<div class="title">Example 63. Defining a custom error message for the <code>CheckCase</code> constraint</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre>org.hibernate.validator.referenceguide.chapter06.CheckCase.message=Case mode must be {value}.</pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>If a validation error occurs, the validation runtime will use the default value, that you specified
for the message attribute of the <code>@CheckCase</code> annotation to look up the error message in this resource
bundle.</p>
</div>
</div>
<div class="sect3">
<h4 id="validator-customconstraints-using"><a class="anchor" href="#validator-customconstraints-using"></a>6.1.4. Using the constraint</h4>
<div class="paragraph">
<p>You can now use the constraint in the <code>Car</code> class from the <a href="#validator-gettingstarted">Getting started</a> chapter to
specify that the <code>licensePlate</code> field should only contain upper-case strings:</p>
</div>
<div id="example-car-with-checkcase" class="exampleblock">
<div class="title">Example 64. Applying the <code>@CheckCase</code> constraint</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter06;

public class Car {

    @NotNull
    private String manufacturer;

    @NotNull
    @Size(min = 2, max = 14)
    @CheckCase(CaseMode.UPPER)
    private String licensePlate;

    @Min(2)
    private int seatCount;

    public Car(String manufacturer, String licencePlate, int seatCount) {
        this.manufacturer = manufacturer;
        this.licensePlate = licencePlate;
        this.seatCount = seatCount;
    }

    //getters and setters ...
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Finally, <a href="#example-using-checkcase">Validating objects with the <code>@CheckCase</code> constraint</a> demonstrates how validating a <code>Car</code> instance with an invalid
license plate causes the <code>@CheckCase</code> constraint to be violated.</p>
</div>
<div id="example-using-checkcase" class="exampleblock">
<div class="title">Example 65. Validating objects with the <code>@CheckCase</code> constraint</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">//invalid license plate
Car car = new Car( "Morris", "dd-ab-123", 4 );
Set&lt;ConstraintViolation&lt;Car&gt;&gt; constraintViolations =
        validator.validate( car );
assertEquals( 1, constraintViolations.size() );
assertEquals(
        "Case mode must be UPPER.",
        constraintViolations.iterator().next().getMessage()
);

//valid license plate
car = new Car( "Morris", "DD-AB-123", 4 );

constraintViolations = validator.validate( car );

assertEquals( 0, constraintViolations.size() );</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="section-class-level-constraints"><a class="anchor" href="#section-class-level-constraints"></a>6.2. Class-level constraints</h3>
<div class="paragraph">
<p>As discussed earlier, constraints can also be applied on the class level to validate the state of an
entire object. Class-level constraints are defined in the same was as are property constraints.
<a href="#example-implementing-classlevel-constraint">Implementing a class-level constraint</a> shows constraint annotation and validator of the
<code>@ValidPassengerCount</code> constraint you already saw in use in <a href="#example-class-level">Class-level constraint</a>.</p>
</div>
<div id="example-implementing-classlevel-constraint" class="exampleblock">
<div class="title">Example 66. Implementing a class-level constraint</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter06.classlevel;

@Target({ TYPE, ANNOTATION_TYPE })
@Retention(RUNTIME)
@Constraint(validatedBy = { ValidPassengerCountValidator.class })
@Documented
public @interface ValidPassengerCount {

    String message() default "{org.hibernate.validator.referenceguide.chapter06.classlevel." +
            "ValidPassengerCount.message}";

    Class&lt;?&gt;[] groups() default { };

    Class&lt;? extends Payload&gt;[] payload() default { };
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter06.classlevel;

public class ValidPassengerCountValidator
        implements ConstraintValidator&lt;ValidPassengerCount, Car&gt; {

    @Override
    public void initialize(ValidPassengerCount constraintAnnotation) {
    }

    @Override
    public boolean isValid(Car car, ConstraintValidatorContext context) {
        if ( car == null ) {
            return true;
        }

        return car.getPassengers().size() &lt;= car.getSeatCount();
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>As the example demonstrates, you need to use the element type <code>TYPE</code> in the <code>@Target</code> annotation. This
allows the constraint to be put on type definitions. The validator of the constraint in the example
receives a <code>Car</code> in the <code>isValid()</code> method and can access the complete object state to decide whether
the given instance is valid or not.</p>
</div>
<div class="sect3">
<h4 id="section-custom-property-paths"><a class="anchor" href="#section-custom-property-paths"></a>6.2.1. Custom property paths</h4>
<div class="paragraph">
<p>By default the constraint violation for a class-level constraint is reported on the level of the
annotated type, e.g. <code>Car</code>.</p>
</div>
<div class="paragraph">
<p>In some cases it is preferable though that the violation&#8217;s property path refers to one of the
involved properties. For instance you might want to report the <code>@ValidPassengerCount</code> constraint
against the passengers property instead of the <code>Car</code> bean.</p>
</div>
<div class="paragraph">
<p><a href="#example-custom-error">Adding a new <code>ConstraintViolation</code> with custom property path</a>
shows how this can be done by using the constraint validator context passed to <code>isValid()</code> to build a
custom constraint violation with a property node for the property passengers. Note that you also
could add several property nodes, pointing to a sub-entity of the validated bean.</p>
</div>
<div id="example-custom-error" class="exampleblock">
<div class="title">Example 67. Adding a new <code>ConstraintViolation</code> with custom property path</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter06.custompath;

public class ValidPassengerCountValidator
        implements ConstraintValidator&lt;ValidPassengerCount, Car&gt; {

    @Override
    public void initialize(ValidPassengerCount constraintAnnotation) {
    }

    @Override
    public boolean isValid(Car car, ConstraintValidatorContext constraintValidatorContext) {
        if ( car == null ) {
            return true;
        }

        boolean isValid = car.getPassengers().size() &lt;= car.getSeatCount();

        if ( !isValid ) {
            constraintValidatorContext.disableDefaultConstraintViolation();
            constraintValidatorContext
                    .buildConstraintViolationWithTemplate( "{my.custom.template}" )
                    .addPropertyNode( "passengers" ).addConstraintViolation();
        }

        return isValid;
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="section-cross-parameter-constraints"><a class="anchor" href="#section-cross-parameter-constraints"></a>6.3. Cross-parameter constraints</h3>
<div class="paragraph">
<p>Bean Validation distinguishes between two different kinds of constraints.</p>
</div>
<div class="paragraph">
<p>Generic constraints (which have been discussed so far) apply to the annotated element, e.g. a type,
field, method parameter or return value etc. Cross-parameter constraints, in contrast, apply to the
array of parameters of a method or constructor and can be used to express validation logic which
depends on several parameter values.</p>
</div>
<div class="paragraph">
<p>In order to define a cross-parameter constraint, its validator class must be annotated with
<code>@SupportedValidationTarget(ValidationTarget.PARAMETERS)</code>. The type parameter <code>T</code> from the
<code>ConstraintValidator</code> interface must resolve to either <code>Object</code> or <code>Object[]</code> in order to receive the
array of method/constructor arguments in the <code>isValid()</code> method.</p>
</div>
<div class="paragraph">
<p>The following example shows the definition of a cross-parameter constraint which can be used to
check that two <code>Date</code> parameters of a method are in the correct order:</p>
</div>
<div class="exampleblock">
<div class="title">Example 68. Cross-parameter constraint</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter06.crossparameter;

@Constraint(validatedBy = ConsistentDateParametersValidator.class)
@Target({ METHOD, CONSTRUCTOR, ANNOTATION_TYPE })
@Retention(RUNTIME)
@Documented
public @interface ConsistentDateParameters {

    String message() default "{org.hibernate.validator.referenceguide.chapter04." +
            "crossparameter.ConsistentDateParameters.message}";

    Class&lt;?&gt;[] groups() default { };

    Class&lt;? extends Payload&gt;[] payload() default { };
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The definition of a cross-parameter constraint isn&#8217;t any different from defining a generic
constraint, i.e. it must specify the members <code>message()</code>, <code>groups()</code> and <code>payload()</code> and be annotated with
<code>@Constraint</code>. This meta annotation also specifies the corresponding validator, which is shown in
<a href="#example-cross-parameter-validator">Generic and cross-parameter constraint</a>. Note that besides the element types <code>METHOD</code> and <code>CONSTRUCTOR</code>
also <code>ANNOTATION_TYPE</code> is specified as target of the annotation, in order to enable the creation of
composed constraints based on <code>@ConsistentDateParameters</code> (see
<a href="#section-constraint-composition">Constraint composition</a>).</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Cross-parameter constraints are specified directly on the declaration of a method or constructor,
which is also the case for return value constraints. In order to improve code readability, it is
therefore recommended to chose constraint names - such as <code>@ConsistentDateParameters</code> - which make the
constraint target apparent.</p>
</div>
</td>
</tr>
</table>
</div>
<div id="example-cross-parameter-validator" class="exampleblock">
<div class="title">Example 69. Generic and cross-parameter constraint</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter06.crossparameter;

@SupportedValidationTarget(ValidationTarget.PARAMETERS)
public class ConsistentDateParametersValidator implements
        ConstraintValidator&lt;ConsistentDateParameters, Object[]&gt; {

    @Override
    public void initialize(ConsistentDateParameters constraintAnnotation) {
    }

    @Override
    public boolean isValid(Object[] value, ConstraintValidatorContext context) {
        if ( value.length != 2 ) {
            throw new IllegalArgumentException( "Illegal method signature" );
        }

        //leave null-checking to @NotNull on individual parameters
        if ( value[0] == null || value[1] == null ) {
            return true;
        }

        if ( !( value[0] instanceof Date ) || !( value[1] instanceof Date ) ) {
            throw new IllegalArgumentException(
                    "Illegal method signature, expected two " +
                            "parameters of type Date."
            );
        }

        return ( (Date) value[0] ).before( (Date) value[1] );
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>As discussed above, the validation target <code>PARAMETERS</code> must be configured for a cross-parameter
validator by using the <code>@SupportedValidationTarget</code> annotation. Since a cross-parameter constraint
could be applied to any method or constructor, it is considered a best practice to check for the
expected number and types of parameters in the validator implementation.</p>
</div>
<div class="paragraph">
<p>As with generic constraints, <code>null</code> parameters should be considered valid and <code>@NotNull</code> on the
individual parameters should be used to make sure that parameters are not <code>null</code>.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Similar to class-level constraints, you can create custom constraint violations on single parameters
instead of all parameters when validating a cross-parameter constraint. Just obtain a node builder
from the <code>ConstraintValidatorContext</code> passed to <code>isValid()</code> and add a parameter node by calling
<code>addParameterNode()</code>. In the example you could use this to create a constraint violation on the end
date parameter of the validated method.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In rare situations a constraint is both, generic and cross-parameter. This is the case if a
constraint has a validator class which is annotated with
<code>@SupportedValidationTarget({ValidationTarget.PARAMETERS, ValidationTarget.ANNOTATED_ELEMENT})</code> or if
it has a generic and a cross-parameter validator class.</p>
</div>
<div class="paragraph">
<p>When declaring such a constraint on a method which has parameters and also a return value, the
intended constraint target can&#8217;t be determined. Constraints which are generic and cross-parameter at
the same time, must therefore define a member <code>validationAppliesTo()</code> which allows the constraint user
to specify the constraint&#8217;s target as shown in <a href="#example-dual-cross-parameter-constraint">Generic and cross-parameter constraint</a>.</p>
</div>
<div id="example-dual-cross-parameter-constraint" class="exampleblock">
<div class="title">Example 70. Generic and cross-parameter constraint</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter06.crossparameter;

@Constraint(validatedBy = {
        ScriptAssertObjectValidator.class,
        ScriptAssertParametersValidator.class
})
@Target({ TYPE, FIELD, PARAMETER, METHOD, CONSTRUCTOR, ANNOTATION_TYPE })
@Retention(RUNTIME)
@Documented
public @interface ScriptAssert {

    String message() default "{org.hibernate.validator.referenceguide.chapter04." +
            "crossparameter.ScriptAssert.message}";

    Class&lt;?&gt;[] groups() default { };

    Class&lt;? extends Payload&gt;[] payload() default { };

    String script();

    ConstraintTarget validationAppliesTo() default ConstraintTarget.IMPLICIT;
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The <code>@ScriptAssert</code> constraint has two validators (not shown), a generic and a cross-parameter one and
thus defines the member <code>validationAppliesTo()</code>. The default value <code>IMPLICIT</code> allows to derive the
target automatically in situations where this is possible (e.g. if the constraint is declared on a
field or on a method which has parameters but no return value).</p>
</div>
<div class="paragraph">
<p>If the target can not be determined implicitly, it must be set by the user to either <code>PARAMETERS</code> or
<code>RETURN_VALUE</code> as shown in <a href="#example-dual-cross-parameter-constraint-usage">Specifying the target for a generic and cross-parameter constraint</a>.</p>
</div>
<div id="example-dual-cross-parameter-constraint-usage" class="exampleblock">
<div class="title">Example 71. Specifying the target for a generic and cross-parameter constraint</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">@ScriptAssert(script = "arg1.size() &lt;= arg0", validationAppliesTo = ConstraintTarget.PARAMETERS)
public Car buildCar(int seatCount, List&lt;Passenger&gt; passengers) {
    //...
    return null;
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="section-constraint-composition"><a class="anchor" href="#section-constraint-composition"></a>6.4. Constraint composition</h3>
<div class="paragraph">
<p>Looking at the <code>licensePlate</code> field of the <code>Car</code> class in <a href="#example-car-with-checkcase">Applying the <code>@CheckCase</code> constraint</a>, you see three
constraint annotations already. In complexer scenarios, where even more constraints could be applied
to one element, this might become a bit confusing easily. Furthermore, if there was a <code>licensePlate</code>
field in another class, you would have to copy all constraint declarations to the other class as
well, violating the DRY principle.</p>
</div>
<div class="paragraph">
<p>You can address this kind of problem by creating higher level constraints, composed from several
basic constraints. <a href="#example-composed-constraint">Creating a composing constraint <code>@ValidLicensePlate</code></a> shows a composed constraint annotation which
comprises the constraints <code>@NotNull</code>, <code>@Size</code> and <code>@CheckCase</code>:</p>
</div>
<div id="example-composed-constraint" class="exampleblock">
<div class="title">Example 72. Creating a composing constraint <code>@ValidLicensePlate</code></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter06.constraintcomposition;

@NotNull
@Size(min = 2, max = 14)
@CheckCase(CaseMode.UPPER)
@Target({ METHOD, FIELD, ANNOTATION_TYPE })
@Retention(RUNTIME)
@Constraint(validatedBy = { })
@Documented
public @interface ValidLicensePlate {

    String message() default "{org.hibernate.validator.referenceguide.chapter06." +
            "constraintcomposition.ValidLicensePlate.message}";

    Class&lt;?&gt;[] groups() default { };

    Class&lt;? extends Payload&gt;[] payload() default { };
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>To create a composed constraint, simply annotate the constraint declaration with its comprising
constraints. If the composed constraint itself requires a validator, this validator is to be
specified within the <code>@Constraint</code> annotation. For composed constraints which don&#8217;t need an additional
validator such as <code>@ValidLicensePlate</code>, just set <code>validatedBy()</code> to an empty array.</p>
</div>
<div class="paragraph">
<p>Using the new composed constraint at the <code>licensePlate</code> field is fully equivalent to the previous
version, where the three constraints were declared directly at the field itself:</p>
</div>
<div class="exampleblock">
<div class="title">Example 73. Application of composing constraint <code>ValidLicensePlate</code></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter06.constraintcomposition;

public class Car {

    @ValidLicensePlate
    private String licensePlate;

    //...
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The set of <code>ConstraintViolations</code> retrieved when validating a <code>Car</code> instance will contain an entry for
each violated composing constraint of the <code>@ValidLicensePlate</code> constraint. If you rather prefer a
single <code>ConstraintViolation</code> in case any of the composing constraints is violated, the
<code>@ReportAsSingleViolation</code> meta constraint can be used as follows:</p>
</div>
<div class="exampleblock">
<div class="title">Example 74. Using @ReportAsSingleViolation</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter06.constraintcomposition.reportassingle;

//...
@ReportAsSingleViolation
public @interface ValidLicensePlate {

    String message() default "{org.hibernate.validator.referenceguide.chapter06." +
            "constraintcomposition.ValidLicensePlate.message}";

    Class&lt;?&gt;[] groups() default { };

    Class&lt;? extends Payload&gt;[] payload() default { };
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="chapter-xml-configuration"><a class="anchor" href="#chapter-xml-configuration"></a>7. Configuring via XML</h2>
<div class="sectionbody">
<div class="paragraph">
<p>So far we have used the default configuration source for Bean Validation, namely annotations.
However, there also exist two kinds of XML descriptors allowing configuration via XML. The first
descriptor describes general Bean Validation behaviour and is provided as <em>META-INF/validation.xml</em>.
The second one describes constraint declarations and closely matches the constraint declaration
approach via annotations. Let&#8217;s have a look at these two document types.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The XSD files are available via
<a href="http://www.jboss.org/xml/ns/javax/validation/configuration/">http://www.jboss.org/xml/ns/javax/validation/configuration</a> and
<a href="http://www.jboss.org/xml/ns/javax/validation/mapping">http://www.jboss.org/xml/ns/javax/validation/mapping</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="section-configuration-validation-xml"><a class="anchor" href="#section-configuration-validation-xml"></a>7.1. Configuring the validator factory in <em>validation.xml</em></h3>
<div class="paragraph">
<p>The key to enable XML configuration for Hibernate Validator is the file <em>META-INF/validation.xml</em>.
If this file exists on the classpath its configuration will be applied when the <code>ValidatorFactory</code>
gets created. <a href="#image-validation-configuration">Validation configuration schema</a> shows a model view of the XML schema to which
<em>validation.xml</em> has to adhere.</p>
</div>
<div id="image-validation-configuration" class="imageblock">
<div class="content">
<img src="images/validation-configuration-1.1.png" alt="validation-configuration-1.1.xsd">
</div>
<div class="title">Figure 1. Validation configuration schema</div>
</div>
<div class="paragraph">
<p><a href="#example-validation-xml"><code>validation.xml</code></a>
shows the several configuration options of <em>validation.xml</em>. All settings are optional and the same
configuration options are also available programmatically through <code>javax.validation.Configuration</code>. In
fact the XML configuration will be overridden by values explicitly specified via the programmatic
API. It is even possible to ignore the XML configuration completely via
<code>Configuration#ignoreXmlConfiguration()</code>. See also <a href="#section-configuring-validator-factory">Configuring a <code>ValidatorFactory</code></a>.</p>
</div>
<div id="example-validation-xml" class="exampleblock">
<div class="title">Example 75. <code>validation.xml</code></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-XML" data-lang="XML">&lt;validation-config
    xmlns="http://jboss.org/xml/ns/javax/validation/configuration"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://jboss.org/xml/ns/javax/validation/configuration"&gt;

    &lt;default-provider&gt;com.acme.ValidationProvider&lt;/default-provider&gt;

    &lt;message-interpolator&gt;com.acme.MessageInterpolator&lt;/message-interpolator&gt;
    &lt;traversable-resolver&gt;com.acme.TraversableResolver&lt;/traversable-resolver&gt;
    &lt;constraint-validator-factory&gt;
        com.acme.ConstraintValidatorFactory
    &lt;/constraint-validator-factory&gt;
    &lt;parameter-name-provider&gt;com.acme.ParameterNameProvider&lt;/parameter-name-provider&gt;

    &lt;executable-validation enabled="true"&gt;
        &lt;default-validated-executable-types&gt;
            &lt;executable-type&gt;CONSTRUCTORS&lt;/executable-type&gt;
            &lt;executable-type&gt;NON_GETTER_METHODS&lt;/executable-type&gt;
            &lt;executable-type&gt;GETTER_METHODS&lt;/executable-type&gt;
        &lt;/default-validated-executable-types&gt;
    &lt;/executable-validation&gt;

    &lt;constraint-mapping&gt;META-INF/validation/constraints-car.xml&lt;/constraint-mapping&gt;

    &lt;property name="hibernate.validator.fail_fast"&gt;false&lt;/property&gt;
&lt;/validation-config&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>There must only be one file named <em>META-INF/validation.xml</em> on the classpath. If more than one is
found an exception is thrown.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The node <code>default-provider</code> allows to choose the Bean Validation provider. This is useful if there is
more than one provider on the classpath. <code>message-interpolator</code>, <code>traversable-resolver</code>,
<code>constraint-validator-factory</code> and <code>parameter-name-provider</code> allow to customize the used
implementations for the interfaces <code>MessageInterpolator</code>, <code>TraversableResolver</code>,
<code>ConstraintValidatorFactory</code> and <code>ParameterNameProvider</code> defined in the <code>javax.validation</code> package.
See the sub-sections of <a href="#section-configuring-validator-factory">Configuring a <code>ValidatorFactory</code></a> for more information about these
interfaces.</p>
</div>
<div class="paragraph">
<p><code>executable-validation</code> and its subnodes define defaults for method validation. The Bean Validation
specification defines constructor and non getter methods as defaults. The enabled attribute acts as
global switch to turn method validation on and off (see also <a href="#chapter-method-constraints">Declaring and validating method constraints</a>).</p>
</div>
<div class="paragraph">
<p>Via the <code>constraint-mapping</code> element you can list an arbitrary number of additional XML files
containing the actual constraint configuration. Mapping file names must be specified using their
fully-qualified name on the classpath. Details on writing mapping files can be found in the next
section.</p>
</div>
<div class="paragraph">
<p>Last but not least, you can specify provider specific properties via the <code>property</code> nodes. In the
example we are using the Hibernate Validator specific <code>hibernate.validator.fail_fast</code> property (see
<a href="#section-fail-fast">Fail fast mode</a>).</p>
</div>
</div>
<div class="sect2">
<h3 id="section-mapping-xml-constraints"><a class="anchor" href="#section-mapping-xml-constraints"></a>7.2. Mapping constraints via <code>constraint-mappings</code></h3>
<div class="paragraph">
<p>Expressing constraints in XML is possible via files adhering to the schema seen in
<a href="#image-mapping-configuration">Validation mapping schema</a>. Note that these mapping files are only processed if listed via
constraint-mapping in <em>validation.xml</em>.</p>
</div>
<div id="image-mapping-configuration" class="imageblock">
<div class="content">
<img src="images/validation-mapping-1.1.png" alt="validation-mapping-1.1.xsd">
</div>
<div class="title">Figure 2. Validation mapping schema</div>
</div>
<div class="paragraph">
<p><a href="#example-constraints-car">Bean constraints configured via XML</a> shows how the classes Car and RentalCar from <a href="#example-car">Car</a> resp.
<a href="#example-rental-car">Class <code>RentalCar</code> with redefined default group</a> could be mapped in XML.</p>
</div>
<div id="example-constraints-car" class="exampleblock">
<div class="title">Example 76. Bean constraints configured via XML</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-XML" data-lang="XML">&lt;constraint-mappings
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://jboss.org/xml/ns/javax/validation/mapping validation-mapping-1.1.xsd"
    xmlns="http://jboss.org/xml/ns/javax/validation/mapping" version="1.1"&gt;

    &lt;default-package&gt;org.hibernate.validator.referenceguide.chapter05&lt;/default-package&gt;
    &lt;bean class="Car" ignore-annotations="true"&gt;
        &lt;field name="manufacturer"&gt;
            &lt;constraint annotation="javax.validation.constraints.NotNull"/&gt;
        &lt;/field&gt;
        &lt;field name="licensePlate"&gt;
            &lt;constraint annotation="javax.validation.constraints.NotNull"/&gt;
        &lt;/field&gt;
        &lt;field name="seatCount"&gt;
            &lt;constraint annotation="javax.validation.constraints.Min"&gt;
                &lt;element name="value"&gt;2&lt;/element&gt;
            &lt;/constraint&gt;
        &lt;/field&gt;
        &lt;field name="driver"&gt;
            &lt;valid/&gt;
        &lt;/field&gt;
        &lt;getter name="passedVehicleInspection" ignore-annotations="true"&gt;
            &lt;constraint annotation="javax.validation.constraints.AssertTrue"&gt;
                &lt;message&gt;The car has to pass the vehicle inspection first&lt;/message&gt;
                &lt;groups&gt;
                    &lt;value&gt;CarChecks&lt;/value&gt;
                &lt;/groups&gt;
                &lt;element name="max"&gt;10&lt;/element&gt;
            &lt;/constraint&gt;
        &lt;/getter&gt;
    &lt;/bean&gt;
    &lt;bean class="RentalCar" ignore-annotations="true"&gt;
        &lt;class ignore-annotations="true"&gt;
            &lt;group-sequence&gt;
                &lt;value&gt;RentalCar&lt;/value&gt;
                &lt;value&gt;CarChecks&lt;/value&gt;
            &lt;/group-sequence&gt;
        &lt;/class&gt;
    &lt;/bean&gt;
    &lt;constraint-definition annotation="org.mycompany.CheckCase"&gt;
        &lt;validated-by include-existing-validators="false"&gt;
            &lt;value&gt;org.mycompany.CheckCaseValidator&lt;/value&gt;
        &lt;/validated-by&gt;
    &lt;/constraint-definition&gt;
&lt;/constraint-mappings&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p><a href="#example-rental-station-xml">Method constraints configured via XML</a> shows how the constraints from
<a href="#example-declaring-parameter-constraints">Declaring method and constructor parameter constraints</a>, <a href="#example-declaring-return-value-constraints">Declaring method and constructor return value constraints</a>
and <a href="#example-specifying-constraint-target">Specifying a constraint&#8217;s target</a> can be expressed in XML.</p>
</div>
<div id="example-rental-station-xml" class="exampleblock">
<div class="title">Example 77. Method constraints configured via XML</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-XML" data-lang="XML">&lt;constraint-mappings
        xmlns="http://jboss.org/xml/ns/javax/validation/mapping"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation=
                "http://jboss.org/xml/ns/javax/validation/mapping validation-mapping-1.1.xsd" version="1.1"&gt;

    &lt;default-package&gt;org.hibernate.validator.referenceguide.chapter07&lt;/default-package&gt;

    &lt;bean class="RentalStation" ignore-annotations="true"&gt;
        &lt;constructor&gt;
            &lt;return-value&gt;
                &lt;constraint annotation="ValidRentalStation"/&gt;
            &lt;/return-value&gt;
        &lt;/constructor&gt;

        &lt;constructor&gt;
            &lt;parameter type="java.lang.String"&gt;
                &lt;constraint annotation="javax.validation.constraints.NotNull"/&gt;
            &lt;/parameter&gt;
        &lt;/constructor&gt;

        &lt;method name="getCustomers"&gt;
            &lt;return-value&gt;
                &lt;constraint annotation="javax.validation.constraints.NotNull"/&gt;
                &lt;constraint annotation="javax.validation.constraints.Size"&gt;
                    &lt;element name="min"&gt;1&lt;/element&gt;
                &lt;/constraint&gt;
            &lt;/return-value&gt;
        &lt;/method&gt;

        &lt;method name="rentCar"&gt;
            &lt;parameter type="Customer"&gt;
                &lt;constraint annotation="javax.validation.constraints.NotNull"/&gt;
            &lt;/parameter&gt;
            &lt;parameter type="java.util.Date"&gt;
                &lt;constraint annotation="javax.validation.constraints.NotNull"/&gt;
                &lt;constraint annotation="javax.validation.constraints.Future"/&gt;
            &lt;/parameter&gt;
            &lt;parameter type="int"&gt;
                &lt;constraint annotation="javax.validation.constraints.Min"&gt;
                    &lt;element name="value"&gt;1&lt;/element&gt;
                &lt;/constraint&gt;
            &lt;/parameter&gt;
        &lt;/method&gt;
    &lt;/bean&gt;

    &lt;bean class="Garage" ignore-annotations="true"&gt;
        &lt;method name="buildCar"&gt;
            &lt;parameter type="java.util.List"/&gt;
            &lt;cross-parameter&gt;
                &lt;constraint annotation="ELAssert"&gt;
                    &lt;element name="expression"&gt;...&lt;/element&gt;
                    &lt;element name="validationAppliesTo"&gt;PARAMETERS&lt;/element&gt;
                &lt;/constraint&gt;
            &lt;/cross-parameter&gt;
        &lt;/method&gt;
        &lt;method name="paintCar"&gt;
            &lt;parameter type="int"/&gt;
            &lt;return-value&gt;
                &lt;constraint annotation="ELAssert"&gt;
                    &lt;element name="expression"&gt;...&lt;/element&gt;
                    &lt;element name="validationAppliesTo"&gt;RETURN_VALUE&lt;/element&gt;
                &lt;/constraint&gt;
            &lt;/return-value&gt;
        &lt;/method&gt;
    &lt;/bean&gt;

&lt;/constraint-mappings&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The XML configuration is closely mirroring the programmatic API. For this reason it should suffice
to just add some comments. <code>default-package</code> is used for all fields where a class name is expected. If
the specified class is not fully qualified the configured default package will be used. Every
mapping file can then have several bean nodes, each describing the constraints on the entity with
the specified class name.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>A given class can only be configured once across all configuration files. The same applies for
constraint definitions for a given constraint annotation. It can only occur in one mapping file. If
these rules are violated a <code>ValidationException</code> is thrown.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Setting <code>ignore-annotations</code> to <code>true</code> means that constraint annotations placed on the configured bean
are ignored. The default for this value is true. <code>ignore-annotations</code> is also available for the nodes
<code>class</code>, <code>fields</code>, <code>getter</code>, <code>constructor</code>, <code>method</code>, <code>parameter</code>, <code>cross-parameter</code> and <code>return-value</code>.
If not explicitly specified on these levels the configured bean value applies.</p>
</div>
<div class="paragraph">
<p>The nodes <code>class</code>, <code>field</code>, <code>getter</code>, <code>constructor</code> and <code>method</code> (and its sub node parameter) determine on
which level the constraint gets placed. The <code>constraint</code> node is then used to add a constraint on the
corresponding level. Each constraint definition must define the class via the <code>annotation</code> attribute.
The constraint attributes required by the Bean Validation specification (<code>message</code>, <code>groups</code> and
<code>payload</code>) have dedicated nodes. All other constraint specific attributes are configured using the
<code>element</code> node.</p>
</div>
<div class="paragraph">
<p>The <code>class</code> node also allows to reconfigure the default group sequence (see
<a href="#section-default-group-class">Redefining the default group sequence</a>) via the <code>group-sequence</code> node. Not shown in the example is the use
of <code>convert-group</code> to
specify group conversions (see <a href="#section-group-conversion">Group conversion</a>). This node is available on <code>field</code>,
<code>getter</code>, <code>parameter</code> and <code>return-value</code> and specifies a from and to attribute to specify the groups.</p>
</div>
<div class="paragraph">
<p>Last but not least, the list of <code>ConstraintValidator</code> instances associated to a given constraint
can be altered via the <code>constraint-definition</code> node. The annotation attribute represents the constraint
annotation being altered. The <code>validated-by</code> element represent the (ordered) list of <code>ConstraintValidator</code>
implementations associated to the constraint. If <code>include-existing-validator</code> is set to <code>false</code>,
validators defined on the constraint annotation are ignored. If set to <code>true</code>, the list of constraint
validators described in XML is concatenated to the list of validators specified on the annotation.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>One use case for constraint-definition is to change the default constraint definition for <code>@URL</code>.
Historically, Hibernate Validator&#8217;s default constraint validator for this constraint uses the
<code>java.net.URL</code> constructor to verify that an URL is valid.
However, there is also a purely regular expression based version available which can be configured using
XML:</p>
</div>
<div class="listingblock">
<div class="title">Using XML to register a regular expression based constraint definition for <code>@URL</code></div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-XML" data-lang="XML">&lt;constraint-definition annotation="org.hibernate.validator.constraints.URL"&gt;
  &lt;validated-by include-existing-validators="false"&gt;
    &lt;value&gt;org.hibernate.validator.constraintvalidators.RegexpURLValidator&lt;/value&gt;
  &lt;/validated-by&gt;
&lt;/constraint-definition&gt;</code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="chapter-bootstrapping"><a class="anchor" href="#chapter-bootstrapping"></a>8. Bootstrapping</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In <a href="#section-obtaining-validator">Obtaining a <code>Validator</code> instance</a> you already saw one way for creating a Validator instance - via
<code>Validation#buildDefaultValidatorFactory()</code>. In this chapter you will learn how to use the other
methods in <code>javax.validation.Validation</code> in order to bootstrap specifically configured validators.</p>
</div>
<div class="sect2">
<h3 id="section-retrieving-validator-factory-validator"><a class="anchor" href="#section-retrieving-validator-factory-validator"></a>8.1. Retrieving <code>ValidatorFactory</code> and <code>Validator</code></h3>
<div class="paragraph">
<p>You obtain a <code>Validator</code> by retrieving a <code>ValidatorFactory</code> via one of the static methods on
<code>javax.validation.Validation</code> and calling <code>getValidator()</code> on the factory instance.</p>
</div>
<div class="paragraph">
<p><a href="#example-build-default-validator-factory">Bootstrapping default <code>ValidatorFactory</code> and <code>Validator</code></a> shows how to obtain a validator from the default
validator factory:</p>
</div>
<div id="example-build-default-validator-factory" class="exampleblock">
<div class="title">Example 78. Bootstrapping default <code>ValidatorFactory</code> and <code>Validator</code></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">ValidatorFactory validatorFactory = Validation.buildDefaultValidatorFactory();
Validator validator = validatorFactory.getValidator();</code></pre>
</div>
</div>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The generated <code>ValidatorFactory</code> and <code>Validator</code> instances are thread-safe and can be cached. As
Hibernate Validator uses the factory as context for caching constraint metadata it is recommended to
work with one factory instance within an application.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Bean Validation supports working with several providers such as Hibernate Validator within one
application. If more than one provider is present on the classpath, it is not guaranteed which one
is chosen when creating a factory via <code>buildDefaultValidatorFactory()</code>.</p>
</div>
<div class="paragraph">
<p>In this case you can explicitly specify the provider to use via <code>Validation#byProvider()</code>, passing the
provider&#8217;s <code>ValidationProvider</code> class as shown in <a href="#example-using-specific-provider">Bootstrapping <code>ValidatorFactory</code> and Validator using a specific provider</a>.</p>
</div>
<div id="example-using-specific-provider" class="exampleblock">
<div class="title">Example 79. Bootstrapping <code>ValidatorFactory</code> and Validator using a specific provider</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">ValidatorFactory validatorFactory = Validation.byProvider( HibernateValidator.class )
        .configure()
        .buildValidatorFactory();
Validator validator = validatorFactory.getValidator();</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Note that the configuration object returned by <code>configure()</code> allows to specifically customize the
factory before calling <code>buildValidatorFactory()</code>. The available options are discussed later in this
chapter.</p>
</div>
<div class="paragraph">
<p>Similarly you can retrieve the default validator factory for configuration which is demonstrated in
<a href="#example-configuring-default-provider">Retrieving the default <code>ValidatorFactory</code> for configuration</a>.</p>
</div>
<div id="example-configuring-default-provider" class="exampleblock">
<div class="title">Example 80. Retrieving the default <code>ValidatorFactory</code> for configuration</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">ValidatorFactory validatorFactory = Validation.byDefaultProvider()
        .configure()
        .buildValidatorFactory();
Validator validator = validatorFactory.getValidator();</code></pre>
</div>
</div>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If a <code>ValidatorFactory</code> instance is no longer in use, it should be disposed by calling
<code>ValidatorFactory#close()</code>. This will free any resources possibly allocated by the factory.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="section-validation-provider-resolver"><a class="anchor" href="#section-validation-provider-resolver"></a>8.1.1. <code>ValidationProviderResolver</code></h4>
<div class="paragraph">
<p>By default, available Bean Validation providers are discovered using the
<a href="http://docs.oracle.com/javase/6/docs/technotes/guides/jar/jar.html#Service%20Provider">Java
Service Provider</a> mechanism.</p>
</div>
<div class="paragraph">
<p>For that purpose, each provider includes the file <em>META-
INF/services/javax.validation.spi.ValidationProvider</em>, containing the fully qualified classname of
its <code>ValidationProvider</code> implementation. In the case of Hibernate Validator this is
<code>org.hibernate.validator.HibernateValidator</code>.</p>
</div>
<div class="paragraph">
<p>Depending on your environment and its classloading specifics, provider discovery via the Java&#8217;s
service loader mechanism might not work. In this case you can plug in a custom
<code>ValidationProviderResolver</code> implementation which performs the provider retrieval. An example is OSGi,
where you could implement a provider resolver which uses OSGi services for provider discovery.</p>
</div>
<div class="paragraph">
<p>To use a custom provider resolver pass it via <code>providerResolver()</code> as shown shown in
<a href="#example-using-custom-validation-provider-resolver">Using a custom <code>ValidationProviderResolver</code></a>.</p>
</div>
<div id="example-using-custom-validation-provider-resolver" class="exampleblock">
<div class="title">Example 81. Using a custom <code>ValidationProviderResolver</code></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter08;

public class OsgiServiceDiscoverer implements ValidationProviderResolver {

    @Override
    public List&lt;ValidationProvider&lt;?&gt;&gt; getValidationProviders() {
        //...
        return null;
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">ValidatorFactory validatorFactory = Validation.byDefaultProvider()
        .providerResolver( new OsgiServiceDiscoverer() )
        .configure()
        .buildValidatorFactory();
Validator validator = validatorFactory.getValidator();</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="section-configuring-validator-factory"><a class="anchor" href="#section-configuring-validator-factory"></a>8.2. Configuring a <code>ValidatorFactory</code></h3>
<div class="paragraph">
<p>By default validator factories retrieved from <code>Validation</code> and any validators they create are
configured as per the XML descriptor <em>META-INF/validation.xml</em> (see <a href="#chapter-xml-configuration">Configuring via XML</a>),
if present.</p>
</div>
<div class="paragraph">
<p>If you want to disable the XML based configuration, you can do so by invoking
<code>Configuration#ignoreXmlConfiguration()</code>.</p>
</div>
<div class="paragraph">
<p>The different values of the XML configuration can be accessed via
<code>Configuration#getBootstrapConfiguration()</code>. This can for instance be helpful if you want to integrate
Bean Validation into a managed environment and want to create managed instances of the objects
configured via XML.</p>
</div>
<div class="paragraph">
<p>Using the fluent configuration API, you can override one or more of the settings when bootstrapping
the factory. The following sections show how to make use of the different options. Note that the
<code>Configuration</code> class exposes the default implementations of the different extension points which can
be useful if you want to use these as delegates for your custom implementations.</p>
</div>
<div class="sect3">
<h4 id="section-validator-factory-message-interpolator"><a class="anchor" href="#section-validator-factory-message-interpolator"></a>8.2.1. <code>MessageInterpolator</code></h4>
<div class="paragraph">
<p>Message interpolators are used by the validation engine to create user readable error messages from
constraint message descriptors.</p>
</div>
<div class="paragraph">
<p>In case the default message interpolation algorithm described in <a href="#chapter-message-interpolation">Interpolating constraint error messages</a>
is not sufficient for your needs, you can pass in your own implementation of the <code>MessageInterpolator</code>
interface via <code>Configuration#messageInterpolator()</code> as shown in
<a href="#example-using-custom-message-interpolator">Using a custom <code>MessageInterpolator</code></a>.</p>
</div>
<div id="example-using-custom-message-interpolator" class="exampleblock">
<div class="title">Example 82. Using a custom <code>MessageInterpolator</code></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter08;

public class MyMessageInterpolator implements MessageInterpolator {

    @Override
    public String interpolate(String messageTemplate, Context context) {
        //...
        return null;
    }

    @Override
    public String interpolate(String messageTemplate, Context context, Locale locale) {
        //...
        return null;
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">ValidatorFactory validatorFactory = Validation.byDefaultProvider()
        .configure()
        .messageInterpolator( new MyMessageInterpolator() )
        .buildValidatorFactory();
Validator validator = validatorFactory.getValidator();</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="__code_traversableresolver_code"><a class="anchor" href="#__code_traversableresolver_code"></a>8.2.2. <code>TraversableResolver</code></h4>
<div class="paragraph">
<p>In some cases the validation engine should not access the state of a bean property. The most obvious
example for that is a lazily loaded property or association of a JPA entity. Validating this lazy
property or association would mean that its state would have to be accessed, triggering a load from
the database.</p>
</div>
<div class="paragraph">
<p>Which properties can be accessed and which ones not is controlled by querying the
<code>TraversableResolver</code> interface. <a href="#example-using-custom-traversable-resolver">Using a custom <code>TraversableResolver</code></a> shows how to use a
custom traversable resolver implementation.</p>
</div>
<div id="example-using-custom-traversable-resolver" class="exampleblock">
<div class="title">Example 83. Using a custom <code>TraversableResolver</code></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter08;

public class MyTraversableResolver implements TraversableResolver {

    @Override
    public boolean isReachable(
            Object traversableObject,
            Node traversableProperty,
            Class&lt;?&gt; rootBeanType,
            Path pathToTraversableObject,
            ElementType elementType) {
        //...
        return false;
    }

    @Override
    public boolean isCascadable(
            Object traversableObject,
            Node traversableProperty,
            Class&lt;?&gt; rootBeanType,
            Path pathToTraversableObject,
            ElementType elementType) {
        //...
        return false;
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">ValidatorFactory validatorFactory = Validation.byDefaultProvider()
        .configure()
        .traversableResolver( new MyTraversableResolver() )
        .buildValidatorFactory();
Validator validator = validatorFactory.getValidator();</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>If no specific traversable resolver has been configured, the default behavior is to consider all properties as reachable and cascadable.
When using Hibernate Validator together with a JPA 2 provider such as Hibernate ORM, only those properties will be considered reachable
which already have been loaded by the persistence provider and all properties will be considered cascadable.</p>
</div>
</div>
<div class="sect3">
<h4 id="__code_constraintvalidatorfactory_code"><a class="anchor" href="#__code_constraintvalidatorfactory_code"></a>8.2.3. <code>ConstraintValidatorFactory</code></h4>
<div class="paragraph">
<p><code>ConstraintValidatorFactory</code> is the extension point for customizing how constraint validators are
instantiated and released.</p>
</div>
<div class="paragraph">
<p>The default <code>ConstraintValidatorFactory</code> provided by Hibernate Validator requires a public no-arg
constructor to instantiate <code>ConstraintValidator</code> instances (see <a href="#section-constraint-validator">The constraint validator</a>).
Using a custom <code>ConstraintValidatorFactory</code> offers for example the possibility to use dependency
injection in constraint validator implementations.</p>
</div>
<div class="paragraph">
<p>To configure a custom constraint validator factory call <code>Configuration#constraintValidatorFactory()</code>
(see <a href="#example-using-custom-constraint-validator-factory">Using a custom <code>ConstraintValidatorFactory</code></a>.</p>
</div>
<div id="example-using-custom-constraint-validator-factory" class="exampleblock">
<div class="title">Example 84. Using a custom <code>ConstraintValidatorFactory</code></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter08;

public class MyConstraintValidatorFactory implements ConstraintValidatorFactory {

    @Override
    public &lt;T extends ConstraintValidator&lt;?, ?&gt;&gt; T getInstance(Class&lt;T&gt; key) {
        //...
        return null;
    }

    @Override
    public void releaseInstance(ConstraintValidator&lt;?, ?&gt; instance) {
        //...
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">ValidatorFactory validatorFactory = Validation.byDefaultProvider()
        .configure()
        .constraintValidatorFactory( new MyConstraintValidatorFactory() )
        .buildValidatorFactory();
Validator validator = validatorFactory.getValidator();</code></pre>
</div>
</div>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Any constraint implementations relying on <code>ConstraintValidatorFactory</code> behaviors specific to an
implementation (dependency injection, no no-arg constructor and so on) are not considered portable.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p><code>ConstraintValidatorFactory</code> implementations should not cache validator instances as the state of each
instance can be altered in the <code>initialize()</code> method.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="section-parameter-name-provider"><a class="anchor" href="#section-parameter-name-provider"></a>8.2.4. <code>ParameterNameProvider</code></h4>
<div class="paragraph">
<p>In case a method or constructor parameter constraint is violated, the <code>ParameterNameProvider</code>
interface is used to retrieve the parameter name and make it available to the user via the
property path of the constraint violation.</p>
</div>
<div class="paragraph">
<p>The default implementation returns parameter names in the form of <code>arg0</code>, <code>arg1</code> etc, while custom
implementations can retrieve the parameter names using methods such as parameter annotations,
debug symbols, or Java 8 reflection.</p>
</div>
<div class="paragraph">
<p>An implementation for retrieving the parameter names using reflection in Java 8 is provided with
<code>ReflectionParameterNameProvider</code>. For this parameter name provider to work, the
source must be compiled using the <code>–parameters</code> compiler argument. Otherwise, the provider will
return synthetic names in the form of <code>arg0</code>, <code>arg1</code>, etc.</p>
</div>
<div class="paragraph">
<p>To use <code>ReflectionParameterNameProvider</code> or another custom provider either pass an instance of
the provider during bootstrapping as shown in <a href="#example-using-custom-parameter-name-provider">Using a custom <code>ParameterNameProvider</code></a>,
or specify the fully qualified class name of the provider as value for
the <code>&lt;parameter-name-provider&gt;</code> element in the <em>META-INF/validation.xml</em> file
(see <a href="#section-configuration-validation-xml">Configuring the validator factory in <em>validation.xml</em></a>). This is demonstrated in
<a href="#example-using-custom-parameter-name-provider">Using a custom <code>ParameterNameProvider</code></a>.</p>
</div>
<div id="example-using-custom-parameter-name-provider" class="exampleblock">
<div class="title">Example 85. Using a custom <code>ParameterNameProvider</code></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter08;

public class MyParameterNameProvider implements ParameterNameProvider {

    @Override
    public List&lt;String&gt; getParameterNames(Constructor&lt;?&gt; constructor) {
        //...
        return null;
    }

    @Override
    public List&lt;String&gt; getParameterNames(Method method) {
        //...
        return null;
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">ValidatorFactory validatorFactory = Validation.byDefaultProvider()
        .configure()
        .parameterNameProvider( new MyParameterNameProvider() )
        .buildValidatorFactory();
Validator validator = validatorFactory.getValidator();</code></pre>
</div>
</div>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Hibernate Validator comes with a custom <code>ParameterNameProvider</code> implementation based on the
<a href="https://github.com/paul-hammant/paranamer/">ParaNamer</a> library which provides several ways
for obtaining parameter names at runtime. Refer to <a href="#section-paranamer-parameternameprovider">ParaNamer based <code>ParameterNameProvider</code></a>
to learn more about this specific implementation.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_adding_mapping_streams"><a class="anchor" href="#_adding_mapping_streams"></a>8.2.5. Adding mapping streams</h4>
<div class="paragraph">
<p>As discussed earlier you can configure the constraints applying for your Java beans using XML based
constraint mappings.</p>
</div>
<div class="paragraph">
<p>Besides the mapping files specified in <em>META-INF/validation.xml</em> you can add further mappings via
<code>Configuration#addMapping()</code> (see <a href="#example-adding-mapping-streams">Adding constraint mapping streams</a>). Note that the passed input
stream(s) must adhere to the XML schema for constraint mappings presented in
<a href="#section-mapping-xml-constraints">Mapping constraints via <code>constraint-mappings</code></a>.</p>
</div>
<div id="example-adding-mapping-streams" class="exampleblock">
<div class="title">Example 86. Adding constraint mapping streams</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">InputStream constraintMapping1 = null;
InputStream constraintMapping2 = null;
ValidatorFactory validatorFactory = Validation.byDefaultProvider()
        .configure()
        .addMapping( constraintMapping1 )
        .addMapping( constraintMapping2 )
        .buildValidatorFactory();
Validator validator = validatorFactory.getValidator();</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>You should close any passed input stream after the validator factory has been created.</p>
</div>
</div>
<div class="sect3">
<h4 id="section-provider-specific-settings"><a class="anchor" href="#section-provider-specific-settings"></a>8.2.6. Provider-specific settings</h4>
<div class="paragraph">
<p>Via the configuration object returned by <code>Validation#byProvider()</code> provider specific options can be
configured.</p>
</div>
<div class="paragraph">
<p>In case of Hibernate Validator this e.g. allows you to enable the fail fast mode and pass one or
more programmatic constraint mappings as demonstrated in
<a href="#example-hibernate-validator-specific-options">Setting Hibernate Validator specific options</a>.</p>
</div>
<div id="example-hibernate-validator-specific-options" class="exampleblock">
<div class="title">Example 87. Setting Hibernate Validator specific options</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">ValidatorFactory validatorFactory = Validation.byProvider( HibernateValidator.class )
        .configure()
        .failFast( true )
        .addMapping( (ConstraintMapping) null )
        .buildValidatorFactory();
Validator validator = validatorFactory.getValidator();</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Alternatively, provider-specific options can be passed via <code>Configuration#addProperty()</code>. Hibernate
Validator supports enabling the fail fast mode that way, too:</p>
</div>
<div id="example-hibernate-validator-specific-option-via-addproperty" class="exampleblock">
<div class="title">Example 88. Enabling a Hibernate Validator specific option via <code>addProperty()</code></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">ValidatorFactory validatorFactory = Validation.byProvider( HibernateValidator.class )
        .configure()
        .addProperty( "hibernate.validator.fail_fast", "true" )
        .buildValidatorFactory();
Validator validator = validatorFactory.getValidator();</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Refer to <a href="#section-fail-fast">Fail fast mode</a> and <a href="#section-programmatic-api">Programmatic constraint definition and declaration</a> to learn more about the fail fast
mode and the constraint declaration API.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="section-configuring-validator"><a class="anchor" href="#section-configuring-validator"></a>8.3. Configuring a Validator</h3>
<div class="paragraph">
<p>When working with a configured validator factory it can occasionally be required to apply a
different configuration to a single <code>Validator</code> instance. <a href="#example-using-context">Configuring a <code>Validator</code> instance via <code>usingContext()</code></a> shows how this can
be achieved by calling <code>ValidatorFactory#usingContext()</code>.</p>
</div>
<div id="example-using-context" class="exampleblock">
<div class="title">Example 89. Configuring a <code>Validator</code> instance via <code>usingContext()</code></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">ValidatorFactory validatorFactory = Validation.buildDefaultValidatorFactory();

Validator validator = validatorFactory.usingContext()
        .messageInterpolator( new MyMessageInterpolator() )
        .traversableResolver( new MyTraversableResolver() )
        .getValidator();</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="validator-metadata-api"><a class="anchor" href="#validator-metadata-api"></a>9. Using constraint metadata</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The Bean Validation specification provides not only a validation engine, but also an API for
retrieving constraint metadata in a uniform way, no matter whether the constraints are declared
using annotations or via XML mappings. Read this chapter to learn more about this API and its
possibilities. You can find all the metadata API types in the package <code>javax.validation.metadata</code>.</p>
</div>
<div class="paragraph">
<p>The examples presented in this chapter are based on the classes and constraint declarations shown in
<a href="#metadata-example-car">Example classes</a>.</p>
</div>
<div id="metadata-example-car" class="exampleblock">
<div class="title">Example 90. Example classes</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter09;

public class Person {

    public interface Basic {
    }

    @NotNull
    private String name;

    //getters and setters ...
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter09;

public interface Vehicle {

    public interface Basic {
    }

    @NotNull(groups = Vehicle.Basic.class)
    String getManufacturer();
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter09;

@ValidCar
public class Car implements Vehicle {

    public interface SeverityInfo extends Payload {
    }

    private String manufacturer;

    @NotNull
    @Size(min = 2, max = 14)
    private String licensePlate;

    private Person driver;

    private String modelName;

    public Car() {
    }

    public Car(
            @NotNull String manufacturer,
            String licencePlate,
            Person driver,
            String modelName) {

        this.manufacturer = manufacturer;
        this.licensePlate = licencePlate;
        this.driver = driver;
        this.modelName = modelName;
    }

    public void driveAway(@Max(75) int speed) {
        //...
    }

    @LuggageCountMatchesPassengerCount(
            piecesOfLuggagePerPassenger = 2,
            validationAppliesTo = ConstraintTarget.PARAMETERS,
            payload = SeverityInfo.class,
            message = "There must not be more than {piecesOfLuggagePerPassenger} pieces " +
                    "of luggage per passenger."
    )
    public void load(List&lt;Person&gt; passengers, List&lt;PieceOfLuggage&gt; luggage) {
        //...
    }

    @Override
    @Size(min = 3)
    public String getManufacturer() {
        return manufacturer;
    }

    public void setManufacturer(String manufacturer) {
        this.manufacturer = manufacturer;
    }

    @Valid
    @ConvertGroup(from = Default.class, to = Person.Basic.class)
    public Person getDriver() {
        return driver;
    }

    //further getters and setters...
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="__code_beandescriptor_code"><a class="anchor" href="#__code_beandescriptor_code"></a>9.1. <code>BeanDescriptor</code></h3>
<div class="paragraph">
<p>The entry point into the metadata API is the method <code>Validator#getConstraintsForClass()</code>, which
returns an instance of the <code><a href="http://docs.jboss.org/hibernate/beanvalidation/spec/1.1/api/index.
html?javax/validation/metadata/BeanDescriptor.html">BeanDescriptor</a></code> interface. Using this
descriptor, you can obtain metadata for constraints declared directly on the bean itself (class- or
property-level), but also retrieve metadata descriptors representing single properties, methods and
constructors.</p>
</div>
<div class="paragraph">
<p><a href="#metadata-example-using-beandescriptor">Using <code>BeanDescriptor</code></a> demonstrates how to retrieve a <code>BeanDescriptor</code> for the
<code>Car</code> class and how to use this descriptor in form of assertions.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If a constraint declaration hosted by the requested class is invalid, a <code>ValidationException</code> is thrown.</p>
</div>
</td>
</tr>
</table>
</div>
<div id="metadata-example-using-beandescriptor" class="exampleblock">
<div class="title">Example 91. Using <code>BeanDescriptor</code></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">BeanDescriptor carDescriptor = validator.getConstraintsForClass( Car.class );

assertTrue( carDescriptor.isBeanConstrained() );

//one class-level constraint
assertEquals( 1, carDescriptor.getConstraintDescriptors().size() );

//manufacturer, licensePlate, driver
assertEquals( 3, carDescriptor.getConstrainedProperties().size() );

//property has constraint
assertNotNull( carDescriptor.getConstraintsForProperty( "licensePlate" ) );

//property is marked with @Valid
assertNotNull( carDescriptor.getConstraintsForProperty( "driver" ) );

//constraints from getter method in interface and implementation class are returned
assertEquals(
        2,
        carDescriptor.getConstraintsForProperty( "manufacturer" )
                .getConstraintDescriptors()
                .size()
);

//property is not constrained
assertNull( carDescriptor.getConstraintsForProperty( "modelName" ) );

//driveAway(int), load(List&lt;Person&gt;, List&lt;PieceOfLuggage&gt;)
assertEquals( 2, carDescriptor.getConstrainedMethods( MethodType.NON_GETTER ).size() );

//driveAway(int), getManufacturer(), getDriver(), load(List&lt;Person&gt;, List&lt;PieceOfLuggage&gt;)
assertEquals(
        4,
        carDescriptor.getConstrainedMethods( MethodType.NON_GETTER, MethodType.GETTER )
                .size()
);

//driveAway(int)
assertNotNull( carDescriptor.getConstraintsForMethod( "driveAway", int.class ) );

//getManufacturer()
assertNotNull( carDescriptor.getConstraintsForMethod( "getManufacturer" ) );

//setManufacturer() is not constrained
assertNull( carDescriptor.getConstraintsForMethod( "setManufacturer", String.class ) );

//Car(String, String, Person, String)
assertEquals( 1, carDescriptor.getConstrainedConstructors().size() );

//Car(String, String, Person, String)
assertNotNull(
        carDescriptor.getConstraintsForConstructor(
                String.class,
                String.class,
                Person.class,
                String.class
        )
);</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>You can determine whether the specified class hosts any class- or property-level constraints via
<code>isBeanConstrained()</code>. Method or constructor constraints are not considered by <code>isBeanConstrained()</code>.</p>
</div>
<div class="paragraph">
<p>The method <code>getConstraintDescriptors()</code> is common to all descriptors derived from <code>ElementDescriptor</code>
(see <a href="#validator-metadata-api-elementdescriptor"><code>ElementDescriptor</code></a>) and returns a set of descriptors representing the
constraints directly declared on the given element. In case of <code>BeanDescriptor</code>, the bean&#8217;s class-
level constraints are returned. More details on <code>ConstraintDescriptor</code> can be found in
<a href="#section-constraint-descriptor"><code>ConstraintDescriptor</code></a>.</p>
</div>
<div class="paragraph">
<p>Via <code>getConstraintsForProperty()</code>, <code>getConstraintsForMethod()</code> and <code>getConstraintsForConstructor()</code> you
can obtain a descriptor representing one given property or executable element, identified by its
name and, in case of methods and constructors, parameter types. The different descriptor types
returned by these methods are described in the following sections.</p>
</div>
<div class="paragraph">
<p>Note that these methods consider constraints declared at super-types according to the rules for
constraint inheritance as described in <a href="#section-constraint-inheritance">Constraint inheritance</a>. An example is the
descriptor for the <code>manufacturer</code> property, which provides access to all constraints defined on
<code>Vehicle#getManufacturer()</code> and the implementing method <code>Car#getManufacturer()</code>. <code>null</code> is returned in
case the specified element does not exist or is not constrained.</p>
</div>
<div class="paragraph">
<p>The methods <code>getConstrainedProperties()</code>, <code>getConstrainedMethods()</code> and <code>getConstrainedConstructors()</code>
return (potentially empty) sets with all constrained properties, methods and constructors,
respectively. An element is considered constrained, if it has at least one constraint or is marked
for cascaded validation. When invoking <code>getConstrainedMethods()</code>, you can specify the type of the
methods to be returned (getters, non-getters or both).</p>
</div>
</div>
<div class="sect2">
<h3 id="section-property-descriptor"><a class="anchor" href="#section-property-descriptor"></a>9.2. <code>PropertyDescriptor</code></h3>
<div class="paragraph">
<p>The interface
<code><a href="http://docs.jboss.org/hibernate/beanvalidation/spec/1.1/api/index.html?javax/validation/metadata/PropertyDescriptor.html">PropertyDescriptor</a></code> represents one given property of a
class. It is transparent whether constraints are declared on a field or a property getter, provided
the JavaBeans naming conventions are respected. <a href="#metadata-example-using-propertydescriptor">Using <code>PropertyDescriptor</code></a> shows
how to use the <code>PropertyDescriptor</code> interface.</p>
</div>
<div id="metadata-example-using-propertydescriptor" class="exampleblock">
<div class="title">Example 92. Using <code>PropertyDescriptor</code></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">PropertyDescriptor licensePlateDescriptor = carDescriptor.getConstraintsForProperty(
        "licensePlate"
);

//"licensePlate" has two constraints, is not marked with @Valid and defines no group conversions
assertEquals( "licensePlate", licensePlateDescriptor.getPropertyName() );
assertEquals( 2, licensePlateDescriptor.getConstraintDescriptors().size() );
assertTrue( licensePlateDescriptor.hasConstraints() );
assertFalse( licensePlateDescriptor.isCascaded() );
assertTrue( licensePlateDescriptor.getGroupConversions().isEmpty() );

PropertyDescriptor driverDescriptor = carDescriptor.getConstraintsForProperty( "driver" );

//"driver" has no constraints, is marked with @Valid and defines one group conversion
assertEquals( "driver", driverDescriptor.getPropertyName() );
assertTrue( driverDescriptor.getConstraintDescriptors().isEmpty() );
assertFalse( driverDescriptor.hasConstraints() );
assertTrue( driverDescriptor.isCascaded() );
assertEquals( 1, driverDescriptor.getGroupConversions().size() );</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Using <code>getConstrainedDescriptors()</code>, you can retrieve a set of <code>ConstraintDescriptors</code> providing more
information on the individual constraints of a given property. The method <code>isCascaded()</code> returns
<code>true</code>, if the property is marked for cascaded validation (either using the <code>@Valid</code> annotation or via
XML), <code>false</code> otherwise. Any configured group conversions are returned by <code>getGroupConversions()</code>. See
<a href="#section-group-conversion-descriptor"><code>GroupConversionDescriptor</code></a> for more details on <code>GroupConversionDescriptor</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="__code_methoddescriptor_code_and_code_constructordescriptor_code"><a class="anchor" href="#__code_methoddescriptor_code_and_code_constructordescriptor_code"></a>9.3. <code>MethodDescriptor</code> and <code>ConstructorDescriptor</code></h3>
<div class="paragraph">
<p>Constrained methods and constructors are represented by the interfaces
<code><a href="http://docs.jboss.org/hibernate/beanvalidation/spec/1.1/api/index.html?javax/validation/metadata/MethodDescriptor.html">MethodDescriptor</a></code>
and <code><a href="http://docs.jboss.org/hibernate/beanvalidation/spec/1.1/api/index.html?javax/validation/metadata/ConstructorDescriptor.html">ConstructorDescriptor</a></code>, respectively.
<a href="#metadata-example-using-methodandconstructordescriptor">Using <code>MethodDescriptor</code> and <code>ConstructorDescriptor</code></a> demonstrates how to work with these
descriptors.</p>
</div>
<div id="metadata-example-using-methodandconstructordescriptor" class="exampleblock">
<div class="title">Example 93. Using <code>MethodDescriptor</code> and <code>ConstructorDescriptor</code></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">//driveAway(int) has a constrained parameter and an unconstrained return value
MethodDescriptor driveAwayDescriptor = carDescriptor.getConstraintsForMethod(
        "driveAway",
        int.class
);
assertEquals( "driveAway", driveAwayDescriptor.getName() );
assertTrue( driveAwayDescriptor.hasConstrainedParameters() );
assertFalse( driveAwayDescriptor.hasConstrainedReturnValue() );

//always returns an empty set; constraints are retrievable by navigating to
//one of the sub-descriptors, e.g. for the return value
assertTrue( driveAwayDescriptor.getConstraintDescriptors().isEmpty() );

ParameterDescriptor speedDescriptor = driveAwayDescriptor.getParameterDescriptors()
        .get( 0 );

//The "speed" parameter is located at index 0, has one constraint and is not cascaded
//nor does it define group conversions
assertEquals( "arg0", speedDescriptor.getName() );
assertEquals( 0, speedDescriptor.getIndex() );
assertEquals( 1, speedDescriptor.getConstraintDescriptors().size() );
assertFalse( speedDescriptor.isCascaded() );
assert speedDescriptor.getGroupConversions().isEmpty();

//getDriver() has no constrained parameters but its return value is marked for cascaded
//validation and declares one group conversion
MethodDescriptor getDriverDescriptor = carDescriptor.getConstraintsForMethod(
        "getDriver"
);
assertFalse( getDriverDescriptor.hasConstrainedParameters() );
assertTrue( getDriverDescriptor.hasConstrainedReturnValue() );

ReturnValueDescriptor returnValueDescriptor = getDriverDescriptor.getReturnValueDescriptor();
assertTrue( returnValueDescriptor.getConstraintDescriptors().isEmpty() );
assertTrue( returnValueDescriptor.isCascaded() );
assertEquals( 1, returnValueDescriptor.getGroupConversions().size() );

//load(List&lt;Person&gt;, List&lt;PieceOfLuggage&gt;) has one cross-parameter constraint
MethodDescriptor loadDescriptor = carDescriptor.getConstraintsForMethod(
        "load",
        List.class,
        List.class
);
assertTrue( loadDescriptor.hasConstrainedParameters() );
assertFalse( loadDescriptor.hasConstrainedReturnValue() );
assertEquals(
        1,
        loadDescriptor.getCrossParameterDescriptor().getConstraintDescriptors().size()
);

//Car(String, String, Person, String) has one constrained parameter
ConstructorDescriptor constructorDescriptor = carDescriptor.getConstraintsForConstructor(
        String.class,
        String.class,
        Person.class,
        String.class
);

assertEquals( "Car", constructorDescriptor.getName() );
assertFalse( constructorDescriptor.hasConstrainedReturnValue() );
assertTrue( constructorDescriptor.hasConstrainedParameters() );
assertEquals(
        1,
        constructorDescriptor.getParameterDescriptors()
                .get( 0 )
                .getConstraintDescriptors()
                .size()
);</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p><code>getName()</code> returns the name of the given method or constructor. The methods
<code>hasConstrainedParameters()</code> and <code>hasConstrainedReturnValue()</code> can be used to perform a quick check
whether an executable element has any parameter constraints (either constraints on single parameters
or cross-parameter constraints) or return value constraints.</p>
</div>
<div class="paragraph">
<p>Note that any constraints are not directly exposed on <code>MethodDescriptor</code> and <code>ConstructorDescriptor</code>,
but rather on dedicated descriptors representing an executable&#8217;s parameters, its return value and
its cross-parameter constraints. To get hold of one of these descriptors, invoke
<code>getParameterDescriptors()</code>, <code>getReturnValueDescriptor()</code> or <code>getCrossParameterDescriptor()</code>,
respectively.</p>
</div>
<div class="paragraph">
<p>These descriptors provide access to the element&#8217;s constraints (<code>getConstraintDescriptors()</code>) and, in
case of parameters and return value, to its configuration for cascaded validation (<code>isValid()</code> and
<code>getGroupConversions()</code>). For parameters, you also can retrieve the index and the name, as returned by
the currently used parameter name provider (see <a href="#section-parameter-name-provider"><code>ParameterNameProvider</code></a>) via <code>getName()</code>
and <code>getIndex()</code>.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Getter methods following the JavaBeans naming conventions are considered as bean properties but also
as constrained methods.</p>
</div>
<div class="paragraph">
<p>That means you can retrieve the related metadata either by obtaining a <code>PropertyDescriptor</code> (e.g.
<code>BeanDescriptor.getConstraintsForProperty("foo")</code>) or by examining the return value descriptor of the
getter&#8217;s <code>MethodDescriptor</code> (e.g.
<code>BeanDescriptor.getConstraintsForMethod("getFoo").getReturnValueDescriptor())</code>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="validator-metadata-api-elementdescriptor"><a class="anchor" href="#validator-metadata-api-elementdescriptor"></a>9.4. <code>ElementDescriptor</code></h3>
<div class="paragraph">
<p>The <code><a href="http://docs.jboss.org/hibernate/beanvalidation/spec/1.1/api/index.html?javax/validation/metadata/ElementDescriptor.html">ElementDiscriptor</a></code>
interface is the common base class for the
individual descriptor types such as <code>BeanDescriptor</code>, <code>PropertyDescriptor</code> etc. Besides
<code>getConstraintDescriptors()</code> it provides some more methods common to all descriptors.</p>
</div>
<div class="paragraph">
<p><code>hasConstraints()</code> allows for a quick check whether an element has any direct constraints (e.g. class-
level constraints in case of <code>BeanDescriptor</code>). <code>getElementClass()</code> returns the Java type of the element
represented by a given descriptor. More specifically, the method returns</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the object type when invoked on <code>BeanDescriptor</code>,</p>
</li>
<li>
<p>the type of a property or parameter when invoked on <code>PropertyDescriptor</code> or <code>ParameterDescriptor</code>
respectively,</p>
</li>
<li>
<p><code>Object[].class</code> when invoked on <code>CrossParameterDescriptor</code>,</p>
</li>
<li>
<p>the return type when invoked on <code>ConstructorDescriptor</code>, <code>MethodDescriptor</code> or <code>ReturnValueDescriptor</code>.
<code>void.class</code> will be returned for methods which don&#8217;t have a return value.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><a href="#metadata-example-using-elementdescriptor">Using <code>ElementDescriptor methods</code></a> shows how these methods are used.</p>
</div>
<div id="metadata-example-using-elementdescriptor" class="exampleblock">
<div class="title">Example 94. Using <code>ElementDescriptor methods</code></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">PropertyDescriptor manufacturerDescriptor = carDescriptor.getConstraintsForProperty(
        "manufacturer"
);

assertTrue( manufacturerDescriptor.hasConstraints() );
assertEquals( String.class, manufacturerDescriptor.getElementClass() );

CrossParameterDescriptor loadCrossParameterDescriptor = carDescriptor.getConstraintsForMethod(
        "load",
        List.class,
        List.class
).getCrossParameterDescriptor();

assertTrue( loadCrossParameterDescriptor.hasConstraints() );
assertEquals( Object[].class, loadCrossParameterDescriptor.getElementClass() );</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Finally, <code>ElementDescriptor</code> offers access to the <code>ConstraintFinder</code> API which allows you to query for
constraint metadata in a fine grained way. <a href="#example-constraint-finder">Usage of <code>ConstraintFinder</code></a> shows how to retrieve a
<code>ConstraintFinder</code> instance via <code>findConstraints()</code> and use the API to query for constraint metadata.</p>
</div>
<div id="example-constraint-finder" class="exampleblock">
<div class="title">Example 95. Usage of <code>ConstraintFinder</code></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">PropertyDescriptor manufacturerDescriptor = carDescriptor.getConstraintsForProperty(
        "manufacturer"
);

//"manufacturer" constraints are declared on the getter, not the field
assertTrue(
        manufacturerDescriptor.findConstraints()
                .declaredOn( ElementType.FIELD )
                .getConstraintDescriptors()
                .isEmpty()
);

//@NotNull on Vehicle#getManufacturer() is part of another group
assertEquals(
        1,
        manufacturerDescriptor.findConstraints()
                .unorderedAndMatchingGroups( Default.class )
                .getConstraintDescriptors()
                .size()
);

//@Size on Car#getManufacturer()
assertEquals(
        1,
        manufacturerDescriptor.findConstraints()
                .lookingAt( Scope.LOCAL_ELEMENT )
                .getConstraintDescriptors()
                .size()
);

//@Size on Car#getManufacturer() and @NotNull on Vehicle#getManufacturer()
assertEquals(
        2,
        manufacturerDescriptor.findConstraints()
                .lookingAt( Scope.HIERARCHY )
                .getConstraintDescriptors()
                .size()
);

//Combining several filter options
assertEquals(
        1,
        manufacturerDescriptor.findConstraints()
                .declaredOn( ElementType.METHOD )
                .lookingAt( Scope.HIERARCHY )
                .unorderedAndMatchingGroups( Vehicle.Basic.class )
                .getConstraintDescriptors()
                .size()
);</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Via <code>declaredOn()</code> you can search for <code>ConstraintDescriptors</code> declared on certain element types. This is
useful to find property constraints declared on either fields or getter methods.</p>
</div>
<div class="paragraph">
<p><code>unorderedAndMatchingGroups()</code> restricts the resulting constraints to those matching the given
validation group(s).</p>
</div>
<div class="paragraph">
<p><code>lookingAt()</code> allows to distinguish between constraints directly specified on the element
(<code>Scope.LOCAL_ELEMENT</code>) or constraints belonging to the element but hosted anywhere in the class
hierarchy (<code>Scope.HIERARCHY</code>).</p>
</div>
<div class="paragraph">
<p>You can also combine the different options as shown in the last example.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Order is not respected by <code>unorderedAndMatchingGroups()</code>, but group inheritance and inheritance via
sequence are.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="section-group-conversion-descriptor"><a class="anchor" href="#section-group-conversion-descriptor"></a>9.5. <code>GroupConversionDescriptor</code></h3>
<div class="paragraph">
<p>All those descriptor types that represent elements which can be subject of cascaded validation
(i.e., <code>PropertyDescriptor</code>, <code>ParameterDescriptor</code> and <code>ReturnValueDescriptor</code>) provide access to the
element&#8217;s group conversions via <code>getGroupConversions()</code>. The returned set contains a
<code><a href="http://docs.jboss.org/hibernate/beanvalidation/spec/1.1/api/index.html?javax/validation/metadata/GroupConversionDescriptor.html">GroupConversionDescriptor</a></code>
for each configured conversion, allowing to retrieve
source and target groups of the conversion. <a href="#metadata-example-using-groupconversiondescriptor">Using <code>GroupConversionDescriptor</code></a>
shows an example.</p>
</div>
<div id="metadata-example-using-groupconversiondescriptor" class="exampleblock">
<div class="title">Example 96. Using <code>GroupConversionDescriptor</code></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">PropertyDescriptor driverDescriptor = carDescriptor.getConstraintsForProperty( "driver" );

Set&lt;GroupConversionDescriptor&gt; groupConversions = driverDescriptor.getGroupConversions();
assertEquals( 1, groupConversions.size() );

GroupConversionDescriptor groupConversionDescriptor = groupConversions.iterator()
        .next();
assertEquals( Default.class, groupConversionDescriptor.getFrom() );
assertEquals( Person.Basic.class, groupConversionDescriptor.getTo() );</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="section-constraint-descriptor"><a class="anchor" href="#section-constraint-descriptor"></a>9.6. <code>ConstraintDescriptor</code></h3>
<div class="paragraph">
<p>Last but not least, the
<code><a href="http://docs.jboss.org/hibernate/beanvalidation/spec/1.1/api/index.html?javax/validation/metadata/ConstraintDescriptor.html">ConstraintDescriptor</a></code>
interface describes a
single constraint together with its composing constraints. Via an instance of this interface you get
access to the constraint annotation and its parameters.</p>
</div>
<div class="paragraph">
<p><a href="#metadata-example-using-constraintdescriptor">Using <code>ConstraintDescriptor</code></a>
shows how to retrieve default constraint attributes (such as message template, groups etc.) as well
as custom constraint attributes (<code>piecesOfLuggagePerPassenger</code>) and other metadata such as the
constraint&#8217;s annotation type and its validators from a <code>ConstraintDescriptor</code>.</p>
</div>
<div id="metadata-example-using-constraintdescriptor" class="exampleblock">
<div class="title">Example 97. Using <code>ConstraintDescriptor</code></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">//descriptor for the @LuggageCountMatchesPassengerCount constraint on the
//load(List&lt;Person&gt;, List&lt;PieceOfLuggage&gt;) method
ConstraintDescriptor&lt;?&gt; constraintDescriptor = carDescriptor.getConstraintsForMethod(
        "load",
        List.class,
        List.class
).getCrossParameterDescriptor().getConstraintDescriptors().iterator().next();

//constraint type
assertEquals(
        LuggageCountMatchesPassengerCount.class,
        constraintDescriptor.getAnnotation().annotationType()
);

//standard constraint attributes
assertEquals( SeverityInfo.class, constraintDescriptor.getPayload().iterator().next() );
assertEquals(
        ConstraintTarget.PARAMETERS,
        constraintDescriptor.getValidationAppliesTo()
);
assertEquals( Default.class, constraintDescriptor.getGroups().iterator().next() );
assertEquals(
        "There must not be more than {piecesOfLuggagePerPassenger} pieces of luggage per " +
        "passenger.",
        constraintDescriptor.getMessageTemplate()
);

//custom constraint attribute
assertEquals(
        2,
        constraintDescriptor.getAttributes().get( "piecesOfLuggagePerPassenger" )
);

//no composing constraints
assertTrue( constraintDescriptor.getComposingConstraints().isEmpty() );

//validator class
assertEquals(
        Arrays.&lt;Class&lt;?&gt;&gt;asList( LuggageCountMatchesPassengerCount.Validator.class ),
        constraintDescriptor.getConstraintValidatorClasses()
);</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="validator-integration"><a class="anchor" href="#validator-integration"></a>10. Integrating with other frameworks</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Hibernate Validator is intended to be used to implement multi-layered data validation, where
constraints are expressed in a single place (the annotated domain model) and checked in various
different layers of the application. For this reason there are multiple integration points with
other technologies.</p>
</div>
<div class="sect2">
<h3 id="validator-checkconstraints-orm"><a class="anchor" href="#validator-checkconstraints-orm"></a>10.1. ORM integration</h3>
<div class="paragraph">
<p>Hibernate Validator integrates with both Hibernate and all pure Java Persistence providers.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When lazy loaded associations are supposed to be validated it is recommended to place the constraint
on the getter of the association. Hibernate replaces lazy loaded associations with proxy instances
which get initialized/loaded when requested via the getter. If, in such a case, the constraint is
placed on field level the actual proxy instance is used which will lead to validation errors.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="validator-checkconstraints-db"><a class="anchor" href="#validator-checkconstraints-db"></a>10.1.1. Database schema-level validation</h4>
<div class="paragraph">
<p>Out of the box, Hibernate (as of version 3.5.x) will translate the constraints you have defined for
your entities into mapping metadata. For example, if a property of your entity is annotated
<code>@NotNull</code>, its columns will be declared as <code>not null</code> in the DDL schema generated by Hibernate.</p>
</div>
<div class="paragraph">
<p>If, for some reason, the feature needs to be disabled, set <code>hibernate.validator.apply_to_ddl</code> to
<code>false</code>. See also <a href="#validator-defineconstraints-spec">Bean Validation constraints</a> and <a href="#validator-defineconstraints-hv-constraints">Additional constraints</a>.</p>
</div>
<div class="paragraph">
<p>You can also limit the DDL constraint generation to a subset of the defined constraints by setting
the property <code>org.hibernate.validator.group.ddl</code>. The property specifies the comma-separated, fully
specified class names of the groups a constraint has to be part of in order to be considered for DDL
schema generation.</p>
</div>
</div>
<div class="sect3">
<h4 id="validator-checkconstraints-orm-hibernateevent"><a class="anchor" href="#validator-checkconstraints-orm-hibernateevent"></a>10.1.2. Hibernate event-based validation</h4>
<div class="paragraph">
<p>Hibernate Validator has a built-in Hibernate event listener -
<code><a href="https://github.com/hibernate/hibernate-orm/blob/master/hibernate-core/src/main/java/org/hibernate/cfg/beanvalidation/BeanValidationEventListener.java">org.hibernate.cfg.beanvalidation.BeanValidationEventListener</a></code> -
which is part of Hibernate ORM. Whenever a <code>PreInsertEvent</code>,
<code>PreUpdateEvent</code> or <code>PreDeleteEvent</code> occurs, the listener will verify all constraints of the entity
instance and throw an exception if any constraint is violated. Per default objects will be checked
before any inserts or updates are made by Hibernate. Pre deletion events will per default not
trigger a validation. You can configure the groups to be validated per event type using the
properties <code>javax.persistence.validation.group.pre-persist</code>,
<code>javax.persistence.validation.group.pre-update</code> and <code>javax.persistence.validation.group.pre-remove</code>.
The values of these properties are the comma-separated, fully specified class names of the groups
to validate. <a href="#example-beanvalidationeventlistener-config">Manual configuration of <code>BeanValidationEvenListener</code></a> shows the default values for these
properties. In this case they could also be omitted.</p>
</div>
<div class="paragraph">
<p>On constraint violation, the event will raise a runtime <code>ConstraintViolationException</code> which contains
a set of <code>ConstraintViolation</code> instances describing each failure.</p>
</div>
<div class="paragraph">
<p>If Hibernate Validator is present in the classpath, Hibernate ORM will use it transparently.
To avoid validation even though Hibernate Validator is in the classpath set
<code>javax.persistence.validation.mode</code> to none.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If the beans are not annotated with validation annotations, there is no runtime performance cost.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In case you need to manually set the event listeners for Hibernate ORM, use the following
configuration in <em>hibernate.cfg.xml</em>:</p>
</div>
<div id="example-beanvalidationeventlistener-config" class="exampleblock">
<div class="title">Example 98. Manual configuration of <code>BeanValidationEvenListener</code></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-XML" data-lang="XML">&lt;hibernate-configuration&gt;
    &lt;session-factory&gt;
        ...
        &lt;property name="javax.persistence.validation.group.pre-persist"&gt;
            javax.validation.groups.Default
        &lt;/property&gt;
        &lt;property name="javax.persistence.validation.group.pre-update"&gt;
            javax.validation.groups.Default
        &lt;/property&gt;
        &lt;property name="javax.persistence.validation.group.pre-remove"&gt;&lt;/property&gt;
        ...
        &lt;event type="pre-update"&gt;
            &lt;listener class="org.hibernate.cfg.beanvalidation.BeanValidationEventListener"/&gt;
        &lt;/event&gt;
        &lt;event type="pre-insert"&gt;
            &lt;listener class="org.hibernate.cfg.beanvalidation.BeanValidationEventListener"/&gt;
        &lt;/event&gt;
        &lt;event type="pre-delete"&gt;
            &lt;listener class="org.hibernate.cfg.beanvalidation.BeanValidationEventListener"/&gt;
        &lt;/event&gt;
    &lt;/session-factory&gt;
&lt;/hibernate-configuration&gt;</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_jpa"><a class="anchor" href="#_jpa"></a>10.1.3. JPA</h4>
<div class="paragraph">
<p>If you are using JPA 2 and Hibernate Validator is in the classpath the JPA2 specification requires
that Bean Validation gets enabled. The properties <code>javax.persistence.validation.group.pre-persist</code>,
<code>javax.persistence.validation.group.pre-update</code> and <code>javax.persistence.validation.group.pre-remove</code> as
described in <a href="#validator-checkconstraints-orm-hibernateevent">Hibernate event-based validation</a> can in this case be configured in
<em>persistence.xml</em>. <em>persistence.xml</em> also defines a node validation-mode which can be set to <code>AUTO</code>,
<code>CALLBACK</code>, <code>NONE</code>. The default is <code>AUTO</code>.</p>
</div>
<div class="paragraph">
<p>In a JPA 1 you will have to create and register Hibernate Validator yourself. In case you are using
Hibernate EntityManager you can add a customized version of the <code>BeanValidationEventListener</code>
described in <a href="#validator-checkconstraints-orm-hibernateevent">Hibernate event-based validation</a> to your project and register it
manually.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="section-presentation-layer"><a class="anchor" href="#section-presentation-layer"></a>10.2. JSF &amp; Seam</h3>
<div class="paragraph">
<p>When working with JSF2 or JBoss Seam and Hibernate Validator (Bean Validation) is present in the
runtime environment, validation is triggered for every field in the application. <a href="#example-jsf2">Usage of Bean Validation within JSF2</a>
shows an example of the <code>f:validateBean</code> tag in a JSF page. The <code>validationGroups</code> attribute is optional
and can be used to specify a comma separated list of validation groups. The default is
<code>javax.validation.groups.Default</code>. For more information refer to the Seam documentation or the JSF 2
specification.</p>
</div>
<div id="example-jsf2" class="exampleblock">
<div class="title">Example 99. Usage of Bean Validation within JSF2</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-XML" data-lang="XML">&lt;h:form&gt;

  &lt;f:validateBean validationGroups="javax.validation.groups.Default"&gt;

    &lt;h:inputText value=#{model.property}/&gt;
    &lt;h:selectOneRadio value=#{model.radioProperty}&gt; ... &lt;/h:selectOneRadio&gt;
    &lt;!-- other input components here --&gt;

  &lt;/f:validateBean&gt;

&lt;/h:form&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The integration between JSF 2 and Bean Validation is described in the "Bean Validation Integration"
chapter of <a href="http://jcp.org/en/jsr/detail?id=314">JSR-314</a>. It is interesting to know that JSF
2 implements a custom <code>MessageInterpolator</code> to ensure ensure proper localization. To encourage the use
of the Bean Validation message facility, JSF 2 will per default only display the generated Bean
Validation message. This can, however, be configured via the application resource bundle by
providing the following configuration (<code>{0}</code> is replaced with the Bean Validation message and <code>{1}</code> is
replaced with the JSF component label):</p>
</div>
<div class="listingblock">
<div class="content">
<pre>javax.faces.validator.BeanValidator.MESSAGE={1}: {0}</pre>
</div>
</div>
<div class="paragraph">
<p>The default is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>javax.faces.validator.BeanValidator.MESSAGE={0}</pre>
</div>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="section-integration-with-cdi"><a class="anchor" href="#section-integration-with-cdi"></a>10.3. CDI</h3>
<div class="paragraph">
<p>As of version 1.1, Bean Validation is integrated with CDI (Contexts and Dependency Injection for
Java<sup>TM</sup> EE).</p>
</div>
<div class="paragraph">
<p>This integration provides CDI managed beans for <code>Validator</code> and <code>ValidatorFactory</code> and enables
dependency injection in constraint validators as well as custom message interpolators, traversable
resolvers, constraint validator factories and parameter name providers.</p>
</div>
<div class="paragraph">
<p>Furthermore, parameter and return value constraints on the methods and constructors of CDI managed
beans will automatically be validated upon invocation.</p>
</div>
<div class="paragraph">
<p>When your application runs on a Java EE container, this integration is enabled by default. When
working with CDI in a Servlet container or in a pure Java SE environment, you can use the CDI
portable extension provided by Hibernate Validator. To do so, add the portable extension to your
class path as described in <a href="#section-getting-started-cdi">CDI</a>.</p>
</div>
<div class="sect3">
<h4 id="_dependency_injection"><a class="anchor" href="#_dependency_injection"></a>10.3.1. Dependency injection</h4>
<div class="paragraph">
<p>CDI&#8217;s dependency injection mechanism makes it very easy to retrieve <code>ValidatorFactory</code> and <code>Validator</code>
instances and use them in your managed beans. Just annotate instance fields of your bean with
<code>@javax.inject.Inject</code> as shown in <a href="#example-dependency-injection">Retrieving validator factory and validator via <code>@Inject</code></a>.</p>
</div>
<div id="example-dependency-injection" class="exampleblock">
<div class="title">Example 100. Retrieving validator factory and validator via <code>@Inject</code></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter10.cdi.validator;

@ApplicationScoped
public class RentalStation {

    @Inject
    private ValidatorFactory validatorFactory;

    @Inject
    private Validator validator;

    //...
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The injected beans are the default validator factory and validator instances. In order to configure
them - e.g. to use a custom message interpolator - you can use the Bean Validation XML descriptors
as discussed in <a href="#chapter-xml-configuration">Configuring via XML</a>.</p>
</div>
<div class="paragraph">
<p>If you are working with several Bean Validation providers you can make sure that factory and
validator from Hibernate Validator are injected by annotating the injection points with the
<code>@HibernateValidator</code> qualifier which is demonstrated in <a href="#example-dependency-injection-using-hv">Using the <code>@HibernateValidator</code> qualifier annotation</a>.</p>
</div>
<div id="example-dependency-injection-using-hv" class="exampleblock">
<div class="title">Example 101. Using the <code>@HibernateValidator</code> qualifier annotation</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter10.cdi.validator.qualifier;

@ApplicationScoped
public class RentalStation {

    @Inject
    @HibernateValidator
    private ValidatorFactory validatorFactory;

    @Inject
    @HibernateValidator
    private Validator validator;

    //...
}</code></pre>
</div>
</div>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The fully-qualified name of the qualifier annotation is
<code>org.hibernate.validator.cdi.HibernateValidator</code>. Be sure to not import
<code>org.hibernate.validator.HibernateValidator</code> instead which is the <code>ValidationProvider</code> implementation
used for selecting Hibernate Validator when working with the bootstrapping API (see
<a href="#section-retrieving-validator-factory-validator">Retrieving <code>ValidatorFactory</code> and <code>Validator</code></a>).</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Via <code>@Inject</code> you also can inject dependencies into constraint validators and other Bean Validation
objects such as <code>MessageInterpolator</code> implementations etc.</p>
</div>
<div class="paragraph">
<p><a href="#example-constraint-validator-injected-bean">Constraint validator with injected bean</a>
demonstrates how an injected CDI bean is used in a <code>ConstraintValidator</code> implementation to determine
whether the given constraint is valid or not. As the example shows, you also can work with the
<code>@PostConstruct</code> and <code>@PreDestroy</code> callbacks to implement any required construction and destruction
logic.</p>
</div>
<div id="example-constraint-validator-injected-bean" class="exampleblock">
<div class="title">Example 102. Constraint validator with injected bean</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter10.cdi.injection;

public class ValidLicensePlateValidator
        implements ConstraintValidator&lt;ValidLicensePlate, String&gt; {

    @Inject
    private VehicleRegistry vehicleRegistry;

    @PostConstruct
    public void postConstruct() {
        //do initialization logic...
    }

    @PreDestroy
    public void preDestroy() {
        //do destruction logic...
    }

    @Override
    public void initialize(ValidLicensePlate constraintAnnotation) {
    }

    @Override
    public boolean isValid(String licensePlate, ConstraintValidatorContext constraintContext) {
        return vehicleRegistry.isValidLicensePlate( licensePlate );
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_method_validation"><a class="anchor" href="#_method_validation"></a>10.3.2. Method validation</h4>
<div class="paragraph">
<p>The method interception facilities of CDI allow for a very tight integration with Bean Validation&#8217;s
method validation functionality. Just put constraint annotations to the parameters and return values
of the executables of your CDI beans and they will be validated automatically before (parameter
constraints) and after (return value constraints) a method or constructor is invoked.</p>
</div>
<div class="paragraph">
<p>Note that no explicit interceptor binding is required, instead the required method validation
interceptor will automatically be registered for all managed beans with constrained methods and
constructors.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The interceptor <code>org.hibernate.validator.internal.cdi.interceptor.ValidationInterceptor</code> is
registered by <code>org.hibernate.validator.internal.cdi.ValidationExtension</code>. This happens implicitly
within a Java EE 7 runtime environment or explicitly by adding the <em>hibernate-validator-cdi</em> artifact
- see <a href="#section-getting-started-cdi">CDI</a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You can see an example in <a href="#example-cdi-method-validation">CDI managed beans with method-level constraints</a>.</p>
</div>
<div id="example-cdi-method-validation" class="exampleblock">
<div class="title">Example 103. CDI managed beans with method-level constraints</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter10.cdi.methodvalidation;

@ApplicationScoped
public class RentalStation {

    @Valid
    public RentalStation() {
        //...
    }

    @NotNull
    @Valid
    public Car rentCar(
            @NotNull Customer customer,
            @NotNull @Future Date startDate,
            @Min(1) int durationInDays) {
        //...
        return null;
    }

    @NotNull
    List&lt;Car&gt; getAvailableCars() {
        //...
        return null;
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter10.cdi.methodvalidation;

@RequestScoped
public class RentCarRequest {

    @Inject
    private RentalStation rentalStation;

    public void rentCar(String customerId, Date startDate, int duration) {
        //causes ConstraintViolationException
        rentalStation.rentCar( null, null, -1 );
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Here the <code>RentalStation</code> bean hosts several method constraints. When invoking one of the <code>RentalStation</code>
methods from another bean such as <code>RentCarRequest</code>, the constraints of the invoked method are
automatically validated. If any illegal parameter values are passed as in the example, a
<code>ConstraintViolationException</code> will be thrown by the method interceptor, providing detailed
information on the violated constraints. The same is the case if the method&#8217;s return value violates
any return value constraints.</p>
</div>
<div class="paragraph">
<p>Similarly, constructor constraints are validated automatically upon invocation. In the example the
<code>RentalStation</code> object returned by the constructor will be validated since the constructor return
value is marked with <code>@Valid</code>.</p>
</div>
<div class="sect4">
<h5 id="_validated_executable_types"><a class="anchor" href="#_validated_executable_types"></a>Validated executable types</h5>
<div class="paragraph">
<p>Bean Validation allows for a fine-grained control of the executable types which are automatically
validated. By default, constraints on constructors and non-getter methods are validated. Therefore
the <code>@NotNull</code> constraint on the method <code>RentalStation#getAvailableCars()</code> in
<a href="#example-cdi-method-validation">CDI managed beans with method-level constraints</a> gets not validated when the method is invoked.</p>
</div>
<div class="paragraph">
<p>You have the following options to configure which types of executables are validated upon
invocation:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Configure the executable types globally via the XML descriptor <em>META-INF/validation.xml</em>;
see <a href="#section-configuration-validation-xml">Configuring the validator factory in <em>validation.xml</em></a> for an example</p>
</li>
<li>
<p>Use the <code>@ValidateOnExecution</code> annotation on the executable or type level</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If several sources of configuration are specified for a given executable, <code>@ValidateOnExecution</code> on
the executable level takes precedence over <code>@ValidateOnExecution</code> on the type level and
<code>@ValidateOnExecution</code> generally takes precedence over the globally configured types in <em>META-
INF/validation.xml</em>.</p>
</div>
<div class="paragraph">
<p><a href="#example-using-validateonexecution">Using <code>@ValidateOnExecution</code></a> shows how to use the <code>@ValidateOnExecution</code> annotation:</p>
</div>
<div id="example-using-validateonexecution" class="exampleblock">
<div class="title">Example 104. Using <code>@ValidateOnExecution</code></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter10.cdi.methodvalidation.configuration;

@ApplicationScoped
@ValidateOnExecution(type = ExecutableType.ALL)
public class RentalStation {

    @Valid
    public RentalStation() {
        //...
    }

    @NotNull
    @Valid
    @ValidateOnExecution(type = ExecutableType.NONE)
    public Car rentCar(
            @NotNull Customer customer,
            @NotNull @Future Date startDate,
            @Min(1) int durationInDays) {
        //...
        return null;
    }

    @NotNull
    public List&lt;Car&gt; getAvailableCars() {
        //...
        return null;
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Here the method <code>rentCar()</code> won&#8217;t be validated upon invocation because it is annotated with
<code>@ValidateOnExecution(type = ExecutableType.NONE)</code>. In contrast, the constructor and the
method <code>getAvailableCars()</code> will be validated due to <code>@ValidateOnExecution(type =
ExecutableType.ALL)</code> being given on the type level. <code>ExecutableType.ALL</code> is a more compact form for
explicitly specifying all the types <code>CONSTRUCTORS</code>, <code>GETTER_METHODS</code> and <code>NON_GETTER_METHODS</code>.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Executable validation can be turned off globally by specifying
<code>&lt;executable-validation enabled="false"/&gt;</code> in <em>META-INF/validation.xml</em>. In this case, any
<code>@ValidateOnExecution</code> annotations are ignored.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Note that when a method overrides or implements a super-type method the configuration will be taken
from that overridden or implemented method (as given via <code>@ValidateOnExecution</code> on the method itself
or on the super-type). This protects a client of the super-type method from an unexpected alteration
of the configuration, e.g. disabling validation of an overridden executable in a sub-type.</p>
</div>
<div class="paragraph">
<p>In case a CDI managed bean overrides or implements a super-type method and this super-type method
hosts any constraints, it can happen that the validation interceptor is not properly registered with
the bean, resulting in the bean&#8217;s methods not being validated upon invocation. In this case you can
specify the executable type <code>IMPLICIT</code> on the sub-class as shown in
<a href="#example-using-executabletype-implicit">Using <code>ExecutableType.IMPLICIT</code></a>, which makes sure that all required metadata is discovered
an the validation interceptor kicks in when the methods on <code>ExpressRentalStation</code> are invoked.</p>
</div>
<div id="example-using-executabletype-implicit" class="exampleblock">
<div class="title">Example 105. Using <code>ExecutableType.IMPLICIT</code></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter10.cdi.methodvalidation.implicit;

@ValidateOnExecution(type = ExecutableType.ALL)
public interface RentalStation {

    @NotNull
    @Valid
    Car rentCar(
            @NotNull Customer customer,
            @NotNull @Future Date startDate,
            @Min(1) int durationInDays);

    @NotNull
    List&lt;Car&gt; getAvailableCars();
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter10.cdi.methodvalidation.implicit;

@ApplicationScoped
@ValidateOnExecution(type = ExecutableType.IMPLICIT)
public class ExpressRentalStation implements RentalStation {

    @Override
    public Car rentCar(Customer customer, Date startDate, @Min(1) int durationInDays) {
        //...
        return null;
    }

    @Override
    public List&lt;Car&gt; getAvailableCars() {
        //...
        return null;
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_java_ee"><a class="anchor" href="#_java_ee"></a>10.4. Java EE</h3>
<div class="paragraph">
<p>When your application runs on a Java EE application server such as <a href="WildFly"><a href="http://wildfly.org/" class="bare">http://wildfly.org/</a></a>,
you also can obtain <code>Validator</code> and <code>ValidatorFactory</code> instances via <code>@Resource</code> injection in
managed objects such as EJBs etc., as shown in <a href="#example-validator-resource-injection">Retrieving <code>Validator</code> and <code>ValidatorFactory</code> via <code>@Resource</code> injection</a>.</p>
</div>
<div id="example-validator-resource-injection" class="exampleblock">
<div class="title">Example 106. Retrieving <code>Validator</code> and <code>ValidatorFactory</code> via <code>@Resource</code> injection</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter10.javaee;

public class RentalStationBean {

    @Resource
    private ValidatorFactory validatorFactory;

    @Resource
    private Validator validator;

    //...
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Alternatively you can obtain a validator and a validator factory from JNDI under the names
"<em>java:comp/Validator</em>" and "<em>java:comp/ValidatorFactory</em>", respectively.</p>
</div>
<div class="paragraph">
<p>Similar to CDI-based injection via <code>@Inject</code>, these objects represent default validator and validator
factory and thus can be configured using the XML descriptor <em>META-INF/validation.xml</em> (see
<a href="#chapter-xml-configuration">Configuring via XML</a>).</p>
</div>
<div class="paragraph">
<p>When your application is CDI-enabled, the injected objects are CDI-aware as well and e.g. support
dependency injection in constraint validators.</p>
</div>
</div>
<div class="sect2">
<h3 id="_javafx"><a class="anchor" href="#_javafx"></a>10.5. JavaFX</h3>
<div class="paragraph">
<p>Hibernate Validator also provides support for the unwrapping of JavaFX properties. If JavaFX is present
on the classpath a <code>ValidatedValueUnwrapper</code> for JavaFX properties is automatically registered. In some
cases, however, it is also necessary to explicitly use <code>@UnwrapValidatedValue</code>. This is required if
the constraint validator resolution is not unique and there is a potential constraint validator for
the actual JavaFX property as well as the contained property value itself.
See <a href="#section-javafx-unwrapper">JavaFX unwrapper</a> for examples and further discussion.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="validator-specifics"><a class="anchor" href="#validator-specifics"></a>11. Hibernate Validator Specifics</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In this chapter you will learn how to make use of several features provided by Hibernate Validator
in addition to the functionality defined by the Bean Validation specification. This includes the
fail fast mode, the API for programmatic constraint configuration and the boolean composition of
constraints.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Using the features described in the following sections may result in application code which is not
portable between Bean Validation providers.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_public_api"><a class="anchor" href="#_public_api"></a>11.1. Public API</h3>
<div class="paragraph">
<p>Let&#8217;s start, however, with a look at the public API of Hibernate Validator. Below you can find a list of all packages belonging to this API and their purpose.
Note that when a package is part of the public API this is not necessarily true for its sub-packages.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>org.hibernate.validator</code></dt>
<dd>
<p>Classes used by the Bean Validation bootstrap mechanism (eg. validation provider, configuration class); for more details see <a href="#chapter-bootstrapping">Bootstrapping</a>.</p>
</dd>
<dt class="hdlist1"><code>org.hibernate.validator.cfg</code>, <code>org.hibernate.validator.cfg.context</code>, <code>org.hibernate.validator.cfg.defs</code>, <code>org.hibernate.validator.spi.cfg</code></dt>
<dd>
<p>Hibernate Validator&#8217;s fluent API for constraint declaration; in <code>org.hibernate.validator.cfg</code> you will find the <code>ConstraintMapping</code> interface, in <code>org.hibernate.validator.cfg.defs</code> all constraint definitions and in <code>org.hibernate.validator.spi.cfg</code> a callback for using the API for configuring the default validator factory. Refer to <a href="#section-programmatic-api">Programmatic constraint definition and declaration</a> for the details.</p>
</dd>
<dt class="hdlist1"><code>org.hibernate.validator.constraints</code>, <code>org.hibernate.validator.constraints.br</code>, <code>org.hibernate.validator.constraints.pl</code></dt>
<dd>
<p>Some useful custom constraints provided by Hibernate Validator in addition to the built-in constraints defined by the Bean Validation specification; the constraints are described in detail in <a href="#validator-defineconstraints-hv-constraints">Additional constraints</a>.</p>
</dd>
<dt class="hdlist1"><code>org.hibernate.validator.constraintvalidation</code></dt>
<dd>
<p>Extended constraint validator context which allows to set custom attributes for message interpolation. <a href="#section-hibernateconstraintvalidatorcontext"><code>HibernateConstraintValidatorContext</code></a> describes how to make use of that feature.</p>
</dd>
<dt class="hdlist1"><code>org.hibernate.validator.group</code>, <code>org.hibernate.validator.spi.group</code></dt>
<dd>
<p>The group sequence provider feature which allows you to define dynamic default group sequences in function of the validated object state; the specifics can be found in <a href="#section-default-group-class">Redefining the default group sequence</a>.</p>
</dd>
<dt class="hdlist1"><code>org.hibernate.validator.messageinterpolation</code>, <code>org.hibernate.validator.resourceloading</code>, <code>org.hibernate.validator.spi.resourceloading</code></dt>
<dd>
<p>Classes related to constraint message interpolation; the first package contains Hibernate Validator&#8217;s default message interpolator, <code>ResourceBundleMessageInterpolator</code>. The latter two packages provide the <code>ResourceBundleLocator</code> SPI for the loading of resource bundles (see <a href="#section-resource-bundle-locator"><code>ResourceBundleLocator</code></a>) and its default implementation.</p>
</dd>
<dt class="hdlist1"><code>org.hibernate.validator.parameternameprovider</code></dt>
<dd>
<p>A <code>ParameterNameProvider</code> based on the ParaNamer library, see <a href="#section-paranamer-parameternameprovider">ParaNamer based <code>ParameterNameProvider</code></a>.</p>
</dd>
<dt class="hdlist1"><code>org.hibernate.validator.propertypath</code></dt>
<dd>
<p>Extensions to the <code>javax.validation.Path</code> API, see <a href="#section-extensions-path-api">Extensions of the Path API</a>.</p>
</dd>
<dt class="hdlist1"><code>org.hibernate.validator.spi.constraintdefinition</code></dt>
<dd>
<p>An SPI for registering additional constraint validators programmatically, see <a href="#section-constraint-definition-contribution">Providing constraint definitions</a>.</p>
</dd>
<dt class="hdlist1"><code>org.hibernate.validator.spi.time</code></dt>
<dd>
<p>An SPI for customizing the retrieval of the current time when validating <code>@Future</code> and <code>@Past</code>, see <a href="#section-time-provider">Time providers for @Future and @Past</a>.</p>
</dd>
<dt class="hdlist1"><code>org.hibernate.validator.valuehandling</code>, <code>org.hibernate.validator.spi.valuehandling</code></dt>
<dd>
<p>Classes related to the processing of values prior to thei validation, see <a href="#section-value-handling">Unwrapping values</a>.</p>
</dd>
</dl>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The public packages of Hibernate Validator fall into two categories: while the actual API parts are
intended to be <em>invoked</em> or <em>used</em> by clients (e.g. the API for programmatic constraint declaration
or the custom constraints), the SPI (service provider interface) packages contain interfaces which
are intended to be <em>implemented</em> by clients (e.g. <code>ResourceBundleLocator</code>).</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Any packages not listed in that table are internal packages of Hibernate Validator and are not
intended to be accessed by clients. The contents of these internal packages can change from release
to release without notice, thus possibly breaking any client code relying on it.</p>
</div>
</div>
<div class="sect2">
<h3 id="section-fail-fast"><a class="anchor" href="#section-fail-fast"></a>11.2. Fail fast mode</h3>
<div class="paragraph">
<p>Using the fail fast mode, Hibernate Validator allows to return from the current validation as soon
as the first constraint violation occurs. This can be useful for the validation of large object
graphs where you are only interested in a quick check whether there is any constraint violation at
all.</p>
</div>
<div class="paragraph">
<p><a href="#example-using-fail-fast">Using the fail fast validation mode</a> shows how to bootstrap and use a fail fast enabled validator.</p>
</div>
<div id="example-using-fail-fast" class="exampleblock">
<div class="title">Example 107. Using the fail fast validation mode</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter11.failfast;

public class Car {

    @NotNull
    private String manufacturer;

    @AssertTrue
    private boolean isRegistered;

    public Car(String manufacturer, boolean isRegistered) {
        this.manufacturer = manufacturer;
        this.isRegistered = isRegistered;
    }

    //getters and setters...
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">Validator validator = Validation.byProvider( HibernateValidator.class )
        .configure()
        .failFast( true )
        .buildValidatorFactory()
        .getValidator();

Car car = new Car( null, false );

Set&lt;ConstraintViolation&lt;Car&gt;&gt; constraintViolations = validator.validate( car );

assertEquals( 1, constraintViolations.size() );</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Here the validated object actually fails to satisfy both the constraints declared on the <code>Car</code> class,
yet the validation call yields only one <code>ConstraintViolation</code> since the fail fast mode is enabled.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>There is no guarantee in which order the constraints are evaluated, i.e. it is not deterministic
whether the returned violation originates from the <code>@NotNull</code> or the <code>@AssertTrue</code> constraint. If
required, a deterministic evaluation order can be enforced using group sequences as described in
<a href="#section-defining-group-sequences">Defining group sequences</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Refer to <a href="#section-provider-specific-settings">Provider-specific settings</a> to learn about the different ways of enabling the
fail fast mode when bootstrapping a validator.</p>
</div>
</div>
<div class="sect2">
<h3 id="section-method-validation-prerequisite-relaxation"><a class="anchor" href="#section-method-validation-prerequisite-relaxation"></a>11.3. Relaxation of requirements for method validation in class hierarchies</h3>
<div class="paragraph">
<p>The Bean Validation specification defines a set of preconditions which apply when defining
constraints on methods within class hierarchies. These preconditions are defined in
<a href="http://beanvalidation.org/1.1/spec/#constraintdeclarationvalidationprocess-methodlevelconstraints-inheritance">section 4.5.5</a>
of the Bean Validation 1.1 specification. See also <a href="#section-method-constraints-inheritance-hierarchies">Method constraints in inheritance hierarchies</a>
in this guide.</p>
</div>
<div class="paragraph">
<p>As per specification a Bean Validation provider is allowed to relax these preconditions.
With Hibernate Validator you can do this in one of two ways.</p>
</div>
<div class="paragraph">
<p>First you can use the configuration properties <em>hibernate.validator.allow_parameter_constraint_override</em>,
<em>hibernate.validator.allow_multiple_cascaded_validation_on_result</em> and
<em>hibernate.validator.allow_parallel_method_parameter_constraint</em> in <em>validation.xml</em>. See example
<a href="#example-relaxing-method-validation-xml">Configuring method validation behaviour in class hierarchies via properties</a>.</p>
</div>
<div id="example-relaxing-method-validation-xml" class="exampleblock">
<div class="title">Example 108. Configuring method validation behaviour in class hierarchies via properties</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-XML" data-lang="XML">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;validation-config
        xmlns="http://jboss.org/xml/ns/javax/validation/configuration"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="http://jboss.org/xml/ns/javax/validation/configuration validation-configuration-1.0.xsd"&gt;
    &lt;default-provider&gt;org.hibernate.validator.HibernateValidator&lt;/default-provider&gt;

    &lt;property name="hibernate.validator.allow_parameter_constraint_override"&gt;true&lt;/property&gt;
    &lt;property name="hibernate.validator.allow_multiple_cascaded_validation_on_result"&gt;true&lt;/property&gt;
    &lt;property name="hibernate.validator.allow_parallel_method_parameter_constraint"&gt;true&lt;/property&gt;
&lt;/validation-config&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Alternatively these settings can be applied during programmatic bootstrapping.</p>
</div>
<div id="example-relaxing-method-validation" class="exampleblock">
<div class="title">Example 109. Configuring method validation behaviour in class hierarchies</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">HibernateValidatorConfiguration configuration = Validation.byProvider( HibernateValidator.class ).configure();

configuration.allowMultipleCascadedValidationOnReturnValues( true )
        .allowOverridingMethodAlterParameterConstraint( true )
        .allowParallelMethodsDefineParameterConstraints( true );</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>By default, all of these properties are false, implementing the default behavior as defined in the
Bean Validation specification.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Changing the default behaviour for method validation will result in non specification conform and non
portable application. Make sure to understand what you are doing and that your use case really
requires changes to the default behaviour.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="section-programmatic-api"><a class="anchor" href="#section-programmatic-api"></a>11.4. Programmatic constraint definition and declaration</h3>
<div class="paragraph">
<p>As per the Bean Validation specification, you can define and declare constraints using Java annotations and XML
based constraint mappings.</p>
</div>
<div class="paragraph">
<p>In addition, Hibernate Validator provides a fluent API which allows for the programmatic
configuration of constraints. Use cases include the dynamic addition of constraints at runtime
depending on some application state or tests where you need entities with different constraints in
different scenarios but don&#8217;t want to implement actual Java classes for each test case.</p>
</div>
<div class="paragraph">
<p>By default, constraints added via the fluent API are additive to constraints configured via the
standard configuration capabilities. But it is also possible to ignore annotation and XML configured
constraints where required.</p>
</div>
<div class="paragraph">
<p>The API is centered around the <code>ConstraintMapping</code> interface. You obtain a new mapping via
<code>HibernateValidatorConfiguration#createConstraintMapping()</code> which you then can configure in a fluent
manner as shown in <a href="#example-constraint-mapping">Programmatic constraint declaration</a>.</p>
</div>
<div id="example-constraint-mapping" class="exampleblock">
<div class="title">Example 110. Programmatic constraint declaration</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">HibernateValidatorConfiguration configuration = Validation
        .byProvider( HibernateValidator.class )
        .configure();

ConstraintMapping constraintMapping = configuration.createConstraintMapping();

constraintMapping
    .type( Car.class )
        .property( "manufacturer", FIELD )
            .constraint( new NotNullDef() )
        .property( "licensePlate", FIELD )
            .ignoreAnnotations()
            .constraint( new NotNullDef() )
            .constraint( new SizeDef().min( 2 ).max( 14 ) )
    .type( RentalCar.class )
        .property( "rentalStation", METHOD )
            .constraint( new NotNullDef() );

Validator validator = configuration.addMapping( constraintMapping )
        .buildValidatorFactory()
        .getValidator();</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Constraints can be configured on multiple classes and properties using method chaining. The
constraint definition classes <code>NotNullDef</code> and SizeDef are helper classes which allow to configure
constraint parameters in a type-safe fashion. Definition classes exist for all built-in constraints
in the <code>org.hibernate.validator.cfg.defs</code> package. By calling <code>ignoreAnnotations()</code> any constraints
configured via annotations or XML are ignored for the given element.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Each element (type, property, method etc.) may only be configured once within all the constraint
mappings used to set up one validator factory. Otherwise a <code>ValidationException</code> is raised.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>It is not supported to add constraints to non-overridden supertype properties and methods by
configuring a subtype. Instead you need to configure the supertype in this case.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Having configured the mapping, you must add it back to the configuration object from which you then
can obtain a validator factory.</p>
</div>
<div class="paragraph">
<p>For custom constraints you can either create your own definition classes extending <code>ConstraintDef</code> or
you can use <code>GenericConstraintDef</code> as seen in <a href="#example-generic-constraint-mapping">Programmatic declaration of a custom constraint</a>.</p>
</div>
<div id="example-generic-constraint-mapping" class="exampleblock">
<div class="title">Example 111. Programmatic declaration of a custom constraint</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">ConstraintMapping constraintMapping = configuration.createConstraintMapping();

constraintMapping
    .type( Car.class )
        .property( "licensePlate", FIELD )
            .constraint( new GenericConstraintDef&lt;CheckCase&gt;( CheckCase.class )
                .param( "value", CaseMode.UPPER )
            );</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>By invoking <code>valid()</code> you can mark a member for cascaded validation which is equivalent to annotating
it with <code>@Valid</code>. Configure any group conversions to be applied during cascaded validation using the
<code>convertGroup()</code> method (equivalent to <code>@ConvertGroup</code>). An example can be seen in
<a href="#example-cascading-constraints">Marking a property for cascaded validation</a>.</p>
</div>
<div id="example-cascading-constraints" class="exampleblock">
<div class="title">Example 112. Marking a property for cascaded validation</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">ConstraintMapping constraintMapping = configuration.createConstraintMapping();

constraintMapping
    .type( Car.class )
        .property( "driver", FIELD )
            .constraint( new NotNullDef() )
            .valid()
            .convertGroup( Default.class ).to( PersonDefault.class )
    .type( Person.class )
        .property( "name", FIELD )
            .constraint( new NotNullDef().groups( PersonDefault.class ) );</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>You can not only configure bean constraints using the fluent API but also method and constructor
constraints. As shown in <a href="#example-method-constraint-mapping">Programmatic declaration of method and constructor constraints</a> constructors are identified by their
parameter types and methods by their name and parameter types. Having selected a method or
constructor, you can mark its parameters and/or return value for cascaded validation and add
constraints as well as cross-parameter constraints.</p>
</div>
<div id="example-method-constraint-mapping" class="exampleblock">
<div class="title">Example 113. Programmatic declaration of method and constructor constraints</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">ConstraintMapping constraintMapping = configuration.createConstraintMapping();

constraintMapping
    .type( Car.class )
        .constructor( String.class )
            .parameter( 0 )
                .constraint( new SizeDef().min( 3 ).max( 50 ) )
            .returnValue()
                .valid()
        .method( "drive", int.class )
            .parameter( 0 )
                .constraint( new MaxDef().value( 75 ) )
        .method( "load", List.class, List.class )
            .crossParameter()
                .constraint( new GenericConstraintDef&lt;LuggageCountMatchesPassengerCount&gt;(
                        LuggageCountMatchesPassengerCount.class ).param(
                            "piecesOfLuggagePerPassenger", 2
                        )
                )
        .method( "getDriver" )
            .returnValue()
                .constraint( new NotNullDef() )
                .valid();</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Last but not least you can configure the default group sequence or the default group sequence
provider of a type as shown in the following example.</p>
</div>
<div id="example-sequences" class="exampleblock">
<div class="title">Example 114. Configuration of default group sequence and default group sequence provider</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">ConstraintMapping constraintMapping = configuration.createConstraintMapping();

constraintMapping
    .type( Car.class )
        .defaultGroupSequence( Car.class, CarChecks.class )
    .type( RentalCar.class )
        .defaultGroupSequenceProviderClass( RentalCarGroupSequenceProvider.class );</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="section-programmatic-api-contributor"><a class="anchor" href="#section-programmatic-api-contributor"></a>11.5. Applying programmatic constraint declarations to the default validator factory</h3>
<div class="paragraph">
<p>If you are not bootstrapping a validator factory manually
but work with the default factory as configured via <em>META-INF/validation.xml</em>
(see <a href="#chapter-xml-configuration">Configuring via XML</a>),
you can add one or more constraint mappings by creating one or several constraint mapping contributors.
To do so, implement the <code>ConstraintMappingContributor</code> contract:</p>
</div>
<div id="example-constraint-mapping-contributor" class="exampleblock">
<div class="title">Example 115. Custom <code>ConstraintMappingContributor</code> implementation</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter11.constraintapi;

public class MyConstraintMappingContributor implements ConstraintMappingContributor {

    @Override
    public void createConstraintMappings(ConstraintMappingBuilder builder) {
        builder.addConstraintMapping()
            .type( Marathon.class )
                .property( "name", METHOD )
                    .constraint( new NotNullDef() )
                .property( "numberOfHelpers", FIELD )
                    .constraint( new MinDef().value( 1 ) );

        builder.addConstraintMapping()
            .type( Runner.class )
                .property( "paidEntryFee", FIELD )
                    .constraint( new AssertTrueDef() );
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>You then need to specify the fully-qualified class name of the contributor implementation in <em>META-INF/validation.xml</em>,
using the property key <code>hibernate.validator.constraint_mapping_contributors</code>. You can specify several
contributors by separating them with a comma.</p>
</div>
</div>
<div class="sect2">
<h3 id="section-advanced-constraint-composition"><a class="anchor" href="#section-advanced-constraint-composition"></a>11.6. Advanced constraint composition features</h3>
<div class="sect3">
<h4 id="_validation_target_specification_for_purely_composed_constraints"><a class="anchor" href="#_validation_target_specification_for_purely_composed_constraints"></a>11.6.1. Validation target specification for purely composed constraints</h4>
<div class="paragraph">
<p>In case you specify a purely composed constraint - i.e. a constraint which has no validator itself but is solely made
up from other, composing constraints - on a method declaration, the validation engine cannot determine whether that
constraint is to be applied as a return value constraint or as a cross-parameter constraint.</p>
</div>
<div class="paragraph">
<p>Hibernate Validator allows to resolve such ambiguities by specifying the <code>@SupportedValidationTarget</code> annotation on the
declaration of the composed constraint type as shown in <a href="#example-purely-composed-constraint-validation-target">Specifying the validation target of a purely composed constraint</a>.
The <code>@ValidInvoiceAmount</code> does not declare any validator, but it is solely composed by the <code>@Min</code> and <code>@NotNull</code>
constraints. The <code>@SupportedValidationTarget</code> ensures that the constraint is applied to the method return value when
given on a method declaration.</p>
</div>
<div id="example-purely-composed-constraint-validation-target" class="exampleblock">
<div class="title">Example 116. Specifying the validation target of a purely composed constraint</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter11.purelycomposed;

@Min(value = 0)
@NotNull
@Target({ METHOD, FIELD, ANNOTATION_TYPE, CONSTRUCTOR, PARAMETER })
@Retention(RUNTIME)
@Documented
@Constraint(validatedBy = {})
@SupportedValidationTarget(ValidationTarget.ANNOTATED_ELEMENT)
@ReportAsSingleViolation
public @interface ValidInvoiceAmount {

    String message() default "{org.hibernate.validator.referenceguide.chapter11.purelycomposed."
            + "ValidInvoiceAmount.message}";

    Class&lt;?&gt;[] groups() default {};

    Class&lt;? extends Payload&gt;[] payload() default {};

    @OverridesAttribute(constraint = Min.class, name = "value")
    long value();
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="section-boolean-constraint-composition"><a class="anchor" href="#section-boolean-constraint-composition"></a>11.6.2. Boolean composition of constraints</h4>
<div class="paragraph">
<p>Bean Validation specifies that the constraints of a composed constraint (see
<a href="#section-constraint-composition">Constraint composition</a>) are all combined via a logical <em>AND</em>. This means all of the
composing constraints need to return true in order for an overall successful validation.</p>
</div>
<div class="paragraph">
<p>Hibernate Validator offers an extension to this and allows you to compose constraints via a logical
<em>OR</em> or <em>NOT</em>. To do so you have to use the ConstraintComposition annotation and the enum
CompositionType with its values <em>AND</em>, <em>OR</em> and <em>ALL_FALSE</em>.</p>
</div>
<div class="paragraph">
<p><a href="#example-boolean-constraint-composition">OR composition of constraints</a> shows how to build a composed constraint <code>@PatternOrSize</code>
where only one of the composing constraints needs to be valid in order to pass the validation.
Either the validated string is all lower-cased or it is between two and three characters long.</p>
</div>
<div id="example-boolean-constraint-composition" class="exampleblock">
<div class="title">Example 117. OR composition of constraints</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter11.booleancomposition;

@ConstraintComposition(OR)
@Pattern(regexp = "[a-z]")
@Size(min = 2, max = 3)
@ReportAsSingleViolation
@Target({ METHOD, FIELD })
@Retention(RUNTIME)
@Constraint(validatedBy = { })
public @interface PatternOrSize {
    String message() default "{org.hibernate.validator.referenceguide.chapter11." +
            "booleancomposition.PatternOrSize.message}";

    Class&lt;?&gt;[] groups() default { };

    Class&lt;? extends Payload&gt;[] payload() default { };
}</code></pre>
</div>
</div>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Using <em>ALL_FALSE</em> as composition type implicitly enforces that only a single violation will get
reported in case validation of the constraint composition fails.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="section-extensions-path-api"><a class="anchor" href="#section-extensions-path-api"></a>11.7. Extensions of the Path API</h3>
<div class="paragraph">
<p>Hibernate Validator provides an extension to the <code>javax.validation.Path</code> API.
For nodes of <code>ElementKind.PROPERTY</code> it allows to obtain the value of the represented property.
To do so, narrow down a given node to the type <code>org.hibernate.validator.path.PropertyNode</code> using <code>Node#as()</code>, as shown in the following example:</p>
</div>
<div id="example-property-node-get-value" class="exampleblock">
<div class="title">Example 118. Getting the value from property nodes</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">Building building = new Building();

// Assume the name of the person violates a @Size constraint
Person bob = new Person( "Bob" );
Apartment bobsApartment = new Apartment( bob );
building.getApartments().add( bobsApartment );

Set&lt;ConstraintViolation&lt;Building&gt;&gt; constraintViolations = validator.validate( building );

Path path = constraintViolations.iterator().next().getPropertyPath();
Iterator&lt;Path.Node&gt; nodeIterator = path.iterator();

Path.Node node = nodeIterator.next();
assertEquals( node.getName(), "apartments" );
assertSame( node.as( PropertyNode.class ).getValue(), bobsApartment );

node = nodeIterator.next();
assertEquals( node.getName(), "resident" );
assertSame( node.as( PropertyNode.class ).getValue(), bob );

node = nodeIterator.next();
assertEquals( node.getName(), "name" );
assertEquals( node.as( PropertyNode.class ).getValue(), "Bob" );</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>This is specifically useful to obtain the element of <code>Set</code> properties on the property path (e.g. <code>apartments</code> in the example) which otherwise could not be identified (unlike for <code>Map</code> and <code>List</code>, there is no key nor index in this case).</p>
</div>
</div>
<div class="sect2">
<h3 id="section-dynamic-payload"><a class="anchor" href="#section-dynamic-payload"></a>11.8. Dynamic payload as part of ConstraintViolation</h3>
<div class="paragraph">
<p>In some cases automatic processing of violations can be aided, if the constraint violation provides additional
data - a so called dynamic payload. This dynamic payload could for example contain hints to the user on how to
resolve the violation.</p>
</div>
<div class="paragraph">
<p>Dynamic payloads can be set in <a href="#validator-customconstraints">custom constraints</a> using <code>HibernateConstraintValidatorContext</code>.
This is shown in example <a href="#example-constraint-validator-setting-dynamic-payload">ConstraintValidator implementation setting a dynamic payload</a> where the
<code>javax.validation.ConstraintValidatorContext</code> is unwrapped to <code>HibernateConstraintValidatorContext</code> in order to call
<code>withDynamicPayload</code>.</p>
</div>
<div id="example-constraint-validator-setting-dynamic-payload" class="exampleblock">
<div class="title">Example 119. ConstraintValidator implementation setting a dynamic payload</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter11.dynamicpayload;

import static org.hibernate.validator.internal.util.CollectionHelper.newHashMap;

public class ValidPassengerCountValidator implements ConstraintValidator&lt;ValidPassengerCount, Car&gt; {

    private static final Map&lt;Integer, String&gt; suggestedCars = newHashMap();

    static {
        suggestedCars.put( 2, "Chevrolet Corvette" );
        suggestedCars.put( 3, "Toyota Volta" );
        suggestedCars.put( 4, "Maserati GranCabrio" );
        suggestedCars.put( 5, " Mercedes-Benz E-Class" );
    }

    @Override
    public void initialize(ValidPassengerCount constraintAnnotation) {
    }

    @Override
    public boolean isValid(Car car, ConstraintValidatorContext context) {
        if ( car == null ) {
            return true;
        }

        int passengerCount = car.getPassengers().size();
        if ( car.getSeatCount() &gt;= passengerCount ) {
            return true;
        }
        else {

            if ( suggestedCars.containsKey( passengerCount ) ) {
                HibernateConstraintValidatorContext hibernateContext = context.unwrap(
                        HibernateConstraintValidatorContext.class
                );
                hibernateContext.withDynamicPayload( suggestedCars.get( passengerCount ) );
            }
            return false;
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>On the constraint violation processing side, a <code>javax.validation.ConstraintViolation</code> can then in turn be
unwrapped to <code>HibernateConstraintViolation</code> in order to retrieve the dynamic payload for further processing.</p>
</div>
<div id="example-retrieving-dynamic-payload" class="exampleblock">
<div class="title">Example 120. Retrieval of a ConstraintViolations&#8217;s dynamic payload</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">Car car = new Car( 2 );
car.addPassenger( new Person() );
car.addPassenger( new Person() );
car.addPassenger( new Person() );
Set&lt;ConstraintViolation&lt;Car&gt;&gt; constraintViolations = validator.validate( car );

assertEquals( 1, constraintViolations.size() );

ConstraintViolation&lt;Car&gt; constraintViolation = constraintViolations.iterator().next();
@SuppressWarnings("unchecked")
HibernateConstraintViolation&lt;Car&gt; hibernateConstraintViolation = constraintViolation.unwrap(
        HibernateConstraintViolation.class
);
String suggestedCar = hibernateConstraintViolation.getDynamicPayload( String.class );
assertEquals( "Toyota Volta", suggestedCar );</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="non-el-message-interpolator"><a class="anchor" href="#non-el-message-interpolator"></a>11.9. <code>ParameterMessageInterpolator</code></h3>
<div class="paragraph">
<p>Hibernate Validator requires per default an implementation of the Unified EL (see
<a href="#validator-gettingstarted-uel">Unified EL</a>) to be available. This is needed to allow the interpolation
of constraint error messages using EL expressions as defined by Bean Validation 1.1.</p>
</div>
<div class="paragraph">
<p>For environments where you cannot or do not want to provide an EL implementation, Hibernate Validators
offers a non EL based message interpolator - <code>org.hibernate.validator.messageinterpolation.ParameterMessageInterpolator</code>.</p>
</div>
<div class="paragraph">
<p>Refer to <a href="#section-custom-message-interpolation">Custom message interpolation</a> to see how to plug in custom message interpolator
implementations.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Constraint messages containing EL expressions will be returned un-interpolated by
<code>org.hibernate.validator.messageinterpolation.ParameterMessageInterpolator</code>. This also affects
built-in default constraint messages which use EL expressions. At the moment <code>DecimalMin</code> and <code>DecimalMax</code> are affected.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="__code_resourcebundlelocator_code"><a class="anchor" href="#__code_resourcebundlelocator_code"></a>11.10. <code>ResourceBundleLocator</code></h3>
<div class="paragraph">
<p>With <code>ResourceBundleLocator</code>, Hibernate Validator provides an additional SPI which allows to retrieve
error messages from other resource bundles than <em>ValidationMessages</em> while still using the actual
interpolation algorithm as defined by the specification. Refer to
<a href="#section-resource-bundle-locator"><code>ResourceBundleLocator</code></a> to learn how to make use of that SPI.</p>
</div>
</div>
<div class="sect2">
<h3 id="_custom_contexts"><a class="anchor" href="#_custom_contexts"></a>11.11. Custom contexts</h3>
<div class="paragraph">
<p>The Bean Validation specification offers at several points in its API the possibility to unwrap a
given interface to a implementor specific subtype. In the case of constraint violation creation in
<code>ConstraintValidator</code> implementations as well as message interpolation in <code>MessageInterpolator</code>
instances, there exist <code>unwrap()</code> methods for the provided context instances -
<code>ConstraintValidatorContext</code> respectively <code>MessageInterpolatorContext</code>. Hibernate Validator provides
custom extensions for both of these interfaces.</p>
</div>
<div class="sect3">
<h4 id="section-hibernateconstraintvalidatorcontext"><a class="anchor" href="#section-hibernateconstraintvalidatorcontext"></a>11.11.1. <code>HibernateConstraintValidatorContext</code></h4>
<div id="section-custom-constraint-validator-context" class="paragraph">
<p><code>HibernateConstraintValidatorContext</code> is a subtype of <code>ConstraintValidatorContext</code> which allows you to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>set arbitrary parameters for interpolation via the Expression Language message interpolation
facility using <code>HibernateConstraintValidatorContext#addExpressionVariable(String, Object)</code>.
For an example refer to <a href="#example-custom-message-parameter">Custom @Future validator with message parameters</a>.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Note that the parameters specified via <code>addExpressionVariable(String, Object)</code> are global and apply
for all constraint violations created by this <code>isValid()</code> invocation. This includes the default
constraint violation, but also all violations created by the <code>ConstraintViolationBuilder</code>. You can,
however, update the parameters between invocations of
<code>ConstraintViolationBuilder#addConstraintViolation()</code>.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>obtain the <code>TimeProvider</code> for getting the current time when validating <code>@Future</code> and <code>@Past</code> constraints
(see also <a href="#section-time-provider">Time providers for @Future and @Past</a>).</p>
<div class="paragraph">
<p>This is useful if you want to customize the message of the <code>@Future</code> constraint.
By default the message is just "must be in the future". <a href="#example-custom-message-parameter">Custom @Future validator with message parameters</a> shows
how to include the current date in order to make the message more explicit.</p>
</div>
<div id="example-custom-message-parameter" class="exampleblock">
<div class="title">Example 121. Custom @Future validator with message parameters</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter11.context;

public class MyFutureValidator implements ConstraintValidator&lt;Future, Date&gt; {

    @Override
    public void initialize(Future constraintAnnotation) {
    }

    @Override
    public boolean isValid(Date value, ConstraintValidatorContext context) {
        if ( value == null ) {
            return true;
        }

        HibernateConstraintValidatorContext hibernateContext = context.unwrap(
                HibernateConstraintValidatorContext.class
        );

        Date now = new Date( hibernateContext.getTimeProvider().getCurrentTime() );

        if ( !value.after( now ) ) {
            hibernateContext.disableDefaultConstraintViolation();
            hibernateContext.addExpressionVariable( "now", now )
                    .buildConstraintViolationWithTemplate( "Must be after ${now}" )
                    .addConstraintViolation();

            return false;
        }

        return true;
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>This functionality is currently experimental and might change in future versions.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>set an arbitrary dynamic payload - see <a href="#section-dynamic-payload">Dynamic payload as part of ConstraintViolation</a></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="__code_hibernatemessageinterpolatorcontext_code"><a class="anchor" href="#__code_hibernatemessageinterpolatorcontext_code"></a>11.11.2. <code>HibernateMessageInterpolatorContext</code></h4>
<div class="paragraph">
<p>Hibernate Validator also offers a custom extension of <code>MessageInterpolatorContext</code>, namely
<code>HibernateMessageInterpolatorContext</code> (see <a href="#example-custom-message-interpolator-context"><code>HibernateMessageInterpolatorContext</code></a>). This
subtype was introduced to allow a better integration of Hibernate Validator into the Glassfish. The
root bean type was in this case needed to determine the right classloader for the message resource
bundle. If you have any other usecases, let us know.</p>
</div>
<div id="example-custom-message-interpolator-context" class="exampleblock">
<div class="title">Example 122. <code>HibernateMessageInterpolatorContext</code></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA"> * @author Guillaume Smet
 * @since 5.0
 */
public interface HibernateMessageInterpolatorContext extends MessageInterpolator.Context {

    /**
     * Returns the currently validated root bean type.
     *
     * @return The currently validated root bean type.</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="section-paranamer-parameternameprovider"><a class="anchor" href="#section-paranamer-parameternameprovider"></a>11.12. ParaNamer based <code>ParameterNameProvider</code></h3>
<div class="paragraph">
<p>Hibernate Validator comes with a <code>ParameterNameProvider</code> implementation which leverages the
<a href="http://paranamer.codehaus.org/">ParaNamer</a> library.</p>
</div>
<div class="paragraph">
<p>This library provides several ways for obtaining parameter names at runtime, e.g. based on debug
symbols created by the Java compiler, constants with the parameter names woven into the bytecode in
a post-compile step or annotations such as the <code>@Named</code> annotation from JSR 330.</p>
</div>
<div class="paragraph">
<p>In order to use <code>ParanamerParameterNameProvider</code>, either pass an instance when bootstrapping a
validator as shown in <a href="#example-using-custom-parameter-name-provider">Using a custom <code>ParameterNameProvider</code></a> or specify
<code>org.hibernate.validator.parameternameprovider.ParanamerParameterNameProvider</code> as value for the
<code>&lt;parameter-name-provider&gt;</code> element in the <em>META-INF/validation.xml</em> file.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When using this parameter name provider, you need to add the ParaNamer library to your classpath. It
is available in the Maven Central repository with the group id <code>com.thoughtworks.paranamer</code> and the
artifact id <code>paranamer</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>By default <code>ParanamerParameterNameProvider</code> retrieves parameter names from constants added to the byte
code at build time (via <code>DefaultParanamer</code>) and debug symbols (via <code>BytecodeReadingParanamer</code>).
Alternatively you can specify a <code>Paranamer</code> implementation of your choice when creating a
<code>ParanamerParameterNameProvider</code> instance.</p>
</div>
</div>
<div class="sect2">
<h3 id="section-value-handling"><a class="anchor" href="#section-value-handling"></a>11.13. Unwrapping values</h3>
<div class="paragraph">
<p>Sometimes it is required to unwrap values prior to validating them. For example, in
<a href="#example-using-unwrapvalidatedvalue">Applying a constraint to wrapped value of a JavaFX property</a> a <a href="http://docs.oracle.com/javafx/">JavaFX</a> property type
is used to define an element of a domain model. The <code>@Size</code> constraint is meant to be applied to the
string value not the wrapping <code>Property</code> instance.</p>
</div>
<div id="example-using-unwrapvalidatedvalue" class="exampleblock">
<div class="title">Example 123. Applying a constraint to wrapped value of a JavaFX property</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">@Size(min = 3)
private Property&lt;String&gt; name = new SimpleStringProperty( "Bob" );</code></pre>
</div>
</div>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The concept of value unwrapping is considered experimental at this time and may evolve into more
general means of value handling in future releases. Please let us know about your use cases for such
functionality.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Bean properties in JavaFX are typically not of simple data types like <code>String</code> or <code>int</code>, but are
wrapped in <code>Property</code> types which allows to make them observable, use them for data binding etc. When
applying a constraint such as <code>@Size</code> to an element of type <code>Property&lt;String&gt;</code> without further
preparation, an exception would be raised, indicating that no suitable validator for that constraint
and data type can be found. Thus the validated value must be unwrapped from the containing property
object before looking up a validator and invoking it.</p>
</div>
<div class="paragraph">
<p>For unwrapping to occur a <code>ValidatedValueUnwrapper</code> needs to be registered for the type
requiring unwrapping. Example <a href="#example-implementation-of-validatedvalueunwrapper">Implementing the ValidatedValueUnwrapper interface</a> shows how this
schematically looks for a JavaFX <code>PropertyValueUnwrapper</code>. You just need to extend the SPI class
<code>ValidatedValueUnwrapper</code> and implement its abstract methods.</p>
</div>
<div id="example-implementation-of-validatedvalueunwrapper" class="exampleblock">
<div class="title">Example 124. Implementing the ValidatedValueUnwrapper interface</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter11.valuehandling;

public class PropertyValueUnwrapper extends ValidatedValueUnwrapper&lt;Property&lt;?&gt;&gt; {

    @Override
    public Object handleValidatedValue(Property&lt;?&gt; value) {
        //...
        return null;
    }

    @Override
    public Type getValidatedValueType(Type valueType) {
        //...
        return null;
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The <code>ValidatedValueUnwrapper</code> needs also to be registered with the <code>ValidatorFactory</code>:</p>
</div>
<div id="example-registering-validatedvalueunwrapper" class="exampleblock">
<div class="title">Example 125. Registering a ValidatedValueUnwrapper</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">Validator validator = Validation.byProvider( HibernateValidator.class )
        .configure()
        .addValidatedValueHandler( new PropertyValueUnwrapper() )
        .buildValidatorFactory()
        .getValidator();</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Several unwrapper implementations can be registered. During constraint validator resolution
Hibernate Validator automatically checks whether a <code>ValidatedValueUnwrapper</code> exists for the validated
value. If so, unwrapping occurs automatically. In some cases, however, constraint validator instances
for a given constraint might exist for the wrapper as well as the wrapped value (<code>@NotNull</code> for example
applies to all objects). In this case Hibernate Validator needs to be explicitly told which value
to validate. This can be done via <code>@UnwrapValidatedValue(true)</code> respectively
<code>@UnwrapValidatedValue(false)</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Note that it is not specified which of the unwrapper implementations is
chosen when more than one implementation is suitable to unwrap a given element.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Instead of programmatically registering <code>ValidatedValueUnwrapper</code> types, the fully-qualified names
of one ore more unwrapper implementations can be specified
via the configuration property <code>hibernate.validator.validated_value_handlers</code> which can be useful when
configuring the default validator factory using the descriptor <em>META-INF/validation.xml</em> (see
<a href="#chapter-xml-configuration">Configuring via XML</a>).</p>
</div>
<div class="sect3">
<h4 id="section-optional-unwrapper"><a class="anchor" href="#section-optional-unwrapper"></a>11.13.1. Optional unwrapper</h4>
<div class="paragraph">
<p>Hibernate Validator provides built-in unwrapping for <code>Optional</code> introduced in Java 8.
The unwrapper is registered automatically in Java 8 environments, and no further configuration is
required. An example of unwrapping an <code>Optional</code> instance is shown in
<a href="#example-using-unwrapvalidatedvalue-and-optional">Unwrapping <code>Optional</code> instances</a>.</p>
</div>
<div id="example-using-unwrapvalidatedvalue-and-optional" class="exampleblock">
<div class="title">Example 126. Unwrapping <code>Optional</code> instances</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">@Size(min = 3)
private Optional&lt;String&gt; firstName = Optional.of( "John" );

@NotNull
@UnwrapValidatedValue // UnwrapValidatedValue required since otherwise unclear which value to validate
private Optional&lt;String&gt; lastName = Optional.of( "Doe" );</code></pre>
</div>
</div>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p><code>Optional.empty()</code> is treated as <code>null</code> during validation. This means that for constraints where
<code>null</code> is considered valid, <code>Optional.empty()</code> is similarly valid.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="section-javafx-unwrapper"><a class="anchor" href="#section-javafx-unwrapper"></a>11.13.2. JavaFX unwrapper</h4>
<div class="paragraph">
<p>Hibernate Validator also provides built-in unwrapping for JavaFX property values. The unwrapper is
registered automatically for environments where JavaFX is present, and no further configuration is
required. <code>ObservableValue</code> and its sub-types are supported.
An example of some of the different ways in which <code>JavaFX</code> property values can be unwrapped is
shown in <a href="#example-using-unwrapvalidatedvalue-and-javafx">Unwrapping <code>JavaFX</code> properties</a>.</p>
</div>
<div id="example-using-unwrapvalidatedvalue-and-javafx" class="exampleblock">
<div class="title">Example 127. Unwrapping <code>JavaFX</code> properties</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">@Min(value = 3)
IntegerProperty integerProperty1 = new SimpleIntegerProperty( 4 );

@Min(value = 3)
Property&lt;Number&gt; integerProperty2 = new SimpleIntegerProperty( 4 );

@Min(value = 3)
ObservableValue&lt;Number&gt; integerProperty3 = new SimpleIntegerProperty( 4 );</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_unwrapping_object_graphs"><a class="anchor" href="#_unwrapping_object_graphs"></a>11.13.3. Unwrapping object graphs</h4>
<div class="paragraph">
<p>Unwrapping can also be used with object graphs (cascaded validation) as shown in
<a href="#example-using-unwrapvalidatedvalue-and-optional-with-valid">Unwrapping <code>Optional</code> prior to cascaded validation via <code>@Valid</code></a>.
When validating the object holding the <code>Optional&lt;Person&gt;</code>, a cascaded validation of the <code>Person</code>
object would be performed.</p>
</div>
<div id="example-using-unwrapvalidatedvalue-and-optional-with-valid" class="exampleblock">
<div class="title">Example 128. Unwrapping <code>Optional</code> prior to cascaded validation via <code>@Valid</code></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">@Valid
private Optional&lt;Person&gt; person = Optional.of( new Person() );</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">public class Person {

    @Size(min = 3)
    private String name = "Bob";

}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="section-constraint-definition-contribution"><a class="anchor" href="#section-constraint-definition-contribution"></a>11.14. Providing constraint definitions</h3>
<div class="paragraph">
<p>Bean Validation allows to (re-)define constraint definitions via XML in its constraint mapping
files. See <a href="#section-mapping-xml-constraints">Mapping constraints via <code>constraint-mappings</code></a> for more information and <a href="#example-constraints-car">Bean constraints configured via XML</a>
for an example. While this approach is sufficient for many use cases,  it has it shortcomings
in others. Imagine for example a constraint library wanting to contribute constraint
definitions for custom types. This library could provide a mapping file with their library, but this
file still would need to be referenced by the user of the library. Luckily there are better ways.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The following concepts are considered experimental at this time. Let us know whether you find them
useful and whether they meet your needs.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_constraint_definitions_via_code_serviceloader_code"><a class="anchor" href="#_constraint_definitions_via_code_serviceloader_code"></a>11.14.1. Constraint definitions via <code>ServiceLoader</code></h4>
<div class="paragraph">
<p>Hibernate Validator allows to utilize Java&#8217;s
<a href="http://docs.oracle.com/javase/8/docs/api/java/util/ServiceLoader.html/">ServiceLoader</a>
mechanism to register additional constraint definitions. All you have to do is to add the file
<em>javax.validation.ConstraintValidator</em> to <em>META-INF/services</em>. In this service file you list the
fully qualified classnames of your constraint validator classes (one per line). Hibernate Validator
will automatically infer the constraint types they apply to.
See <a href="#example-using-service-file-for-constraint-definitions">Constraint definition via service file</a>
for an example.</p>
</div>
<div id="example-using-service-file-for-constraint-definitions" class="exampleblock">
<div class="title">Example 129. <em>META-INF/services/javax.validation.ConstraintValidator</em></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code># Assuming a custom constraint annotation @org.mycompany.CheckCase
org.mycompany.CheckCaseValidator</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>To contribute default messages for your custom constraints, place a file <em>ContributorValidationMessages.properties</em>
and/or its locale-specific specializations at the root your JAR. Hibernate Validator will consider the
entries from all the bundles with this name found on the classpath in addition to those given in <em>ValidationMessages.properties</em>.</p>
</div>
<div class="paragraph">
<p>This mechanism is also helpful when creating large multi-module applications: Instead of putting all the constraint
messages into one single bundle, you can have one resource bundle per module containing only those messages of that module.</p>
</div>
</div>
<div class="sect3">
<h4 id="section-programmatic-constraint-definition"><a class="anchor" href="#section-programmatic-constraint-definition"></a>11.14.2. Adding constraint definitions programmatically</h4>
<div class="paragraph">
<p>While the service loader approach works in many scenarios, but not in all (think for example
OSGi where service files are not visible), there is yet another way of contributing constraint
definitions. You can use the programmatic constraint declaration API - see
<a href="#example-using-constraint-definition-api">Adding constraint definitions through the programmatic API</a>.</p>
</div>
<div id="example-using-constraint-definition-api" class="exampleblock">
<div class="title">Example 130. Adding constraint definitions through the programmatic API</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">ConstraintMapping constraintMapping = configuration.createConstraintMapping();

constraintMapping
        .constraintDefinition( ValidPassengerCount.class )
        .validatedBy( ValidPassengerCountValidator.class );</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Instead of directly adding a constraint mapping to the configuration object, you may use a <code>ConstraintMappingContributor</code>
as detailed in <a href="#section-programmatic-api-contributor">Applying programmatic constraint declarations to the default validator factory</a>. This can be useful when
configuring the default validator factory using <em>META-INF/validation.xml</em> (see
<a href="#chapter-xml-configuration">Configuring via XML</a>).</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>One use case for registering constraint definitions through the programmatic API is the ability to specify an alternative
constraint validator for the <code>@URL</code> constraint. Historically, Hibernate Validator&#8217;s default constraint
validator for this constraint uses the <code>java.net.URL</code> constructor to validate an URL.
However, there is also a purely regular expression based version available which can be configured using
a <code>ConstraintDefinitionContributor</code>:</p>
</div>
<div class="listingblock">
<div class="title">Using the programmatic constraint declaration API to register a regular expression based constraint definition for <code>@URL</code></div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">ConstraintMapping constraintMapping = configuration.createConstraintMapping();

constraintMapping
        .constraintDefinition( URL.class )
        .includeExistingValidators( false )
        .validatedBy( RegexpURLValidator.class );</code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="section-constraint-customizing-class-loading"><a class="anchor" href="#section-constraint-customizing-class-loading"></a>11.15. Customizing class-loading</h3>
<div class="paragraph">
<p>There are several cases in which Hibernate Validator needs to load resources or classes given by name:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>XML descriptors (<em>META-INF/validation.xml</em> as well as XML constraint mappings)</p>
</li>
<li>
<p>classes specified by name in XML descriptors (e.g. custom message interpolators etc.)</p>
</li>
<li>
<p>the <em>ValidationMessages</em> resource bundle</p>
</li>
<li>
<p>the <code>ExpressionFactory</code> implementation used for expression based message interpolation</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>By default Hibernate Validator tries to load these resources via the current thread context classloader.
If that&#8217;s not successful, Hibernate Validator&#8217;s own classloader will be tried as a fallback.</p>
</div>
<div class="paragraph">
<p>For cases where this strategy is not appropriate (e.g. modularized environments such as OSGi),
you may provide a specific classloader for loading these resources when bootstrapping the validator factory:</p>
</div>
<div id="example-using-external-class-loader" class="exampleblock">
<div class="title">Example 131. Providing a classloader for loading external resources and classes</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">Validator validator = Validation.byProvider( HibernateValidator.class )
        .configure()
        .externalClassLoader( classLoader )
        .buildValidatorFactory()
        .getValidator();</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>In the case of OSGi, you could e.g. pass the loader of a class from the bundle bootstrapping Hibernate Validator
or a custom classloader implementation which delegates to <code>Bundle#loadClass()</code> etc.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Call <code>ValidatorFactory#close()</code> if a given validator factory instance is not needed any longer.
Failure to do so may result in a classloader leak in cases where applications/bundles are re-deployed and a non-closed
validator factory still is referenced by application code.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="section-time-provider"><a class="anchor" href="#section-time-provider"></a>11.16. Time providers for @Future and @Past</h3>
<div class="paragraph">
<p>By default the current system time is used when validating the <code>@Future</code> and <code>@Past</code> constraints.
In some cases it can be necessary though to work with another "logical" date rather than the system time,
e.g. for testing purposes or in the context of batch applications which may require to run with
yesterday&#8217;s date when re-running a failed job execution.</p>
</div>
<div class="paragraph">
<p>To address such scenarios, Hibernate Validator provides a custom contract for obtaining the current time, <code>TimeProvider</code>.
<a href="#example-using-time-provider">Using a custom <code>TimeProvider</code></a> shows an implementation of this contract and its registration when bootstrapping a validator factory.</p>
</div>
<div id="example-using-time-provider" class="exampleblock">
<div class="title">Example 132. Using a custom <code>TimeProvider</code></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter11.timeprovider;

public class CustomTimeProvider implements TimeProvider {

    @Override
    public long getCurrentTime() {
        Calendar now = GregorianCalendar.getInstance();
        return now.getTimeInMillis();
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JAVA" data-lang="JAVA">ValidatorFactory validatorFactory = Validation.byProvider( HibernateValidator.class )
        .configure()
        .timeProvider( timeProvider )
        .buildValidatorFactory();</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Alternatively, you can specify the fully-qualified classname of a <code>TimeProvider</code> implementation using the property
<code>hibernate.validator.time_provider</code> when configuring the default validator factory via <em>META-INF/validation.xml</em>
(see <a href="#chapter-xml-configuration">Configuring via XML</a>).</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="validator-annotation-processor"><a class="anchor" href="#validator-annotation-processor"></a>12. Annotation Processor</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Have you ever caught yourself by unintentionally doing things like</p>
</div>
<div class="ulist">
<ul>
<li>
<p>specifying constraint annotations at unsupported data types (e.g. by annotating a String with <code>@Past</code>)</p>
</li>
<li>
<p>annotating the setter of a JavaBeans property (instead of the getter method)</p>
</li>
<li>
<p>annotating static fields/methods with constraint annotations (which is not supported)?</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Then the Hibernate Validator Annotation Processor is the right thing for you. It helps preventing
such mistakes by plugging into the build process and raising compilation errors whenever constraint
annotations are incorrectly used.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>You can find the Hibernate Validator Annotation Processor as part of the distribution bundle on
<a href="http://sourceforge.net/projects/hibernate/files/hibernate-validator">Sourceforge</a> or in the
usual Maven repositories such as Maven Central under the GAV
<code>org.hibernate:hibernate-validator-annotation-processor:5.4.3.Final</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="validator-annotationprocessor-prerequisites"><a class="anchor" href="#validator-annotationprocessor-prerequisites"></a>12.1. Prerequisites</h3>
<div class="paragraph">
<p>The Hibernate Validator Annotation Processor is based on the "Pluggable Annotation Processing API"
as defined by <a href="http://jcp.org/en/jsr/detail?id=269">JSR 269</a> which is part of the Java
Platform since Java 6.</p>
</div>
</div>
<div class="sect2">
<h3 id="validator-annotationprocessor-features"><a class="anchor" href="#validator-annotationprocessor-features"></a>12.2. Features</h3>
<div class="paragraph">
<p>As of Hibernate Validator 5.4.3.Final the Hibernate Validator Annotation Processor checks that:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>constraint annotations are allowed for the type of the annotated element</p>
</li>
<li>
<p>only non-static fields or methods are annotated with constraint annotations</p>
</li>
<li>
<p>only non-primitive fields or methods are annotated with <code>@Valid</code></p>
</li>
<li>
<p>only such methods are annotated with constraint annotations which are valid JavaBeans
getter methods (optionally, see below)</p>
</li>
<li>
<p>only such annotation types are annotated with constraint annotations which are constraint
annotations themselves</p>
</li>
<li>
<p>definition of dynamic default group sequence with <code>@GroupSequenceProvider</code> is valid</p>
</li>
<li>
<p>annotation parameter values are meaningful and valid</p>
</li>
<li>
<p>method parameter constraints in inheritance hierarchies respect the inheritance rules</p>
</li>
<li>
<p>method return value constraints in inheritance hierarchies respect the inheritance rules</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="validator-annotationprocessor-options"><a class="anchor" href="#validator-annotationprocessor-options"></a>12.3. Options</h3>
<div class="paragraph">
<p>The behavior of the Hibernate Validator Annotation Processor can be controlled using the following
<a href="http://java.sun.com/javase/6/docs/technotes/tools/windows/javac.html#options">processor options</a>:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>diagnosticKind</code></dt>
<dd>
<p>Controls how constraint problems are reported. Must be the
string representation of one of the values from the enum <code>javax.tools.Diagnostic.Kind</code>,
e.g. <code>WARNING</code>. A value of <code>ERROR</code> will cause compilation to halt whenever the AP detects
a constraint problem. Defaults to <code>ERROR</code>.</p>
</dd>
<dt class="hdlist1"><code>methodConstraintsSupported</code></dt>
<dd>
<p>Controls whether constraints are allowed at methods of any
kind. Must be set to <code>true</code> when working with method level constraints as supported by
Hibernate Validator. Can be set to <code>false</code> to allow constraints only at
JavaBeans getter methods as defined by the Bean Validation API. Defaults to <code>true</code>.</p>
</dd>
<dt class="hdlist1"><code>verbose</code></dt>
<dd>
<p>Controls whether detailed processing information shall be
displayed or not, useful for debugging purposes. Must be either
<code>true</code> or <code>false</code>. Defaults to <code>false</code>.</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="validator-annotationprocessor-usage"><a class="anchor" href="#validator-annotationprocessor-usage"></a>12.4. Using the Annotation Processor</h3>
<div class="paragraph">
<p>This section shows in detail how to integrate the Hibernate Validator Annotation Processor into
command line builds (javac, Ant, Maven) as well as IDE-based builds (Eclipse, IntelliJ IDEA,
NetBeans).</p>
</div>
<div class="sect3">
<h4 id="validator-annotationprocessor-commandline"><a class="anchor" href="#validator-annotationprocessor-commandline"></a>12.4.1. Command line builds</h4>
<div class="sect4">
<h5 id="validator-annotationprocessor-javac"><a class="anchor" href="#validator-annotationprocessor-javac"></a>javac</h5>
<div class="paragraph">
<p>When compiling on the command line using
<a href="http://docs.oracle.com/javase/6/docs/technotes/guides/javac/index.html">javac</a>, specify the JAR
<em>hibernate-validator-annotation-processor-5.4.3.Final.jar</em> using the "processorpath" option as shown in
the following listing. The processor will be detected automatically by the compiler and invoked
during compilation.</p>
</div>
<div class="exampleblock">
<div class="title">Example 133. Using the annotation processor with javac</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre>javac src/main/java/org/hibernate/validator/ap/demo/Car.java \
   -cp /path/to/validation-api-1.1.0.Final.jar \
   -processorpath /path/to/hibernate-validator-annotation-processor-5.4.3.Final.jar</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="validator-annotationprocessor-ant"><a class="anchor" href="#validator-annotationprocessor-ant"></a>Apache Ant</h5>
<div class="paragraph">
<p>Similar to directly working with javac, the annotation processor can be added as as compiler
argument when invoking the <a href="http://ant.apache.org/manual/CoreTasks/javac.html">javac task</a>
for <a href="http://ant.apache.org/">Apache Ant</a>:</p>
</div>
<div class="exampleblock">
<div class="title">Example 134. Using the annotation processor with Ant</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-XML" data-lang="XML">&lt;javac srcdir="src/main"
       destdir="build/classes"
       classpath="/path/to/validation-api-1.1.0.Final.jar"&gt;
       &lt;compilerarg value="-processorpath" /&gt;
       &lt;compilerarg value="/path/to/hibernate-validator-annotation-processor-5.4.3.Final.jar"/&gt;
&lt;/javac&gt;</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_maven"><a class="anchor" href="#_maven"></a>Maven</h5>
<div class="paragraph">
<p>For using the Hibernate Validator annotation processor with Maven, set it up via the <code>annotationProcessorPaths</code> option like this:</p>
</div>
<div class="exampleblock">
<div class="title">Example 135. Using the HV Annotation Processor with Maven</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-XML" data-lang="XML">&lt;project&gt;
    [...]
    &lt;build&gt;
        [...]
        &lt;plugins&gt;
            [...]
            &lt;plugin&gt;
                &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
                &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;
                &lt;version&gt;3.6.1&lt;/version&gt;
                &lt;configuration&gt;
                    &lt;source&gt;1.8&lt;/source&gt;
                    &lt;target&gt;1.8&lt;/target&gt;
                    &lt;annotationProcessorPaths&gt;
                        &lt;path&gt;
                            &lt;groupId&gt;org.hibernate&lt;/groupId&gt;
                            &lt;artifactId&gt;hibernate-validator-annotation-processor&lt;/artifactId&gt;
                            &lt;version&gt;5.4.3.Final&lt;/version&gt;
                        &lt;/path&gt;
                    &lt;/annotationProcessorPaths&gt;
                &lt;/configuration&gt;
            &lt;/plugin&gt;
            [...]
        &lt;/plugins&gt;
        [...]
    &lt;/build&gt;
    [...]
&lt;/project&gt;</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="validator-annotationprocessor-ide"><a class="anchor" href="#validator-annotationprocessor-ide"></a>12.4.2. IDE builds</h4>
<div class="sect4">
<h5 id="_eclipse"><a class="anchor" href="#_eclipse"></a>Eclipse</h5>
<div class="paragraph">
<p>The annotation processor will automatically be set up for Maven projects configured as described above,
provided you have the <a href="https://www.eclipse.org/m2e/">M2E Eclipse plug-in</a> installed.</p>
</div>
<div class="paragraph">
<p>For plain Eclipse projects follow these steps to set up the annotation processor:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Right-click your project, choose "Properties"</p>
</li>
<li>
<p>Go to "Java Compiler" and make sure, that "Compiler compliance level" is set to "1.6".
Otherwise the processor won&#8217;t be activated</p>
</li>
<li>
<p>Go to "Java Compiler - Annotation Processing" and choose "Enable annotation processing"</p>
</li>
<li>
<p>Go to "Java Compiler - Annotation Processing - Factory Path" and add the JAR
hibernate-validator-annotation-processor-5.4.3.Final.jar</p>
</li>
<li>
<p>Confirm the workspace rebuild</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You now should see any annotation problems as regular error markers within the editor and in the
"Problem" view:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/annotation_processor_eclipse.png" alt="annotation processor eclipse">
</div>
</div>
</div>
<div class="sect4">
<h5 id="validator-annotationprocessor-idea"><a class="anchor" href="#validator-annotationprocessor-idea"></a>IntelliJ IDEA</h5>
<div class="paragraph">
<p>The following steps must be followed to use the annotation processor within
<a href="http://www.jetbrains.com/idea/">IntelliJ IDEA</a> (version 9 and above):</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Go to "File", then "Settings",</p>
</li>
<li>
<p>Expand the node "Compiler", then "Annotation Processors"</p>
</li>
<li>
<p>Choose "Enable annotation processing" and enter the following as "Processor path":
/path/to/hibernate-validator-annotation-processor-5.4.3.Final.jar</p>
</li>
<li>
<p>Add the processor&#8217;s fully qualified name org.hibernate.validator.ap.ConstraintValidationProcessor
to the "Annotation Processors" list</p>
</li>
<li>
<p>If applicable add you module to the "Processed Modules" list</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Rebuilding your project then should show any erroneous constraint annotations:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/annotation_processor_intellij.png" alt="annotation processor intellij">
</div>
</div>
</div>
<div class="sect4">
<h5 id="validator-annotationprocessor-netbeans"><a class="anchor" href="#validator-annotationprocessor-netbeans"></a>NetBeans</h5>
<div class="paragraph">
<p>Starting with version 6.9, also the <a href="http://www.netbeans.org/">NetBeans</a> IDE supports using
annotation processors within the IDE build. To do so, do the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Right-click your project, choose "Properties"</p>
</li>
<li>
<p>Go to "Libraries", tab "Processor", and add the JAR hibernate-validator-annotation-processor-5.4.3.Final.jar</p>
</li>
<li>
<p>Go to "Build - Compiling", select "Enable Annotation Processing" and "Enable Annotation Processing
in Editor". Add the annotation processor by specifying its fully qualified name
org.hibernate.validator.ap.ConstraintValidationProcessor</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Any constraint annotation problems will then be marked directly within the editor:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/annotation_processor_netbeans.png" alt="annotation processor netbeans">
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="validator-annotationprocessor-known-issues"><a class="anchor" href="#validator-annotationprocessor-known-issues"></a>12.5. Known issues</h3>
<div class="paragraph">
<p>The following known issues exist as of May 2010:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://hibernate.atlassian.net/browse/HV-308">HV-308</a>: Additional validators
registered for a constraint
<a href="http://docs.jboss.org/hibernate/stable/validator/reference/en-US/html_single/#chapter-xml-configuration">using XML</a> are
not evaluated by the annotation processor.</p>
</li>
<li>
<p>Sometimes custom constraints can&#8217;t be
<a href="https://hibernate.atlassian.net/browse/HV-293">properly evaluated</a> when
using the processor within Eclipse. Cleaning the project can help in these situations. This seems to
be an issue with the Eclipse JSR 269 API implementation, but further investigation is required here.</p>
</li>
<li>
<p>When using the processor within Eclipse, the check of dynamic default group sequence definitions
doesn&#8217;t work. After further investigation, it seems to be an issue with the Eclipse JSR 269 API
implementation.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="validator-further-reading"><a class="anchor" href="#validator-further-reading"></a>13. Further reading</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Last but not least, a few pointers to further information.</p>
</div>
<div class="paragraph">
<p>A great source for examples is the Bean Validation TCK which is available for anonymous access on
<a href="https://github.com/beanvalidation/beanvalidation-tck">GitHub</a>. In particular the TCK&#8217;s
<a href="https://github.com/beanvalidation/beanvalidation-tck/tree/1.1.0.Final/tests">tests</a> might be
of interest. <a href="http://beanvalidation.org/1.1/spec/1.1.0.cr3">The JSR 349</a> specification itself
is also a great way to deepen your understanding of Bean Validation resp. Hibernate Validator.</p>
</div>
<div class="paragraph">
<p>If you have any further questions to Hibernate Validator or want to share some of your use cases
have a look at the <a href="http://community.jboss.org/en/hibernate/validator">Hibernate Validator
Wiki</a> and the <a href="https://forum.hibernate.org/viewforum.php?f=9">Hibernate Validator Forum</a>.</p>
</div>
<div class="paragraph">
<p>In case you would like to report a bug use
<a href="http://opensource.atlassian.com/projects/hibernate/browse/HV">Hibernate&#8217;s Jira</a> instance.
Feedback is always welcome!</p>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2019-02-03 15:52:35 UTC
</div>
</div>
<!-- Google Analytics -->
<script type="text/javascript">
	dataLayer = [{'channel' : 'Hibernate', 'additional_tracking_code' : 'UA-45270411-3'}];
	(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
		new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
		j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
	})(window,document,'script','dataLayer','GTM-NJWS5L');
</script>
<noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-NJWS5L" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- /Google Analytics -->

<!-- HibernateDoc.OutdatedContent -->
<script src="//code.jquery.com/jquery-3.1.0.min.js" integrity="sha256-cCueBR6CsyA4/9szpPfrX3s49M9vUU5BgtiJj06wt/s=" crossorigin="anonymous"></script>
<script src="/hibernate/_outdated-content/outdated-content.js" type="text/javascript"></script>
<script type="text/javascript">var jQuery_3_1 = $.noConflict(true); jQuery_3_1(document).ready(function() { HibernateDoc.OutdatedContent.install('validator'); });</script>
<!-- /HibernateDoc.OutdatedContent -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/prettify.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/prettify.min.js"></script>
<script>prettyPrint()</script>
</body>
</html>